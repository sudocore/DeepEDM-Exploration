Setting seed to 2021
{'activation_fn': 'selu',
 'add_pe': True,
 'augmentation_ratio': 0,
 'batch_size': 32,
 'checkpoints': './checkpoints',
 'clip_grad_norm': 1.0,
 'condor_job': True,
 'data': 'ETTm1',
 'data_path': 'ETTm1.csv',
 'delay': 5,
 'des': 'test',
 'devices': '0,1',
 'dist_projection_dim': -1,
 'edm_dropout': 0.1,
 'embed': 'timeF',
 'features': 'M',
 'freq': 'h',
 'gpu': 0,
 'inverse': False,
 'is_training': 1,
 'itr': 1,
 'label_len': 48,
 'latent_channel_dim': -1,
 'learning_rate': 0.0005,
 'loss': 'mae_tdt',
 'loss_type': 'mae',
 'lradj': 'custom',
 'min_lr': 5e-05,
 'mlp_dropout': 0.1,
 'model': 'DeepEDM',
 'model_config': {'edm_params': {'activation_fn': 'selu',
                                 'add_pe': True,
                                 'delay': 5,
                                 'dist_projection_dim': 64,
                                 'dropout': 0.1,
                                 'layer_norm': True,
                                 'method': 'simplex',
                                 'n_proj_layers': 1,
                                 'theta': 1.0,
                                 'time_delay_stride': 1},
                  'encoder_params': {'activation_fn': 'selu',
                                     'add_pe': True,
                                     'dropout': 0.1,
                                     'in_channels': 7,
                                     'latent_channel_dim': 7,
                                     'mlp_layers': 3,
                                     'use_encoder': False},
                  'lookback_len': 288,
                  'n_edm_blocks': 1,
                  'out_pred_len': 144,
                  'type': 'EDM'},
 'model_id': 'ETTm1_rerun_2021',
 'n_edm_blocks': 1,
 'n_mlp_layers': 3,
 'n_proj_layers': -1,
 'num_workers': 4,
 'opt': {'clip_grad_norm': 1.0,
         'early_stopping_patience': 30,
         'epochs': 100,
         'learning_rate': 0.0005,
         'min_lr': 5e-05,
         'reduce_lr_factor': 0.9,
         'schedule_type': 'custom',
         'type': 'AdamW',
         'weight_decay': 1e-05},
 'output_dir': '.',
 'patience': 10,
 'pred_len': 144,
 'reduce_lr_factor': 0.9,
 'root_path': './dataset/ETT-small/',
 'seasonal_patterns': 'Monthly',
 'seed': 2021,
 'seq_len': 288,
 'target': 'OT',
 'task_name': 'long_term_forecast',
 'tdt_loss': True,
 'theta': -1,
 'time_delay_stride': 1,
 'train_epochs': 150,
 'use_amp': False,
 'use_dtw': False,
 'use_gpu': True,
 'use_multi_gpu': True}
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_rerun_2021    Model:              DeepEDM             

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           144                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m

[1mRun Parameters[0m
  Num Workers:        4                   Itr:                1                   
  Train Epochs:       150                 Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.0005              
  Des:                test                Loss:               mae_tdt             
  Lradj:              custom              Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

{'clip_grad_norm': 1.0,
 'early_stopping_patience': 30,
 'epochs': 100,
 'learning_rate': 0.0005,
 'min_lr': 5e-05,
 'reduce_lr_factor': 0.9,
 'schedule_type': 'custom',
 'type': 'AdamW',
 'weight_decay': 1e-05}

{'edm_params': {'activation_fn': 'selu',
                'add_pe': True,
                'delay': 5,
                'dist_projection_dim': 64,
                'dropout': 0.1,
                'layer_norm': True,
                'method': 'simplex',
                'n_proj_layers': 1,
                'theta': 1.0,
                'time_delay_stride': 1},
 'encoder_params': {'activation_fn': 'selu',
                    'add_pe': True,
                    'dropout': 0.1,
                    'in_channels': 7,
                    'latent_channel_dim': 7,
                    'mlp_layers': 3,
                    'use_encoder': False},
 'lookback_len': 288,
 'n_edm_blocks': 1,
 'out_pred_len': 144,
 'type': 'EDM'}

model: Model(
  (encoder): InputEncoder(
    (mlp_projection): Sequential(
      (0): Linear(in_features=288, out_features=144, bias=True)
      (1): Dropout(p=0.1, inplace=False)
      (2): SELU()
      (3): Linear(in_features=144, out_features=144, bias=True)
      (4): Dropout(p=0.1, inplace=False)
      (5): SELU()
      (6): Linear(in_features=144, out_features=144, bias=True)
    )
  )
  (edm_blocks): ModuleList(
    (0): EDM(
      (activation_fn): SELU()
      (projection): Sequential(
        (0): Linear(in_features=5, out_features=64, bias=True)
      )
      (pe): LearnablePositionalEmbedding()
      (ln1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (attn_dropout): Dropout(p=0.1, inplace=False)
      (undelay): Sequential(
        (0): Linear(in_features=715, out_features=144, bias=True)
        (1): Dropout(p=0.1, inplace=False)
        (2): SELU()
        (3): Linear(in_features=144, out_features=144, bias=True)
      )
    )
  )
  (gate_edm): Linear(in_features=144, out_features=1, bias=True)
)
>>>>>>>start training : long_term_forecast_ETTm1_rerun_2021_DeepEDM_ETTm1_ftM_sl288_ll48_pl144_emdtimeF_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11377
test 11377
	iters: 100, epoch: 1 | loss: 0.2860022
	speed: 0.0835s/iter; left time: 13343.8504s
	iters: 200, epoch: 1 | loss: 0.2527476
	speed: 0.0618s/iter; left time: 9877.0716s
	iters: 300, epoch: 1 | loss: 0.2614308
	speed: 0.0509s/iter; left time: 8129.5568s
	iters: 400, epoch: 1 | loss: 0.2696267
	speed: 0.0483s/iter; left time: 7703.0965s
	iters: 500, epoch: 1 | loss: 0.2454939
	speed: 0.0501s/iter; left time: 7991.9917s
	iters: 600, epoch: 1 | loss: 0.2389901
	speed: 0.0512s/iter; left time: 8152.7700s
	iters: 700, epoch: 1 | loss: 0.2305453
	speed: 0.0556s/iter; left time: 8846.7930s
	iters: 800, epoch: 1 | loss: 0.2659630
	speed: 0.0594s/iter; left time: 9455.3559s
	iters: 900, epoch: 1 | loss: 0.2336187
	speed: 0.0583s/iter; left time: 9271.3348s
	iters: 1000, epoch: 1 | loss: 0.2566438
	speed: 0.0654s/iter; left time: 10396.4567s
Epoch: 1 cost time: 62.56667947769165
Vali Metrics: mse:0.4411, mae:0.4329
Test Metrics: mse:0.3157343, mae:0.3503191
Epoch: 1, Steps: 1066 | Train Loss: 0.2578202 Vali Loss: 0.4370136 Test Loss: 0.3330267
Validation loss decreased (inf --> 0.437014).  Saving model ...
Reducing learning rate to 0.000450
	iters: 100, epoch: 2 | loss: 0.2314675
	speed: 0.7470s/iter; left time: 118578.7990s
	iters: 200, epoch: 2 | loss: 0.2319255
	speed: 0.0605s/iter; left time: 9603.2476s
	iters: 300, epoch: 2 | loss: 0.2505653
	speed: 0.0632s/iter; left time: 10017.5216s
	iters: 400, epoch: 2 | loss: 0.2385325
	speed: 0.0648s/iter; left time: 10271.2119s
	iters: 500, epoch: 2 | loss: 0.2401983
	speed: 0.0642s/iter; left time: 10159.1219s
	iters: 600, epoch: 2 | loss: 0.2391607
	speed: 0.0637s/iter; left time: 10072.0645s
	iters: 700, epoch: 2 | loss: 0.2345636
	speed: 0.0635s/iter; left time: 10044.5218s
	iters: 800, epoch: 2 | loss: 0.2703432
	speed: 0.0595s/iter; left time: 9397.6527s
	iters: 900, epoch: 2 | loss: 0.2448947
	speed: 0.0634s/iter; left time: 10006.8922s
	iters: 1000, epoch: 2 | loss: 0.2321029
	speed: 0.0665s/iter; left time: 10496.6422s
Epoch: 2 cost time: 68.2353675365448
Vali Metrics: mse:0.4331, mae:0.4289
Test Metrics: mse:0.3153034, mae:0.3501602
Epoch: 2, Steps: 1066 | Train Loss: 0.2400314 Vali Loss: 0.4309949 Test Loss: 0.3327318
Validation loss decreased (0.437014 --> 0.430995).  Saving model ...
Reducing learning rate to 0.000405
	iters: 100, epoch: 3 | loss: 0.2263438
	speed: 0.7634s/iter; left time: 120360.4802s
	iters: 200, epoch: 3 | loss: 0.2429995
	speed: 0.0618s/iter; left time: 9734.4302s
	iters: 300, epoch: 3 | loss: 0.2247962
	speed: 0.0595s/iter; left time: 9371.6007s
	iters: 400, epoch: 3 | loss: 0.2309470
	speed: 0.0612s/iter; left time: 9634.7980s
	iters: 500, epoch: 3 | loss: 0.2267946
	speed: 0.0615s/iter; left time: 9666.3555s
	iters: 600, epoch: 3 | loss: 0.2413090
	speed: 0.0614s/iter; left time: 9649.0211s
	iters: 700, epoch: 3 | loss: 0.2206111
	speed: 0.0611s/iter; left time: 9604.2230s
	iters: 800, epoch: 3 | loss: 0.2458034
	speed: 0.0674s/iter; left time: 10578.5168s
	iters: 900, epoch: 3 | loss: 0.2413666
	speed: 0.0680s/iter; left time: 10671.1050s
	iters: 1000, epoch: 3 | loss: 0.2188352
	speed: 0.0665s/iter; left time: 10431.7554s
Epoch: 3 cost time: 68.19979524612427
Vali Metrics: mse:0.4334, mae:0.4317
Test Metrics: mse:0.3193985, mae:0.3507207
Epoch: 3, Steps: 1066 | Train Loss: 0.2366376 Vali Loss: 0.4325786 Test Loss: 0.3350596
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000365
	iters: 100, epoch: 4 | loss: 0.2219788
	speed: 0.7152s/iter; left time: 111995.5967s
	iters: 200, epoch: 4 | loss: 0.2287414
	speed: 0.0573s/iter; left time: 8960.4320s
	iters: 300, epoch: 4 | loss: 0.2447260
	speed: 0.0607s/iter; left time: 9493.6255s
	iters: 400, epoch: 4 | loss: 0.2413792
	speed: 0.0652s/iter; left time: 10192.6713s
	iters: 500, epoch: 4 | loss: 0.2467063
	speed: 0.0643s/iter; left time: 10051.4380s
	iters: 600, epoch: 4 | loss: 0.2404034
	speed: 0.0681s/iter; left time: 10632.3620s
	iters: 700, epoch: 4 | loss: 0.2231656
	speed: 0.0674s/iter; left time: 10515.7240s
	iters: 800, epoch: 4 | loss: 0.2307098
	speed: 0.0726s/iter; left time: 11311.6367s
	iters: 900, epoch: 4 | loss: 0.2340927
	speed: 0.0722s/iter; left time: 11249.5312s
	iters: 1000, epoch: 4 | loss: 0.2330200
	speed: 0.0699s/iter; left time: 10888.3004s
Epoch: 4 cost time: 70.1912522315979
Vali Metrics: mse:0.4242, mae:0.4246
Test Metrics: mse:0.3195401, mae:0.3506155
Epoch: 4, Steps: 1066 | Train Loss: 0.2345346 Vali Loss: 0.4243905 Test Loss: 0.3350778
Validation loss decreased (0.430995 --> 0.424390).  Saving model ...
Reducing learning rate to 0.000328
	iters: 100, epoch: 5 | loss: 0.2242720
	speed: 0.7594s/iter; left time: 118120.0314s
	iters: 200, epoch: 5 | loss: 0.2534981
	speed: 0.0658s/iter; left time: 10220.6617s
	iters: 300, epoch: 5 | loss: 0.2379431
	speed: 0.0675s/iter; left time: 10479.2696s
	iters: 400, epoch: 5 | loss: 0.2261896
	speed: 0.0623s/iter; left time: 9664.6023s
	iters: 500, epoch: 5 | loss: 0.2310212
	speed: 0.0648s/iter; left time: 10059.0523s
	iters: 600, epoch: 5 | loss: 0.2293292
	speed: 0.0648s/iter; left time: 10049.5015s
	iters: 700, epoch: 5 | loss: 0.2321579
	speed: 0.0625s/iter; left time: 9685.9754s
	iters: 800, epoch: 5 | loss: 0.2366161
	speed: 0.0575s/iter; left time: 8903.3080s
	iters: 900, epoch: 5 | loss: 0.2376205
	speed: 0.0523s/iter; left time: 8088.3406s
	iters: 1000, epoch: 5 | loss: 0.2375756
	speed: 0.0537s/iter; left time: 8299.9475s
Epoch: 5 cost time: 65.01781296730042
Vali Metrics: mse:0.4244, mae:0.4247
Test Metrics: mse:0.3105659, mae:0.3455967
Epoch: 5, Steps: 1066 | Train Loss: 0.2331277 Vali Loss: 0.4245147 Test Loss: 0.3280813
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000295
	iters: 100, epoch: 6 | loss: 0.2335773
	speed: 0.7368s/iter; left time: 113818.1036s
	iters: 200, epoch: 6 | loss: 0.2287569
	speed: 0.0682s/iter; left time: 10535.1237s
	iters: 300, epoch: 6 | loss: 0.2313219
	speed: 0.0646s/iter; left time: 9965.5223s
	iters: 400, epoch: 6 | loss: 0.2320369
	speed: 0.0672s/iter; left time: 10358.4096s
	iters: 500, epoch: 6 | loss: 0.2176357
	speed: 0.0663s/iter; left time: 10211.5625s
	iters: 600, epoch: 6 | loss: 0.2310964
	speed: 0.0665s/iter; left time: 10237.3081s
	iters: 700, epoch: 6 | loss: 0.2375153
	speed: 0.0662s/iter; left time: 10189.5588s
	iters: 800, epoch: 6 | loss: 0.2237650
	speed: 0.0654s/iter; left time: 10049.3071s
	iters: 900, epoch: 6 | loss: 0.2319028
	speed: 0.0697s/iter; left time: 10712.7248s
	iters: 1000, epoch: 6 | loss: 0.2302892
	speed: 0.0654s/iter; left time: 10044.0116s
Epoch: 6 cost time: 71.48414850234985
Vali Metrics: mse:0.4232, mae:0.4228
Test Metrics: mse:0.311107, mae:0.3454131
Epoch: 6, Steps: 1066 | Train Loss: 0.2318252 Vali Loss: 0.4230054 Test Loss: 0.3282601
Validation loss decreased (0.424390 --> 0.423005).  Saving model ...
Reducing learning rate to 0.000266
	iters: 100, epoch: 7 | loss: 0.2176746
	speed: 0.7389s/iter; left time: 113352.7724s
	iters: 200, epoch: 7 | loss: 0.2246742
	speed: 0.0584s/iter; left time: 8953.6639s
	iters: 300, epoch: 7 | loss: 0.2200548
	speed: 0.0621s/iter; left time: 9516.1900s
	iters: 400, epoch: 7 | loss: 0.2412004
	speed: 0.0636s/iter; left time: 9734.7595s
	iters: 500, epoch: 7 | loss: 0.2286348
	speed: 0.0575s/iter; left time: 8793.3130s
	iters: 600, epoch: 7 | loss: 0.1995464
	speed: 0.0608s/iter; left time: 9294.7909s
	iters: 700, epoch: 7 | loss: 0.2202075
	speed: 0.0608s/iter; left time: 9290.7472s
	iters: 800, epoch: 7 | loss: 0.2215247
	speed: 0.0646s/iter; left time: 9868.9955s
	iters: 900, epoch: 7 | loss: 0.2298361
	speed: 0.0678s/iter; left time: 10341.9444s
	iters: 1000, epoch: 7 | loss: 0.2186383
	speed: 0.0685s/iter; left time: 10439.4782s
Epoch: 7 cost time: 66.90343475341797
Vali Metrics: mse:0.4187, mae:0.4215
Test Metrics: mse:0.3065681, mae:0.3445068
Epoch: 7, Steps: 1066 | Train Loss: 0.2309009 Vali Loss: 0.4200794 Test Loss: 0.3255374
Validation loss decreased (0.423005 --> 0.420079).  Saving model ...
Reducing learning rate to 0.000239
	iters: 100, epoch: 8 | loss: 0.2280990
	speed: 0.7529s/iter; left time: 114691.6306s
	iters: 200, epoch: 8 | loss: 0.2201300
	speed: 0.0641s/iter; left time: 9760.9377s
	iters: 300, epoch: 8 | loss: 0.2233875
	speed: 0.0701s/iter; left time: 10660.3173s
	iters: 400, epoch: 8 | loss: 0.2194234
	speed: 0.0620s/iter; left time: 9428.6999s
	iters: 500, epoch: 8 | loss: 0.2187317
	speed: 0.0701s/iter; left time: 10647.8879s
	iters: 600, epoch: 8 | loss: 0.2297645
	speed: 0.0667s/iter; left time: 10134.0871s
	iters: 700, epoch: 8 | loss: 0.2276664
	speed: 0.0682s/iter; left time: 10350.6455s
	iters: 800, epoch: 8 | loss: 0.2297672
	speed: 0.0685s/iter; left time: 10386.7005s
	iters: 900, epoch: 8 | loss: 0.2224449
	speed: 0.0746s/iter; left time: 11308.2468s
	iters: 1000, epoch: 8 | loss: 0.2294538
	speed: 0.0650s/iter; left time: 9847.9757s
Epoch: 8 cost time: 71.6138768196106
Vali Metrics: mse:0.4194, mae:0.4217
Test Metrics: mse:0.3142198, mae:0.3459907
Epoch: 8, Steps: 1066 | Train Loss: 0.2299329 Vali Loss: 0.4205133 Test Loss: 0.3301052
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000215
	iters: 100, epoch: 9 | loss: 0.2344421
	speed: 0.6944s/iter; left time: 105051.4413s
	iters: 200, epoch: 9 | loss: 0.2288335
	speed: 0.0702s/iter; left time: 10608.9295s
	iters: 300, epoch: 9 | loss: 0.2258042
	speed: 0.0586s/iter; left time: 8851.6753s
	iters: 400, epoch: 9 | loss: 0.2258850
	speed: 0.0646s/iter; left time: 9748.2514s
	iters: 500, epoch: 9 | loss: 0.2270187
	speed: 0.0698s/iter; left time: 10524.7715s
	iters: 600, epoch: 9 | loss: 0.2221095
	speed: 0.0674s/iter; left time: 10155.3688s
	iters: 700, epoch: 9 | loss: 0.2238081
	speed: 0.0689s/iter; left time: 10377.1528s
	iters: 800, epoch: 9 | loss: 0.2316179
	speed: 0.0687s/iter; left time: 10339.5706s
	iters: 900, epoch: 9 | loss: 0.2475897
	speed: 0.0664s/iter; left time: 9996.2186s
	iters: 1000, epoch: 9 | loss: 0.2119699
	speed: 0.0624s/iter; left time: 9378.3284s
Epoch: 9 cost time: 71.18564105033875
Vali Metrics: mse:0.4192, mae:0.4224
Test Metrics: mse:0.3107427, mae:0.3454855
Epoch: 9, Steps: 1066 | Train Loss: 0.2292392 Vali Loss: 0.4207982 Test Loss: 0.3281141
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000194
	iters: 100, epoch: 10 | loss: 0.2399447
	speed: 0.7615s/iter; left time: 114384.8180s
	iters: 200, epoch: 10 | loss: 0.2314849
	speed: 0.0675s/iter; left time: 10138.8254s
	iters: 300, epoch: 10 | loss: 0.2582856
	speed: 0.0646s/iter; left time: 9696.3301s
	iters: 400, epoch: 10 | loss: 0.2073902
	speed: 0.0603s/iter; left time: 9044.1574s
	iters: 500, epoch: 10 | loss: 0.2320067
	speed: 0.0658s/iter; left time: 9857.0198s
	iters: 600, epoch: 10 | loss: 0.2281434
	speed: 0.0693s/iter; left time: 10375.3209s
	iters: 700, epoch: 10 | loss: 0.2116404
	speed: 0.0639s/iter; left time: 9561.6424s
	iters: 800, epoch: 10 | loss: 0.2118459
	speed: 0.0566s/iter; left time: 8466.3524s
	iters: 900, epoch: 10 | loss: 0.2260312
	speed: 0.0633s/iter; left time: 9451.4529s
	iters: 1000, epoch: 10 | loss: 0.2320360
	speed: 0.0647s/iter; left time: 9666.9236s
Epoch: 10 cost time: 69.46432042121887
Vali Metrics: mse:0.4175, mae:0.4194
Test Metrics: mse:0.3116524, mae:0.3449529
Epoch: 10, Steps: 1066 | Train Loss: 0.2287044 Vali Loss: 0.4184854 Test Loss: 0.3283027
Validation loss decreased (0.420079 --> 0.418485).  Saving model ...
Reducing learning rate to 0.000174
	iters: 100, epoch: 11 | loss: 0.2393991
	speed: 0.7667s/iter; left time: 114345.6727s
	iters: 200, epoch: 11 | loss: 0.2270477
	speed: 0.0649s/iter; left time: 9676.0578s
	iters: 300, epoch: 11 | loss: 0.2246988
	speed: 0.0696s/iter; left time: 10371.2047s
	iters: 400, epoch: 11 | loss: 0.2222986
	speed: 0.0603s/iter; left time: 8971.7623s
	iters: 500, epoch: 11 | loss: 0.2173503
	speed: 0.0613s/iter; left time: 9111.7764s
	iters: 600, epoch: 11 | loss: 0.2446581
	speed: 0.0627s/iter; left time: 9323.8342s
	iters: 700, epoch: 11 | loss: 0.2377580
	speed: 0.0502s/iter; left time: 7449.7251s
	iters: 800, epoch: 11 | loss: 0.2232091
	speed: 0.0535s/iter; left time: 7935.4587s
	iters: 900, epoch: 11 | loss: 0.2223781
	speed: 0.0459s/iter; left time: 6805.0912s
	iters: 1000, epoch: 11 | loss: 0.2205958
	speed: 0.0484s/iter; left time: 7171.7689s
Epoch: 11 cost time: 61.99201560020447
Vali Metrics: mse:0.4148, mae:0.4195
Test Metrics: mse:0.3087949, mae:0.3452675
Epoch: 11, Steps: 1066 | Train Loss: 0.2280766 Vali Loss: 0.4171232 Test Loss: 0.3270312
Validation loss decreased (0.418485 --> 0.417123).  Saving model ...
Reducing learning rate to 0.000157
	iters: 100, epoch: 12 | loss: 0.2345333
	speed: 0.6407s/iter; left time: 94869.2359s
	iters: 200, epoch: 12 | loss: 0.2294674
	speed: 0.0663s/iter; left time: 9816.5173s
	iters: 300, epoch: 12 | loss: 0.2477425
	speed: 0.0605s/iter; left time: 8949.8192s
	iters: 400, epoch: 12 | loss: 0.2426267
	speed: 0.0580s/iter; left time: 8572.6823s
	iters: 500, epoch: 12 | loss: 0.2311323
	speed: 0.0550s/iter; left time: 8116.6585s
	iters: 600, epoch: 12 | loss: 0.2354224
	speed: 0.0455s/iter; left time: 6716.0505s
	iters: 700, epoch: 12 | loss: 0.2330649
	speed: 0.0402s/iter; left time: 5933.0247s
	iters: 800, epoch: 12 | loss: 0.2357977
	speed: 0.0403s/iter; left time: 5939.2515s
	iters: 900, epoch: 12 | loss: 0.2404695
	speed: 0.0461s/iter; left time: 6794.8855s
	iters: 1000, epoch: 12 | loss: 0.2302129
	speed: 0.0509s/iter; left time: 7492.7141s
Epoch: 12 cost time: 55.8907904624939
Vali Metrics: mse:0.4148, mae:0.4198
Test Metrics: mse:0.3086223, mae:0.3471529
Epoch: 12, Steps: 1066 | Train Loss: 0.2276737 Vali Loss: 0.4172707 Test Loss: 0.3278876
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000141
	iters: 100, epoch: 13 | loss: 0.2199443
	speed: 0.6032s/iter; left time: 88680.6414s
	iters: 200, epoch: 13 | loss: 0.2187405
	speed: 0.0492s/iter; left time: 7223.3174s
	iters: 300, epoch: 13 | loss: 0.2282375
	speed: 0.0514s/iter; left time: 7553.2772s
	iters: 400, epoch: 13 | loss: 0.2223862
	speed: 0.0535s/iter; left time: 7850.0702s
	iters: 500, epoch: 13 | loss: 0.2364595
	speed: 0.0539s/iter; left time: 7900.2678s
	iters: 600, epoch: 13 | loss: 0.2362096
	speed: 0.0529s/iter; left time: 7749.4909s
	iters: 700, epoch: 13 | loss: 0.2447070
	speed: 0.0403s/iter; left time: 5895.5176s
	iters: 800, epoch: 13 | loss: 0.2309315
	speed: 0.0499s/iter; left time: 7299.3512s
	iters: 900, epoch: 13 | loss: 0.2246320
	speed: 0.0576s/iter; left time: 8420.8844s
	iters: 1000, epoch: 13 | loss: 0.2137115
	speed: 0.0540s/iter; left time: 7893.6232s
Epoch: 13 cost time: 55.488959550857544
Vali Metrics: mse:0.4180, mae:0.4226
Test Metrics: mse:0.3116573, mae:0.3456147
Epoch: 13, Steps: 1066 | Train Loss: 0.2272282 Vali Loss: 0.4202799 Test Loss: 0.3286361
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000127
	iters: 100, epoch: 14 | loss: 0.2281006
	speed: 0.6280s/iter; left time: 91652.0811s
	iters: 200, epoch: 14 | loss: 0.2303690
	speed: 0.0489s/iter; left time: 7138.7603s
	iters: 300, epoch: 14 | loss: 0.2099246
	speed: 0.0529s/iter; left time: 7704.0518s
	iters: 400, epoch: 14 | loss: 0.2250515
	speed: 0.0524s/iter; left time: 7627.4027s
	iters: 500, epoch: 14 | loss: 0.2093809
	speed: 0.0543s/iter; left time: 7902.0842s
	iters: 600, epoch: 14 | loss: 0.2395851
	speed: 0.0523s/iter; left time: 7600.8152s
	iters: 700, epoch: 14 | loss: 0.2465087
	speed: 0.0479s/iter; left time: 6956.5086s
	iters: 800, epoch: 14 | loss: 0.2248825
	speed: 0.0547s/iter; left time: 7943.6380s
	iters: 900, epoch: 14 | loss: 0.2328185
	speed: 0.0496s/iter; left time: 7200.5895s
	iters: 1000, epoch: 14 | loss: 0.2323689
	speed: 0.0546s/iter; left time: 7918.4024s
Epoch: 14 cost time: 56.222004652023315
Vali Metrics: mse:0.4152, mae:0.4203
Test Metrics: mse:0.3063695, mae:0.3440923
Epoch: 14, Steps: 1066 | Train Loss: 0.2268566 Vali Loss: 0.4177603 Test Loss: 0.3252309
EarlyStopping counter: 3 out of 10
Reducing learning rate to 0.000114
	iters: 100, epoch: 15 | loss: 0.2081697
	speed: 0.6079s/iter; left time: 88077.8244s
	iters: 200, epoch: 15 | loss: 0.2342267
	speed: 0.0495s/iter; left time: 7168.4867s
	iters: 300, epoch: 15 | loss: 0.2205963
	speed: 0.0418s/iter; left time: 6046.2190s
	iters: 400, epoch: 15 | loss: 0.2283139
	speed: 0.0494s/iter; left time: 7148.1144s
	iters: 500, epoch: 15 | loss: 0.2346637
	speed: 0.0545s/iter; left time: 7877.7539s
	iters: 600, epoch: 15 | loss: 0.2241091
	speed: 0.0573s/iter; left time: 8267.2763s
	iters: 700, epoch: 15 | loss: 0.2227191
	speed: 0.0505s/iter; left time: 7281.1954s
	iters: 800, epoch: 15 | loss: 0.2438102
	speed: 0.0540s/iter; left time: 7780.1531s
	iters: 900, epoch: 15 | loss: 0.2244855
	speed: 0.0573s/iter; left time: 8257.7288s
	iters: 1000, epoch: 15 | loss: 0.2167186
	speed: 0.0518s/iter; left time: 7463.9469s
Epoch: 15 cost time: 55.52636384963989
Vali Metrics: mse:0.4143, mae:0.4182
Test Metrics: mse:0.307066, mae:0.3449522
Epoch: 15, Steps: 1066 | Train Loss: 0.2265352 Vali Loss: 0.4162583 Test Loss: 0.3260091
Validation loss decreased (0.417123 --> 0.416258).  Saving model ...
Reducing learning rate to 0.000103
	iters: 100, epoch: 16 | loss: 0.2384511
	speed: 0.5815s/iter; left time: 83623.4980s
	iters: 200, epoch: 16 | loss: 0.2075314
	speed: 0.0600s/iter; left time: 8616.5916s
	iters: 300, epoch: 16 | loss: 0.2253281
	speed: 0.0555s/iter; left time: 7965.6388s
	iters: 400, epoch: 16 | loss: 0.2316251
	speed: 0.0581s/iter; left time: 8338.1221s
	iters: 500, epoch: 16 | loss: 0.2284431
	speed: 0.0563s/iter; left time: 8076.7051s
	iters: 600, epoch: 16 | loss: 0.2433539
	speed: 0.0591s/iter; left time: 8464.3476s
	iters: 700, epoch: 16 | loss: 0.2307278
	speed: 0.0594s/iter; left time: 8505.1690s
	iters: 800, epoch: 16 | loss: 0.2294961
	speed: 0.0599s/iter; left time: 8573.3517s
	iters: 900, epoch: 16 | loss: 0.2123761
	speed: 0.0628s/iter; left time: 8979.2042s
	iters: 1000, epoch: 16 | loss: 0.2238618
	speed: 0.0586s/iter; left time: 8377.9413s
Epoch: 16 cost time: 61.91682553291321
Vali Metrics: mse:0.4116, mae:0.4187
Test Metrics: mse:0.3056711, mae:0.3427608
Epoch: 16, Steps: 1066 | Train Loss: 0.2262319 Vali Loss: 0.4151568 Test Loss: 0.3242159
Validation loss decreased (0.416258 --> 0.415157).  Saving model ...
Reducing learning rate to 0.000093
	iters: 100, epoch: 17 | loss: 0.2230573
	speed: 0.5747s/iter; left time: 82030.6113s
	iters: 200, epoch: 17 | loss: 0.2137848
	speed: 0.0519s/iter; left time: 7407.5346s
	iters: 300, epoch: 17 | loss: 0.2129144
	speed: 0.0507s/iter; left time: 7230.6576s
	iters: 400, epoch: 17 | loss: 0.2298879
	speed: 0.0558s/iter; left time: 7950.8636s
	iters: 500, epoch: 17 | loss: 0.2225304
	speed: 0.0532s/iter; left time: 7576.6483s
	iters: 600, epoch: 17 | loss: 0.2114541
	speed: 0.0421s/iter; left time: 5993.9869s
	iters: 700, epoch: 17 | loss: 0.2150909
	speed: 0.0495s/iter; left time: 7035.5984s
	iters: 800, epoch: 17 | loss: 0.2279317
	speed: 0.0545s/iter; left time: 7745.6581s
	iters: 900, epoch: 17 | loss: 0.2341906
	speed: 0.0550s/iter; left time: 7805.3140s
	iters: 1000, epoch: 17 | loss: 0.2336353
	speed: 0.0535s/iter; left time: 7586.4595s
Epoch: 17 cost time: 55.95955228805542
Vali Metrics: mse:0.4127, mae:0.4191
Test Metrics: mse:0.3068071, mae:0.3452821
Epoch: 17, Steps: 1066 | Train Loss: 0.2259314 Vali Loss: 0.4159043 Test Loss: 0.3260446
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000083
	iters: 100, epoch: 18 | loss: 0.2266845
	speed: 0.6160s/iter; left time: 87271.9483s
	iters: 200, epoch: 18 | loss: 0.2179800
	speed: 0.0505s/iter; left time: 7156.6288s
	iters: 300, epoch: 18 | loss: 0.2169069
	speed: 0.0537s/iter; left time: 7601.8365s
	iters: 400, epoch: 18 | loss: 0.2279231
	speed: 0.0481s/iter; left time: 6804.6312s
	iters: 500, epoch: 18 | loss: 0.2253914
	speed: 0.0484s/iter; left time: 6837.9355s
	iters: 600, epoch: 18 | loss: 0.2313053
	speed: 0.0470s/iter; left time: 6642.2557s
	iters: 700, epoch: 18 | loss: 0.2398760
	speed: 0.0550s/iter; left time: 7755.2683s
	iters: 800, epoch: 18 | loss: 0.2077368
	speed: 0.0530s/iter; left time: 7475.2791s
	iters: 900, epoch: 18 | loss: 0.2214710
	speed: 0.0535s/iter; left time: 7543.1673s
	iters: 1000, epoch: 18 | loss: 0.2537863
	speed: 0.0540s/iter; left time: 7601.3576s
Epoch: 18 cost time: 55.46812081336975
Vali Metrics: mse:0.4097, mae:0.4162
Test Metrics: mse:0.3072644, mae:0.3447723
Epoch: 18, Steps: 1066 | Train Loss: 0.2257063 Vali Loss: 0.4129462 Test Loss: 0.3260184
Validation loss decreased (0.415157 --> 0.412946).  Saving model ...
Reducing learning rate to 0.000075
	iters: 100, epoch: 19 | loss: 0.2239547
	speed: 0.6095s/iter; left time: 85698.4437s
	iters: 200, epoch: 19 | loss: 0.2108075
	speed: 0.0533s/iter; left time: 7495.3686s
	iters: 300, epoch: 19 | loss: 0.2206095
	speed: 0.0560s/iter; left time: 7861.0325s
	iters: 400, epoch: 19 | loss: 0.2129271
	speed: 0.0553s/iter; left time: 7763.7244s
	iters: 500, epoch: 19 | loss: 0.2219258
	speed: 0.0554s/iter; left time: 7760.9846s
	iters: 600, epoch: 19 | loss: 0.2090512
	speed: 0.0509s/iter; left time: 7133.3741s
	iters: 700, epoch: 19 | loss: 0.2263926
	speed: 0.0590s/iter; left time: 8263.3469s
	iters: 800, epoch: 19 | loss: 0.2479469
	speed: 0.0499s/iter; left time: 6979.3987s
	iters: 900, epoch: 19 | loss: 0.2271074
	speed: 0.0537s/iter; left time: 7512.0100s
	iters: 1000, epoch: 19 | loss: 0.2361027
	speed: 0.0465s/iter; left time: 6491.7524s
Epoch: 19 cost time: 57.24736142158508
Vali Metrics: mse:0.4115, mae:0.4179
Test Metrics: mse:0.3062108, mae:0.3441558
Epoch: 19, Steps: 1066 | Train Loss: 0.2255092 Vali Loss: 0.4147174 Test Loss: 0.3251833
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000068
	iters: 100, epoch: 20 | loss: 0.2211939
	speed: 0.5903s/iter; left time: 82379.5833s
	iters: 200, epoch: 20 | loss: 0.2161566
	speed: 0.0551s/iter; left time: 7679.4693s
	iters: 300, epoch: 20 | loss: 0.2166380
	speed: 0.0546s/iter; left time: 7608.9280s
	iters: 400, epoch: 20 | loss: 0.2096780
	speed: 0.0609s/iter; left time: 8477.2791s
	iters: 500, epoch: 20 | loss: 0.2386044
	speed: 0.0538s/iter; left time: 7482.3384s
	iters: 600, epoch: 20 | loss: 0.2040697
	speed: 0.0462s/iter; left time: 6421.5943s
	iters: 700, epoch: 20 | loss: 0.2148972
	speed: 0.0483s/iter; left time: 6708.1174s
	iters: 800, epoch: 20 | loss: 0.2298178
	speed: 0.0544s/iter; left time: 7546.6273s
	iters: 900, epoch: 20 | loss: 0.2189924
	speed: 0.0588s/iter; left time: 8161.4548s
	iters: 1000, epoch: 20 | loss: 0.2131495
	speed: 0.0564s/iter; left time: 7815.5302s
Epoch: 20 cost time: 58.44832229614258
Vali Metrics: mse:0.4094, mae:0.4164
Test Metrics: mse:0.3071952, mae:0.3435210
Epoch: 20, Steps: 1066 | Train Loss: 0.2253686 Vali Loss: 0.4128955 Test Loss: 0.3253581
Validation loss decreased (0.412946 --> 0.412895).  Saving model ...
Reducing learning rate to 0.000061
	iters: 100, epoch: 21 | loss: 0.2222821
	speed: 0.6075s/iter; left time: 84122.6400s
	iters: 200, epoch: 21 | loss: 0.2163008
	speed: 0.0566s/iter; left time: 7836.8494s
	iters: 300, epoch: 21 | loss: 0.2156781
	speed: 0.0577s/iter; left time: 7974.3319s
	iters: 400, epoch: 21 | loss: 0.2116448
	speed: 0.0572s/iter; left time: 7900.8350s
	iters: 500, epoch: 21 | loss: 0.2071464
	speed: 0.0543s/iter; left time: 7500.3277s
	iters: 600, epoch: 21 | loss: 0.2296610
	speed: 0.0526s/iter; left time: 7253.6634s
	iters: 700, epoch: 21 | loss: 0.2323785
	speed: 0.0520s/iter; left time: 7173.8114s
	iters: 800, epoch: 21 | loss: 0.2388989
	speed: 0.0408s/iter; left time: 5616.2659s
	iters: 900, epoch: 21 | loss: 0.2268396
	speed: 0.0449s/iter; left time: 6186.4594s
	iters: 1000, epoch: 21 | loss: 0.2248990
	speed: 0.0524s/iter; left time: 7207.6352s
Epoch: 21 cost time: 56.19289040565491
Vali Metrics: mse:0.4122, mae:0.4184
Test Metrics: mse:0.3033761, mae:0.3423637
Epoch: 21, Steps: 1066 | Train Loss: 0.2251383 Vali Loss: 0.4153050 Test Loss: 0.3228699
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000055
	iters: 100, epoch: 22 | loss: 0.2503715
	speed: 0.4809s/iter; left time: 66077.8545s
	iters: 200, epoch: 22 | loss: 0.2306295
	speed: 0.0538s/iter; left time: 7393.8519s
	iters: 300, epoch: 22 | loss: 0.2358252
	speed: 0.0544s/iter; left time: 7468.7670s
	iters: 400, epoch: 22 | loss: 0.2420190
	speed: 0.0575s/iter; left time: 7878.2125s
	iters: 500, epoch: 22 | loss: 0.2259870
	speed: 0.0536s/iter; left time: 7350.7519s
	iters: 600, epoch: 22 | loss: 0.2101451
	speed: 0.0517s/iter; left time: 7073.4972s
	iters: 700, epoch: 22 | loss: 0.2284410
	speed: 0.0469s/iter; left time: 6420.6240s
	iters: 800, epoch: 22 | loss: 0.2172402
	speed: 0.0404s/iter; left time: 5519.2285s
	iters: 900, epoch: 22 | loss: 0.2375361
	speed: 0.0367s/iter; left time: 5017.5030s
	iters: 1000, epoch: 22 | loss: 0.2183007
	speed: 0.0372s/iter; left time: 5082.1150s
Epoch: 22 cost time: 50.37010455131531
Vali Metrics: mse:0.4102, mae:0.4162
Test Metrics: mse:0.3087106, mae:0.3435100
Epoch: 22, Steps: 1066 | Train Loss: 0.2250424 Vali Loss: 0.4132019 Test Loss: 0.3261103
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000050
	iters: 100, epoch: 23 | loss: 0.2176023
	speed: 0.4128s/iter; left time: 56290.9010s
	iters: 200, epoch: 23 | loss: 0.2052054
	speed: 0.0463s/iter; left time: 6307.9900s
	iters: 300, epoch: 23 | loss: 0.2274962
	speed: 0.0461s/iter; left time: 6271.4676s
	iters: 400, epoch: 23 | loss: 0.2204532
	speed: 0.0488s/iter; left time: 6643.1801s
	iters: 500, epoch: 23 | loss: 0.2034040
	speed: 0.0517s/iter; left time: 7030.8436s
	iters: 600, epoch: 23 | loss: 0.2182829
	speed: 0.0449s/iter; left time: 6103.9197s
	iters: 700, epoch: 23 | loss: 0.2086997
	speed: 0.0526s/iter; left time: 7142.8795s
	iters: 800, epoch: 23 | loss: 0.2165327
	speed: 0.0540s/iter; left time: 7324.8586s
	iters: 900, epoch: 23 | loss: 0.2243063
	speed: 0.0452s/iter; left time: 6123.5821s
	iters: 1000, epoch: 23 | loss: 0.2104536
	speed: 0.0481s/iter; left time: 6515.5670s
Epoch: 23 cost time: 51.69794178009033
Vali Metrics: mse:0.4090, mae:0.4165
Test Metrics: mse:0.3054915, mae:0.3431132
Epoch: 23, Steps: 1066 | Train Loss: 0.2249719 Vali Loss: 0.4127573 Test Loss: 0.3243024
Validation loss decreased (0.412895 --> 0.412757).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2164707
	speed: 0.4643s/iter; left time: 62809.0651s
	iters: 200, epoch: 24 | loss: 0.2114529
	speed: 0.0461s/iter; left time: 6238.6939s
	iters: 300, epoch: 24 | loss: 0.2511902
	speed: 0.0406s/iter; left time: 5490.4184s
	iters: 400, epoch: 24 | loss: 0.2334077
	speed: 0.0490s/iter; left time: 6609.6156s
	iters: 500, epoch: 24 | loss: 0.2178265
	speed: 0.0556s/iter; left time: 7497.4909s
	iters: 600, epoch: 24 | loss: 0.2159291
	speed: 0.0547s/iter; left time: 7368.0917s
	iters: 700, epoch: 24 | loss: 0.2174238
	speed: 0.0516s/iter; left time: 6945.5562s
	iters: 800, epoch: 24 | loss: 0.2499568
	speed: 0.0470s/iter; left time: 6332.1223s
	iters: 900, epoch: 24 | loss: 0.2269530
	speed: 0.0514s/iter; left time: 6918.7066s
	iters: 1000, epoch: 24 | loss: 0.2555216
	speed: 0.0442s/iter; left time: 5939.2481s
Epoch: 24 cost time: 51.990066051483154
Vali Metrics: mse:0.4101, mae:0.4166
Test Metrics: mse:0.3042253, mae:0.3428414
Epoch: 24, Steps: 1066 | Train Loss: 0.2248221 Vali Loss: 0.4133276 Test Loss: 0.3235334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.2399486
	speed: 0.4032s/iter; left time: 54120.5436s
	iters: 200, epoch: 25 | loss: 0.2259911
	speed: 0.0430s/iter; left time: 5764.5691s
	iters: 300, epoch: 25 | loss: 0.2114223
	speed: 0.0449s/iter; left time: 6023.1700s
	iters: 400, epoch: 25 | loss: 0.2355600
	speed: 0.0412s/iter; left time: 5520.2295s
	iters: 500, epoch: 25 | loss: 0.2256194
	speed: 0.0392s/iter; left time: 5247.1949s
	iters: 600, epoch: 25 | loss: 0.2092926
	speed: 0.0504s/iter; left time: 6741.3631s
	iters: 700, epoch: 25 | loss: 0.2182456
	speed: 0.0543s/iter; left time: 7260.0683s
	iters: 800, epoch: 25 | loss: 0.2314335
	speed: 0.0514s/iter; left time: 6867.0329s
	iters: 900, epoch: 25 | loss: 0.2129145
	speed: 0.0560s/iter; left time: 7466.0674s
	iters: 1000, epoch: 25 | loss: 0.2366333
	speed: 0.0554s/iter; left time: 7389.7842s
Epoch: 25 cost time: 50.64101600646973
Vali Metrics: mse:0.4085, mae:0.4166
Test Metrics: mse:0.304256, mae:0.3431408
Epoch: 25, Steps: 1066 | Train Loss: 0.2248470 Vali Loss: 0.4125479 Test Loss: 0.3236983
Validation loss decreased (0.412757 --> 0.412548).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.2100442
	speed: 0.4518s/iter; left time: 60153.0238s
	iters: 200, epoch: 26 | loss: 0.2232029
	speed: 0.0344s/iter; left time: 4576.4990s
	iters: 300, epoch: 26 | loss: 0.2218067
	speed: 0.0401s/iter; left time: 5329.7578s
	iters: 400, epoch: 26 | loss: 0.2057582
	speed: 0.0412s/iter; left time: 5479.3942s
	iters: 500, epoch: 26 | loss: 0.2094815
	speed: 0.0493s/iter; left time: 6547.9331s
	iters: 600, epoch: 26 | loss: 0.2267568
	speed: 0.0491s/iter; left time: 6509.7476s
	iters: 700, epoch: 26 | loss: 0.2220200
	speed: 0.0462s/iter; left time: 6124.7409s
	iters: 800, epoch: 26 | loss: 0.2193736
	speed: 0.0443s/iter; left time: 5863.0308s
	iters: 900, epoch: 26 | loss: 0.2202166
	speed: 0.0472s/iter; left time: 6251.5326s
	iters: 1000, epoch: 26 | loss: 0.2234567
	speed: 0.0500s/iter; left time: 6616.0134s
Epoch: 26 cost time: 47.319087743759155
Vali Metrics: mse:0.4093, mae:0.4168
Test Metrics: mse:0.3054577, mae:0.3430293
Epoch: 26, Steps: 1066 | Train Loss: 0.2246991 Vali Loss: 0.4130093 Test Loss: 0.3242435
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.2418307
	speed: 0.4851s/iter; left time: 64074.4552s
	iters: 200, epoch: 27 | loss: 0.2256072
	speed: 0.0390s/iter; left time: 5141.4589s
	iters: 300, epoch: 27 | loss: 0.2379957
	speed: 0.0420s/iter; left time: 5536.3153s
	iters: 400, epoch: 27 | loss: 0.2394260
	speed: 0.0415s/iter; left time: 5471.1561s
	iters: 500, epoch: 27 | loss: 0.2062473
	speed: 0.0428s/iter; left time: 5636.8294s
	iters: 600, epoch: 27 | loss: 0.2099185
	speed: 0.0443s/iter; left time: 5826.5762s
	iters: 700, epoch: 27 | loss: 0.2130000
	speed: 0.0482s/iter; left time: 6335.8518s
	iters: 800, epoch: 27 | loss: 0.2348100
	speed: 0.0451s/iter; left time: 5929.9006s
	iters: 900, epoch: 27 | loss: 0.2049304
	speed: 0.0450s/iter; left time: 5907.1689s
	iters: 1000, epoch: 27 | loss: 0.2142177
	speed: 0.0458s/iter; left time: 6009.5127s
Epoch: 27 cost time: 47.107948303222656
Vali Metrics: mse:0.4104, mae:0.4170
Test Metrics: mse:0.3056391, mae:0.3432538
Epoch: 27, Steps: 1066 | Train Loss: 0.2246221 Vali Loss: 0.4136873 Test Loss: 0.3244464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2260829
	speed: 0.5014s/iter; left time: 65694.6732s
	iters: 200, epoch: 28 | loss: 0.2162908
	speed: 0.0309s/iter; left time: 4043.7171s
	iters: 300, epoch: 28 | loss: 0.2276420
	speed: 0.0311s/iter; left time: 4069.3575s
	iters: 400, epoch: 28 | loss: 0.2247927
	speed: 0.0300s/iter; left time: 3928.0459s
	iters: 500, epoch: 28 | loss: 0.2260598
	speed: 0.0285s/iter; left time: 3716.2246s
	iters: 600, epoch: 28 | loss: 0.2330485
	speed: 0.0349s/iter; left time: 4552.6775s
	iters: 700, epoch: 28 | loss: 0.2326360
	speed: 0.0346s/iter; left time: 4511.1290s
	iters: 800, epoch: 28 | loss: 0.2248647
	speed: 0.0337s/iter; left time: 4393.5917s
	iters: 900, epoch: 28 | loss: 0.2317350
	speed: 0.0425s/iter; left time: 5537.7323s
	iters: 1000, epoch: 28 | loss: 0.2276759
	speed: 0.0435s/iter; left time: 5663.5023s
Epoch: 28 cost time: 36.923009634017944
Vali Metrics: mse:0.4097, mae:0.4169
Test Metrics: mse:0.3053397, mae:0.3433347
Epoch: 28, Steps: 1066 | Train Loss: 0.2245704 Vali Loss: 0.4133079 Test Loss: 0.3243372
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.2145326
	speed: 0.5725s/iter; left time: 74401.4687s
	iters: 200, epoch: 29 | loss: 0.2198210
	speed: 0.0478s/iter; left time: 6213.4021s
	iters: 300, epoch: 29 | loss: 0.2279536
	speed: 0.0379s/iter; left time: 4924.0872s
	iters: 400, epoch: 29 | loss: 0.2252861
	speed: 0.0320s/iter; left time: 4147.2667s
	iters: 500, epoch: 29 | loss: 0.2207390
	speed: 0.0362s/iter; left time: 4695.6010s
	iters: 600, epoch: 29 | loss: 0.2193500
	speed: 0.0339s/iter; left time: 4394.5457s
	iters: 700, epoch: 29 | loss: 0.2301370
	speed: 0.0309s/iter; left time: 3994.0593s
	iters: 800, epoch: 29 | loss: 0.2396114
	speed: 0.0337s/iter; left time: 4353.8392s
	iters: 900, epoch: 29 | loss: 0.2417158
	speed: 0.0371s/iter; left time: 4792.0650s
	iters: 1000, epoch: 29 | loss: 0.2438589
	speed: 0.0408s/iter; left time: 5265.1226s
Epoch: 29 cost time: 40.982149600982666
Vali Metrics: mse:0.4090, mae:0.4163
Test Metrics: mse:0.3065725, mae:0.3439530
Epoch: 29, Steps: 1066 | Train Loss: 0.2245276 Vali Loss: 0.4126502 Test Loss: 0.3252627
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.2278151
	speed: 0.5038s/iter; left time: 64932.8077s
	iters: 200, epoch: 30 | loss: 0.2197943
	speed: 0.0455s/iter; left time: 5854.1783s
	iters: 300, epoch: 30 | loss: 0.2157677
	speed: 0.0472s/iter; left time: 6075.9526s
	iters: 400, epoch: 30 | loss: 0.2220390
	speed: 0.0483s/iter; left time: 6204.9835s
	iters: 500, epoch: 30 | loss: 0.2253562
	speed: 0.0451s/iter; left time: 5793.1435s
	iters: 600, epoch: 30 | loss: 0.2183309
	speed: 0.0442s/iter; left time: 5677.3787s
	iters: 700, epoch: 30 | loss: 0.2264795
	speed: 0.0373s/iter; left time: 4787.3052s
	iters: 800, epoch: 30 | loss: 0.2208613
	speed: 0.0314s/iter; left time: 4031.3946s
	iters: 900, epoch: 30 | loss: 0.2270508
	speed: 0.0356s/iter; left time: 4564.9500s
	iters: 1000, epoch: 30 | loss: 0.2398057
	speed: 0.0365s/iter; left time: 4675.8285s
Epoch: 30 cost time: 44.84455323219299
Vali Metrics: mse:0.4086, mae:0.4168
Test Metrics: mse:0.3059328, mae:0.3433296
Epoch: 30, Steps: 1066 | Train Loss: 0.2244362 Vali Loss: 0.4127166 Test Loss: 0.3246312
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.2195469
	speed: 0.4672s/iter; left time: 59719.5901s
	iters: 200, epoch: 31 | loss: 0.2216227
	speed: 0.0540s/iter; left time: 6892.3059s
	iters: 300, epoch: 31 | loss: 0.2271979
	speed: 0.0497s/iter; left time: 6343.0738s
	iters: 400, epoch: 31 | loss: 0.2198745
	speed: 0.0361s/iter; left time: 4606.5754s
	iters: 500, epoch: 31 | loss: 0.2402572
	speed: 0.0495s/iter; left time: 6310.5288s
	iters: 600, epoch: 31 | loss: 0.2294427
	speed: 0.0512s/iter; left time: 6518.4416s
	iters: 700, epoch: 31 | loss: 0.2302191
	speed: 0.0517s/iter; left time: 6579.9874s
	iters: 800, epoch: 31 | loss: 0.2246884
	speed: 0.0463s/iter; left time: 5891.4467s
	iters: 900, epoch: 31 | loss: 0.2089793
	speed: 0.0451s/iter; left time: 5727.6292s
	iters: 1000, epoch: 31 | loss: 0.2301596
	speed: 0.0509s/iter; left time: 6454.4376s
Epoch: 31 cost time: 51.87117028236389
Vali Metrics: mse:0.4092, mae:0.4170
Test Metrics: mse:0.3056108, mae:0.3438563
Epoch: 31, Steps: 1066 | Train Loss: 0.2243967 Vali Loss: 0.4130935 Test Loss: 0.3247336
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.2237031
	speed: 0.4602s/iter; left time: 58327.4660s
	iters: 200, epoch: 32 | loss: 0.2144783
	speed: 0.0465s/iter; left time: 5889.7792s
	iters: 300, epoch: 32 | loss: 0.2634326
	speed: 0.0526s/iter; left time: 6653.8750s
	iters: 400, epoch: 32 | loss: 0.2294370
	speed: 0.0483s/iter; left time: 6108.7897s
	iters: 500, epoch: 32 | loss: 0.2426259
	speed: 0.0488s/iter; left time: 6163.6201s
	iters: 600, epoch: 32 | loss: 0.2066550
	speed: 0.0491s/iter; left time: 6196.5063s
	iters: 700, epoch: 32 | loss: 0.2179227
	speed: 0.0525s/iter; left time: 6620.0488s
	iters: 800, epoch: 32 | loss: 0.2089323
	speed: 0.0477s/iter; left time: 6017.2781s
	iters: 900, epoch: 32 | loss: 0.2201176
	speed: 0.0483s/iter; left time: 6085.6282s
	iters: 1000, epoch: 32 | loss: 0.2302150
	speed: 0.0488s/iter; left time: 6136.8968s
Epoch: 32 cost time: 51.969520568847656
Vali Metrics: mse:0.4096, mae:0.4173
Test Metrics: mse:0.3063166, mae:0.3436544
Epoch: 32, Steps: 1066 | Train Loss: 0.2242624 Vali Loss: 0.4134201 Test Loss: 0.3249855
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2118742
	speed: 0.4404s/iter; left time: 55358.6539s
	iters: 200, epoch: 33 | loss: 0.2502446
	speed: 0.0360s/iter; left time: 4518.1839s
	iters: 300, epoch: 33 | loss: 0.2065784
	speed: 0.0377s/iter; left time: 4736.5609s
	iters: 400, epoch: 33 | loss: 0.2173391
	speed: 0.0366s/iter; left time: 4591.0154s
	iters: 500, epoch: 33 | loss: 0.2351019
	speed: 0.0438s/iter; left time: 5487.3665s
	iters: 600, epoch: 33 | loss: 0.2245704
	speed: 0.0432s/iter; left time: 5408.7318s
	iters: 700, epoch: 33 | loss: 0.2092243
	speed: 0.0343s/iter; left time: 4294.8530s
	iters: 800, epoch: 33 | loss: 0.2270501
	speed: 0.0348s/iter; left time: 4355.8069s
	iters: 900, epoch: 33 | loss: 0.2367730
	speed: 0.0406s/iter; left time: 5066.1240s
	iters: 1000, epoch: 33 | loss: 0.2270084
	speed: 0.0481s/iter; left time: 6005.0711s
Epoch: 33 cost time: 42.920461893081665
Vali Metrics: mse:0.4103, mae:0.4171
Test Metrics: mse:0.3039373, mae:0.3426951
Epoch: 33, Steps: 1066 | Train Loss: 0.2241906 Vali Loss: 0.4137086 Test Loss: 0.3233162
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2130033
	speed: 0.5681s/iter; left time: 70799.7301s
	iters: 200, epoch: 34 | loss: 0.2186662
	speed: 0.0492s/iter; left time: 6132.2191s
	iters: 300, epoch: 34 | loss: 0.2601475
	speed: 0.0425s/iter; left time: 5285.1941s
	iters: 400, epoch: 34 | loss: 0.2299732
	speed: 0.0391s/iter; left time: 4862.6428s
	iters: 500, epoch: 34 | loss: 0.2263240
	speed: 0.0471s/iter; left time: 5848.0032s
	iters: 600, epoch: 34 | loss: 0.2248019
	speed: 0.0475s/iter; left time: 5890.2662s
	iters: 700, epoch: 34 | loss: 0.2253942
	speed: 0.0431s/iter; left time: 5349.9771s
	iters: 800, epoch: 34 | loss: 0.2558608
	speed: 0.0384s/iter; left time: 4753.2126s
	iters: 900, epoch: 34 | loss: 0.2169683
	speed: 0.0416s/iter; left time: 5147.8025s
	iters: 1000, epoch: 34 | loss: 0.2240101
	speed: 0.0434s/iter; left time: 5367.1147s
Epoch: 34 cost time: 47.28035926818848
Vali Metrics: mse:0.4097, mae:0.4168
Test Metrics: mse:0.3044201, mae:0.3429376
Epoch: 34, Steps: 1066 | Train Loss: 0.2241663 Vali Loss: 0.4132544 Test Loss: 0.3236789
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.2204344
	speed: 0.5012s/iter; left time: 61932.3135s
	iters: 200, epoch: 35 | loss: 0.2287541
	speed: 0.0357s/iter; left time: 4408.8898s
	iters: 300, epoch: 35 | loss: 0.2189187
	speed: 0.0356s/iter; left time: 4387.7496s
	iters: 400, epoch: 35 | loss: 0.2172666
	speed: 0.0425s/iter; left time: 5239.0913s
	iters: 500, epoch: 35 | loss: 0.2203968
	speed: 0.0368s/iter; left time: 4538.2347s
	iters: 600, epoch: 35 | loss: 0.2205393
	speed: 0.0404s/iter; left time: 4968.6906s
	iters: 700, epoch: 35 | loss: 0.2193862
	speed: 0.0427s/iter; left time: 5249.9959s
	iters: 800, epoch: 35 | loss: 0.2315205
	speed: 0.0426s/iter; left time: 5237.6901s
	iters: 900, epoch: 35 | loss: 0.2353107
	speed: 0.0474s/iter; left time: 5814.0072s
	iters: 1000, epoch: 35 | loss: 0.2234652
	speed: 0.0437s/iter; left time: 5364.6675s
Epoch: 35 cost time: 44.58086371421814
Vali Metrics: mse:0.4104, mae:0.4177
Test Metrics: mse:0.3076158, mae:0.3444353
Epoch: 35, Steps: 1066 | Train Loss: 0.2240824 Vali Loss: 0.4140416 Test Loss: 0.3260255
EarlyStopping counter: 10 out of 10
Early stopping
loading model, best model path: ./checkpoints/long_term_forecast_ETTm1_rerun_2021_DeepEDM_ETTm1_ftM_sl288_ll48_pl144_emdtimeF_test_0/checkpoint.pth
>>>>>>>testing : long_term_forecast_ETTm1_rerun_2021_DeepEDM_ETTm1_ftM_sl288_ll48_pl144_emdtimeF_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11377
test shape: (11377, 144, 7) (11377, 144, 7)
mse:0.30421140789985657, mae:0.34313392639160156, dtw:not calculated
