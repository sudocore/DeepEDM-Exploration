Setting seed to 2021
{'activation_fn': 'selu',
 'add_pe': True,
 'augmentation_ratio': 0,
 'batch_size': 32,
 'checkpoints': './checkpoints',
 'clip_grad_norm': 1.0,
 'condor_job': True,
 'data': 'custom',
 'data_path': 'weather.csv',
 'delay': 5,
 'des': 'test',
 'devices': '0,1',
 'dist_projection_dim': -1,
 'edm_dropout': 0.1,
 'embed': 'timeF',
 'features': 'M',
 'freq': 'h',
 'gpu': 0,
 'inverse': False,
 'is_training': 1,
 'itr': 1,
 'label_len': 48,
 'latent_channel_dim': -1,
 'learning_rate': 0.0005,
 'loss': 'mae_tdt',
 'loss_type': 'mae',
 'lradj': 'custom',
 'min_lr': 5e-05,
 'mlp_dropout': 0.1,
 'model': 'DeepEDM',
 'model_config': {'edm_params': {'activation_fn': 'selu',
                                 'add_pe': True,
                                 'delay': 5,
                                 'dist_projection_dim': 64,
                                 'dropout': 0.1,
                                 'layer_norm': True,
                                 'method': 'simplex',
                                 'n_proj_layers': 1,
                                 'theta': 1.0,
                                 'time_delay_stride': 2},
                  'encoder_params': {'activation_fn': 'selu',
                                     'add_pe': True,
                                     'dropout': 0.1,
                                     'in_channels': 21,
                                     'latent_channel_dim': 21,
                                     'mlp_layers': 2,
                                     'use_encoder': False},
                  'lookback_len': 288,
                  'n_edm_blocks': 1,
                  'out_pred_len': 144,
                  'type': 'EDM'},
 'model_id': 'weather_rerun_2021',
 'n_edm_blocks': 1,
 'n_mlp_layers': 2,
 'n_proj_layers': -1,
 'num_workers': 4,
 'opt': {'clip_grad_norm': 1.0,
         'early_stopping_patience': 30,
         'epochs': 100,
         'learning_rate': 0.0005,
         'min_lr': 5e-05,
         'reduce_lr_factor': 0.9,
         'schedule_type': 'custom',
         'type': 'AdamW',
         'weight_decay': 1e-05},
 'output_dir': '.',
 'patience': 10,
 'pred_len': 144,
 'reduce_lr_factor': 0.9,
 'root_path': './dataset/weather',
 'seasonal_patterns': 'Monthly',
 'seed': 2021,
 'seq_len': 288,
 'target': 'OT',
 'task_name': 'long_term_forecast',
 'tdt_loss': True,
 'theta': -1,
 'time_delay_stride': 2,
 'train_epochs': 150,
 'use_amp': False,
 'use_dtw': False,
 'use_gpu': True,
 'use_multi_gpu': True}
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_rerun_2021  Model:              DeepEDM             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather   
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mForecasting Task[0m
  Seq Len:            288                 Label Len:          48                  
  Pred Len:           144                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m

[1mRun Parameters[0m
  Num Workers:        4                   Itr:                1                   
  Train Epochs:       150                 Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.0005              
  Des:                test                Loss:               mae_tdt             
  Lradj:              custom              Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

{'clip_grad_norm': 1.0,
 'early_stopping_patience': 30,
 'epochs': 100,
 'learning_rate': 0.0005,
 'min_lr': 5e-05,
 'reduce_lr_factor': 0.9,
 'schedule_type': 'custom',
 'type': 'AdamW',
 'weight_decay': 1e-05}

{'edm_params': {'activation_fn': 'selu',
                'add_pe': True,
                'delay': 5,
                'dist_projection_dim': 64,
                'dropout': 0.1,
                'layer_norm': True,
                'method': 'simplex',
                'n_proj_layers': 1,
                'theta': 1.0,
                'time_delay_stride': 2},
 'encoder_params': {'activation_fn': 'selu',
                    'add_pe': True,
                    'dropout': 0.1,
                    'in_channels': 21,
                    'latent_channel_dim': 21,
                    'mlp_layers': 2,
                    'use_encoder': False},
 'lookback_len': 288,
 'n_edm_blocks': 1,
 'out_pred_len': 144,
 'type': 'EDM'}

model: Model(
  (encoder): InputEncoder(
    (mlp_projection): Sequential(
      (0): Linear(in_features=288, out_features=144, bias=True)
      (1): Dropout(p=0.1, inplace=False)
      (2): SELU()
      (3): Linear(in_features=144, out_features=144, bias=True)
    )
  )
  (edm_blocks): ModuleList(
    (0): EDM(
      (activation_fn): SELU()
      (projection): Sequential(
        (0): Linear(in_features=5, out_features=64, bias=True)
      )
      (pe): LearnablePositionalEmbedding()
      (ln1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (attn_dropout): Dropout(p=0.1, inplace=False)
      (undelay): Sequential(
        (0): Linear(in_features=355, out_features=144, bias=True)
        (1): Dropout(p=0.1, inplace=False)
        (2): SELU()
        (3): Linear(in_features=144, out_features=144, bias=True)
      )
    )
  )
  (gate_edm): Linear(in_features=144, out_features=1, bias=True)
)
>>>>>>>start training : long_term_forecast_weather_rerun_2021_DeepEDM_custom_ftM_sl288_ll48_pl144_emdtimeF_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5127
test 10396
	iters: 100, epoch: 1 | loss: 0.2521377
	speed: 0.0526s/iter; left time: 8980.8003s
	iters: 200, epoch: 1 | loss: 0.2372970
	speed: 0.0428s/iter; left time: 7300.2974s
	iters: 300, epoch: 1 | loss: 0.2023952
	speed: 0.0426s/iter; left time: 7264.8830s
	iters: 400, epoch: 1 | loss: 0.2240919
	speed: 0.0409s/iter; left time: 6966.3740s
	iters: 500, epoch: 1 | loss: 0.2329702
	speed: 0.0365s/iter; left time: 6218.0009s
	iters: 600, epoch: 1 | loss: 0.2288471
	speed: 0.0402s/iter; left time: 6846.4725s
	iters: 700, epoch: 1 | loss: 0.2295534
	speed: 0.0426s/iter; left time: 7256.0320s
	iters: 800, epoch: 1 | loss: 0.2275287
	speed: 0.0404s/iter; left time: 6867.6517s
	iters: 900, epoch: 1 | loss: 0.1952951
	speed: 0.0411s/iter; left time: 6983.3007s
	iters: 1000, epoch: 1 | loss: 0.2155352
	speed: 0.0464s/iter; left time: 7880.1552s
	iters: 1100, epoch: 1 | loss: 0.2260622
	speed: 0.0480s/iter; left time: 8150.2184s
Epoch: 1 cost time: 48.95466613769531
Vali Metrics: mse:0.4501, mae:0.2961
Test Metrics: mse:0.1804674, mae:0.2189385
Epoch: 1, Steps: 1139 | Train Loss: 0.2220151 Vali Loss: 0.3730858 Test Loss: 0.1997029
Validation loss decreased (inf --> 0.373086).  Saving model ...
Reducing learning rate to 0.000450
	iters: 100, epoch: 2 | loss: 0.2119683
	speed: 0.5951s/iter; left time: 100930.1729s
	iters: 200, epoch: 2 | loss: 0.1905503
	speed: 0.0294s/iter; left time: 4979.2719s
	iters: 300, epoch: 2 | loss: 0.1921077
	speed: 0.0302s/iter; left time: 5112.3160s
	iters: 400, epoch: 2 | loss: 0.1959312
	speed: 0.0310s/iter; left time: 5248.2104s
	iters: 500, epoch: 2 | loss: 0.1998565
	speed: 0.0296s/iter; left time: 5015.8592s
	iters: 600, epoch: 2 | loss: 0.1812358
	speed: 0.0322s/iter; left time: 5448.0095s
	iters: 700, epoch: 2 | loss: 0.2157983
	speed: 0.0342s/iter; left time: 5781.3972s
	iters: 800, epoch: 2 | loss: 0.2008001
	speed: 0.0363s/iter; left time: 6136.2124s
	iters: 900, epoch: 2 | loss: 0.2224479
	speed: 0.0395s/iter; left time: 6666.7861s
	iters: 1000, epoch: 2 | loss: 0.1840584
	speed: 0.0488s/iter; left time: 8240.3222s
	iters: 1100, epoch: 2 | loss: 0.1899906
	speed: 0.0434s/iter; left time: 7321.4663s
Epoch: 2 cost time: 40.662758350372314
Vali Metrics: mse:0.4494, mae:0.2988
Test Metrics: mse:0.1810219, mae:0.2197275
Epoch: 2, Steps: 1139 | Train Loss: 0.1981364 Vali Loss: 0.3740943 Test Loss: 0.2003747
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000405
	iters: 100, epoch: 3 | loss: 0.1913176
	speed: 0.6723s/iter; left time: 113255.9849s
	iters: 200, epoch: 3 | loss: 0.1930788
	speed: 0.0353s/iter; left time: 5951.5983s
	iters: 300, epoch: 3 | loss: 0.1706459
	speed: 0.0321s/iter; left time: 5408.3331s
	iters: 400, epoch: 3 | loss: 0.2005805
	speed: 0.0311s/iter; left time: 5234.8164s
	iters: 500, epoch: 3 | loss: 0.2116767
	speed: 0.0355s/iter; left time: 5958.2016s
	iters: 600, epoch: 3 | loss: 0.2134763
	speed: 0.0421s/iter; left time: 7070.0026s
	iters: 700, epoch: 3 | loss: 0.2014132
	speed: 0.0447s/iter; left time: 7500.1257s
	iters: 800, epoch: 3 | loss: 0.2085329
	speed: 0.0450s/iter; left time: 7554.0542s
	iters: 900, epoch: 3 | loss: 0.2139437
	speed: 0.0514s/iter; left time: 8624.4368s
	iters: 1000, epoch: 3 | loss: 0.1748528
	speed: 0.0518s/iter; left time: 8683.6895s
	iters: 1100, epoch: 3 | loss: 0.1900580
	speed: 0.0458s/iter; left time: 7665.4818s
Epoch: 3 cost time: 47.18372440338135
Vali Metrics: mse:0.4471, mae:0.2938
Test Metrics: mse:0.1784656, mae:0.2159070
Epoch: 3, Steps: 1139 | Train Loss: 0.1947065 Vali Loss: 0.3704356 Test Loss: 0.1971863
Validation loss decreased (0.373086 --> 0.370436).  Saving model ...
Reducing learning rate to 0.000365
	iters: 100, epoch: 4 | loss: 0.1949226
	speed: 0.5950s/iter; left time: 99568.0439s
	iters: 200, epoch: 4 | loss: 0.1821743
	speed: 0.0393s/iter; left time: 6573.5200s
	iters: 300, epoch: 4 | loss: 0.2003169
	speed: 0.0424s/iter; left time: 7084.2816s
	iters: 400, epoch: 4 | loss: 0.1785749
	speed: 0.0443s/iter; left time: 7392.9537s
	iters: 500, epoch: 4 | loss: 0.1714747
	speed: 0.0456s/iter; left time: 7616.5743s
	iters: 600, epoch: 4 | loss: 0.1909430
	speed: 0.0514s/iter; left time: 8570.7050s
	iters: 700, epoch: 4 | loss: 0.1920302
	speed: 0.0534s/iter; left time: 8907.4737s
	iters: 800, epoch: 4 | loss: 0.1843596
	speed: 0.0548s/iter; left time: 9133.0076s
	iters: 900, epoch: 4 | loss: 0.1985443
	speed: 0.0429s/iter; left time: 7146.4327s
	iters: 1000, epoch: 4 | loss: 0.1992777
	speed: 0.0402s/iter; left time: 6688.7683s
	iters: 1100, epoch: 4 | loss: 0.1777225
	speed: 0.0474s/iter; left time: 7882.7615s
Epoch: 4 cost time: 51.65172624588013
Vali Metrics: mse:0.4425, mae:0.2890
Test Metrics: mse:0.1774868, mae:0.2143369
Epoch: 4, Steps: 1139 | Train Loss: 0.1930387 Vali Loss: 0.3657417 Test Loss: 0.1959118
Validation loss decreased (0.370436 --> 0.365742).  Saving model ...
Reducing learning rate to 0.000328
	iters: 100, epoch: 5 | loss: 0.1882760
	speed: 0.6374s/iter; left time: 105929.0333s
	iters: 200, epoch: 5 | loss: 0.1866312
	speed: 0.0470s/iter; left time: 7803.4559s
	iters: 300, epoch: 5 | loss: 0.1998827
	speed: 0.0459s/iter; left time: 7616.0589s
	iters: 400, epoch: 5 | loss: 0.1824708
	speed: 0.0514s/iter; left time: 8521.9887s
	iters: 500, epoch: 5 | loss: 0.1831751
	speed: 0.0480s/iter; left time: 7961.5527s
	iters: 600, epoch: 5 | loss: 0.1791448
	speed: 0.0416s/iter; left time: 6892.1007s
	iters: 700, epoch: 5 | loss: 0.1971298
	speed: 0.0458s/iter; left time: 7586.0867s
	iters: 800, epoch: 5 | loss: 0.1824930
	speed: 0.0465s/iter; left time: 7699.3845s
	iters: 900, epoch: 5 | loss: 0.1809450
	speed: 0.0501s/iter; left time: 8290.7577s
	iters: 1000, epoch: 5 | loss: 0.1927774
	speed: 0.0546s/iter; left time: 9024.4852s
	iters: 1100, epoch: 5 | loss: 0.1919759
	speed: 0.0530s/iter; left time: 8751.7847s
Epoch: 5 cost time: 55.455413818359375
Vali Metrics: mse:0.4433, mae:0.2897
Test Metrics: mse:0.1774129, mae:0.2140274
Epoch: 5, Steps: 1139 | Train Loss: 0.1921114 Vali Loss: 0.3664767 Test Loss: 0.1957202
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000295
	iters: 100, epoch: 6 | loss: 0.1855579
	speed: 0.6043s/iter; left time: 99745.0858s
	iters: 200, epoch: 6 | loss: 0.1955330
	speed: 0.0419s/iter; left time: 6917.3525s
	iters: 300, epoch: 6 | loss: 0.1831741
	speed: 0.0358s/iter; left time: 5900.4376s
	iters: 400, epoch: 6 | loss: 0.2042426
	speed: 0.0374s/iter; left time: 6164.5989s
	iters: 500, epoch: 6 | loss: 0.1976185
	speed: 0.0397s/iter; left time: 6542.7895s
	iters: 600, epoch: 6 | loss: 0.1810113
	speed: 0.0391s/iter; left time: 6430.1819s
	iters: 700, epoch: 6 | loss: 0.1736404
	speed: 0.0386s/iter; left time: 6350.6457s
	iters: 800, epoch: 6 | loss: 0.1997590
	speed: 0.0460s/iter; left time: 7565.6008s
	iters: 900, epoch: 6 | loss: 0.1870133
	speed: 0.0466s/iter; left time: 7658.1907s
	iters: 1000, epoch: 6 | loss: 0.1921021
	speed: 0.0353s/iter; left time: 5801.6005s
	iters: 1100, epoch: 6 | loss: 0.1963520
	speed: 0.0370s/iter; left time: 6070.0834s
Epoch: 6 cost time: 45.80410933494568
Vali Metrics: mse:0.4389, mae:0.2872
Test Metrics: mse:0.1762151, mae:0.2127015
Epoch: 6, Steps: 1139 | Train Loss: 0.1911070 Vali Loss: 0.3630731 Test Loss: 0.1944583
Validation loss decreased (0.365742 --> 0.363073).  Saving model ...
Reducing learning rate to 0.000266
	iters: 100, epoch: 7 | loss: 0.1839839
	speed: 0.6956s/iter; left time: 114019.2562s
	iters: 200, epoch: 7 | loss: 0.1624177
	speed: 0.0470s/iter; left time: 7692.6906s
	iters: 300, epoch: 7 | loss: 0.1939646
	speed: 0.0460s/iter; left time: 7525.7893s
	iters: 400, epoch: 7 | loss: 0.1996607
	speed: 0.0520s/iter; left time: 8507.0027s
	iters: 500, epoch: 7 | loss: 0.1879024
	speed: 0.0478s/iter; left time: 7809.2761s
	iters: 600, epoch: 7 | loss: 0.1939694
	speed: 0.0496s/iter; left time: 8106.4316s
	iters: 700, epoch: 7 | loss: 0.2061727
	speed: 0.0428s/iter; left time: 6981.8443s
	iters: 800, epoch: 7 | loss: 0.1845363
	speed: 0.0440s/iter; left time: 7187.3825s
	iters: 900, epoch: 7 | loss: 0.1806776
	speed: 0.0522s/iter; left time: 8508.5115s
	iters: 1000, epoch: 7 | loss: 0.2057328
	speed: 0.0505s/iter; left time: 8230.6856s
	iters: 1100, epoch: 7 | loss: 0.2043283
	speed: 0.0445s/iter; left time: 7248.8681s
Epoch: 7 cost time: 55.37846398353577
Vali Metrics: mse:0.4390, mae:0.2867
Test Metrics: mse:0.1748927, mae:0.2117840
Epoch: 7, Steps: 1139 | Train Loss: 0.1903718 Vali Loss: 0.3628829 Test Loss: 0.1933383
Validation loss decreased (0.363073 --> 0.362883).  Saving model ...
Reducing learning rate to 0.000239
	iters: 100, epoch: 8 | loss: 0.1824267
	speed: 0.5553s/iter; left time: 90384.0040s
	iters: 200, epoch: 8 | loss: 0.1901586
	speed: 0.0458s/iter; left time: 7453.5177s
	iters: 300, epoch: 8 | loss: 0.1812806
	speed: 0.0447s/iter; left time: 7274.0695s
	iters: 400, epoch: 8 | loss: 0.1768008
	speed: 0.0495s/iter; left time: 8041.6899s
	iters: 500, epoch: 8 | loss: 0.1942066
	speed: 0.0482s/iter; left time: 7820.2929s
	iters: 600, epoch: 8 | loss: 0.1577545
	speed: 0.0469s/iter; left time: 7604.9365s
	iters: 700, epoch: 8 | loss: 0.1976999
	speed: 0.0502s/iter; left time: 8133.7191s
	iters: 800, epoch: 8 | loss: 0.1784212
	speed: 0.0474s/iter; left time: 7674.4121s
	iters: 900, epoch: 8 | loss: 0.1716266
	speed: 0.0481s/iter; left time: 7785.0469s
	iters: 1000, epoch: 8 | loss: 0.2117490
	speed: 0.0503s/iter; left time: 8148.2433s
	iters: 1100, epoch: 8 | loss: 0.1805181
	speed: 0.0491s/iter; left time: 7948.5888s
Epoch: 8 cost time: 54.401336669921875
Vali Metrics: mse:0.4362, mae:0.2864
Test Metrics: mse:0.1747056, mae:0.2113854
Epoch: 8, Steps: 1139 | Train Loss: 0.1899001 Vali Loss: 0.3613008 Test Loss: 0.1930455
Validation loss decreased (0.362883 --> 0.361301).  Saving model ...
Reducing learning rate to 0.000215
	iters: 100, epoch: 9 | loss: 0.1776131
	speed: 0.5865s/iter; left time: 94807.4497s
	iters: 200, epoch: 9 | loss: 0.1837407
	speed: 0.0535s/iter; left time: 8637.3808s
	iters: 300, epoch: 9 | loss: 0.1863549
	speed: 0.0482s/iter; left time: 7781.8289s
	iters: 400, epoch: 9 | loss: 0.1987081
	speed: 0.0550s/iter; left time: 8867.2134s
	iters: 500, epoch: 9 | loss: 0.1960485
	speed: 0.0490s/iter; left time: 7901.3082s
	iters: 600, epoch: 9 | loss: 0.1897623
	speed: 0.0443s/iter; left time: 7136.4478s
	iters: 700, epoch: 9 | loss: 0.1928592
	speed: 0.0456s/iter; left time: 7342.4634s
	iters: 800, epoch: 9 | loss: 0.2028830
	speed: 0.0453s/iter; left time: 7289.6296s
	iters: 900, epoch: 9 | loss: 0.2252463
	speed: 0.0392s/iter; left time: 6303.0970s
	iters: 1000, epoch: 9 | loss: 0.1802053
	speed: 0.0490s/iter; left time: 7868.7443s
	iters: 1100, epoch: 9 | loss: 0.1837017
	speed: 0.0467s/iter; left time: 7503.6714s
Epoch: 9 cost time: 55.11535048484802
Vali Metrics: mse:0.4351, mae:0.2859
Test Metrics: mse:0.1745945, mae:0.2112017
Epoch: 9, Steps: 1139 | Train Loss: 0.1892482 Vali Loss: 0.3604924 Test Loss: 0.1928981
Validation loss decreased (0.361301 --> 0.360492).  Saving model ...
Reducing learning rate to 0.000194
	iters: 100, epoch: 10 | loss: 0.1920101
	speed: 0.6780s/iter; left time: 108814.9315s
	iters: 200, epoch: 10 | loss: 0.2073776
	speed: 0.0409s/iter; left time: 6557.8244s
	iters: 300, epoch: 10 | loss: 0.1766575
	speed: 0.0359s/iter; left time: 5758.9005s
	iters: 400, epoch: 10 | loss: 0.1820471
	speed: 0.0290s/iter; left time: 4640.2707s
	iters: 500, epoch: 10 | loss: 0.1911060
	speed: 0.0313s/iter; left time: 5007.9700s
	iters: 600, epoch: 10 | loss: 0.2036469
	speed: 0.0320s/iter; left time: 5121.8849s
	iters: 700, epoch: 10 | loss: 0.1965352
	speed: 0.0322s/iter; left time: 5155.6289s
	iters: 800, epoch: 10 | loss: 0.1823550
	speed: 0.0309s/iter; left time: 4945.5395s
	iters: 900, epoch: 10 | loss: 0.1910014
	speed: 0.0307s/iter; left time: 4905.7190s
	iters: 1000, epoch: 10 | loss: 0.1943400
	speed: 0.0355s/iter; left time: 5672.7424s
	iters: 1100, epoch: 10 | loss: 0.1903424
	speed: 0.0402s/iter; left time: 6416.1998s
Epoch: 10 cost time: 40.12507104873657
Vali Metrics: mse:0.4328, mae:0.2865
Test Metrics: mse:0.1744815, mae:0.2119742
Epoch: 10, Steps: 1139 | Train Loss: 0.1887527 Vali Loss: 0.3596773 Test Loss: 0.1932279
Validation loss decreased (0.360492 --> 0.359677).  Saving model ...
Reducing learning rate to 0.000174
	iters: 100, epoch: 11 | loss: 0.1707981
	speed: 0.7007s/iter; left time: 111670.4009s
	iters: 200, epoch: 11 | loss: 0.1836538
	speed: 0.0515s/iter; left time: 8204.2586s
	iters: 300, epoch: 11 | loss: 0.1947110
	speed: 0.0522s/iter; left time: 8314.1149s
	iters: 400, epoch: 11 | loss: 0.2116984
	speed: 0.0508s/iter; left time: 8075.4862s
	iters: 500, epoch: 11 | loss: 0.1802808
	speed: 0.0509s/iter; left time: 8094.6799s
	iters: 600, epoch: 11 | loss: 0.1845942
	speed: 0.0452s/iter; left time: 7181.0766s
	iters: 700, epoch: 11 | loss: 0.1871043
	speed: 0.0401s/iter; left time: 6362.9465s
	iters: 800, epoch: 11 | loss: 0.2002485
	speed: 0.0420s/iter; left time: 6657.7199s
	iters: 900, epoch: 11 | loss: 0.1855358
	speed: 0.0502s/iter; left time: 7953.6731s
	iters: 1000, epoch: 11 | loss: 0.1781666
	speed: 0.0467s/iter; left time: 7403.5048s
	iters: 1100, epoch: 11 | loss: 0.2011708
	speed: 0.0347s/iter; left time: 5496.1926s
Epoch: 11 cost time: 53.45678353309631
Vali Metrics: mse:0.4343, mae:0.2865
Test Metrics: mse:0.175165, mae:0.2121694
Epoch: 11, Steps: 1139 | Train Loss: 0.1883593 Vali Loss: 0.3603979 Test Loss: 0.1936672
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000157
	iters: 100, epoch: 12 | loss: 0.1890925
	speed: 0.6123s/iter; left time: 96878.5147s
	iters: 200, epoch: 12 | loss: 0.1893018
	speed: 0.0374s/iter; left time: 5907.6623s
	iters: 300, epoch: 12 | loss: 0.2015037
	speed: 0.0381s/iter; left time: 6022.4002s
	iters: 400, epoch: 12 | loss: 0.1686768
	speed: 0.0372s/iter; left time: 5875.9428s
	iters: 500, epoch: 12 | loss: 0.1837149
	speed: 0.0373s/iter; left time: 5893.9332s
	iters: 600, epoch: 12 | loss: 0.2112236
	speed: 0.0283s/iter; left time: 4464.9392s
	iters: 700, epoch: 12 | loss: 0.1877408
	speed: 0.0424s/iter; left time: 6682.7647s
	iters: 800, epoch: 12 | loss: 0.1707852
	speed: 0.0430s/iter; left time: 6777.0637s
	iters: 900, epoch: 12 | loss: 0.1840617
	speed: 0.0528s/iter; left time: 8307.0650s
	iters: 1000, epoch: 12 | loss: 0.1739725
	speed: 0.0473s/iter; left time: 7436.3788s
	iters: 1100, epoch: 12 | loss: 0.1827524
	speed: 0.0470s/iter; left time: 7386.3472s
Epoch: 12 cost time: 47.056644678115845
Vali Metrics: mse:0.4355, mae:0.2858
Test Metrics: mse:0.1741682, mae:0.2105681
Epoch: 12, Steps: 1139 | Train Loss: 0.1880102 Vali Loss: 0.3606551 Test Loss: 0.1923682
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000141
	iters: 100, epoch: 13 | loss: 0.1911457
	speed: 0.6447s/iter; left time: 101264.5449s
	iters: 200, epoch: 13 | loss: 0.1839877
	speed: 0.0382s/iter; left time: 5997.4384s
	iters: 300, epoch: 13 | loss: 0.1786331
	speed: 0.0479s/iter; left time: 7519.8693s
	iters: 400, epoch: 13 | loss: 0.1983286
	speed: 0.0540s/iter; left time: 8463.7115s
	iters: 500, epoch: 13 | loss: 0.2007546
	speed: 0.0577s/iter; left time: 9046.3645s
	iters: 600, epoch: 13 | loss: 0.2272511
	speed: 0.0525s/iter; left time: 8215.6998s
	iters: 700, epoch: 13 | loss: 0.1939748
	speed: 0.0579s/iter; left time: 9062.0531s
	iters: 800, epoch: 13 | loss: 0.1973175
	speed: 0.0589s/iter; left time: 9213.4420s
	iters: 900, epoch: 13 | loss: 0.1776079
	speed: 0.0585s/iter; left time: 9142.3504s
	iters: 1000, epoch: 13 | loss: 0.1917893
	speed: 0.0533s/iter; left time: 8326.6942s
	iters: 1100, epoch: 13 | loss: 0.1842961
	speed: 0.0517s/iter; left time: 8072.7496s
Epoch: 13 cost time: 59.335832357406616
Vali Metrics: mse:0.4332, mae:0.2856
Test Metrics: mse:0.173761, mae:0.2107234
Epoch: 13, Steps: 1139 | Train Loss: 0.1876933 Vali Loss: 0.3594292 Test Loss: 0.1922422
Validation loss decreased (0.359677 --> 0.359429).  Saving model ...
Reducing learning rate to 0.000127
	iters: 100, epoch: 14 | loss: 0.2002970
	speed: 0.5627s/iter; left time: 87744.6765s
	iters: 200, epoch: 14 | loss: 0.1747040
	speed: 0.0484s/iter; left time: 7541.3394s
	iters: 300, epoch: 14 | loss: 0.1898202
	speed: 0.0466s/iter; left time: 7264.1011s
	iters: 400, epoch: 14 | loss: 0.1986947
	speed: 0.0445s/iter; left time: 6919.5613s
	iters: 500, epoch: 14 | loss: 0.1698663
	speed: 0.0454s/iter; left time: 7058.2609s
	iters: 600, epoch: 14 | loss: 0.1810258
	speed: 0.0477s/iter; left time: 7420.0830s
	iters: 700, epoch: 14 | loss: 0.1741841
	speed: 0.0534s/iter; left time: 8291.9039s
	iters: 800, epoch: 14 | loss: 0.1818279
	speed: 0.0494s/iter; left time: 7672.8849s
	iters: 900, epoch: 14 | loss: 0.1967197
	speed: 0.0446s/iter; left time: 6912.5950s
	iters: 1000, epoch: 14 | loss: 0.1935282
	speed: 0.0524s/iter; left time: 8123.3900s
	iters: 1100, epoch: 14 | loss: 0.2037164
	speed: 0.0469s/iter; left time: 7262.3971s
Epoch: 14 cost time: 54.66514778137207
Vali Metrics: mse:0.4317, mae:0.2861
Test Metrics: mse:0.1743848, mae:0.2113119
Epoch: 14, Steps: 1139 | Train Loss: 0.1873458 Vali Loss: 0.3589131 Test Loss: 0.1928484
Validation loss decreased (0.359429 --> 0.358913).  Saving model ...
Reducing learning rate to 0.000114
	iters: 100, epoch: 15 | loss: 0.2016957
	speed: 0.5021s/iter; left time: 77726.1497s
	iters: 200, epoch: 15 | loss: 0.1694677
	speed: 0.0555s/iter; left time: 8590.5635s
	iters: 300, epoch: 15 | loss: 0.1874323
	speed: 0.0547s/iter; left time: 8463.4665s
	iters: 400, epoch: 15 | loss: 0.2039945
	speed: 0.0576s/iter; left time: 8891.8558s
	iters: 500, epoch: 15 | loss: 0.1787720
	speed: 0.0615s/iter; left time: 9495.8660s
	iters: 600, epoch: 15 | loss: 0.1910362
	speed: 0.0581s/iter; left time: 8959.7702s
	iters: 700, epoch: 15 | loss: 0.1929733
	speed: 0.0608s/iter; left time: 9370.8528s
	iters: 800, epoch: 15 | loss: 0.1713539
	speed: 0.0613s/iter; left time: 9449.7318s
	iters: 900, epoch: 15 | loss: 0.1830372
	speed: 0.0598s/iter; left time: 9204.9020s
	iters: 1000, epoch: 15 | loss: 0.1940957
	speed: 0.0505s/iter; left time: 7775.4120s
	iters: 1100, epoch: 15 | loss: 0.1588465
	speed: 0.0512s/iter; left time: 7867.5291s
Epoch: 15 cost time: 64.07774186134338
Vali Metrics: mse:0.4325, mae:0.2845
Test Metrics: mse:0.1745763, mae:0.2108163
Epoch: 15, Steps: 1139 | Train Loss: 0.1870497 Vali Loss: 0.3585119 Test Loss: 0.1926963
Validation loss decreased (0.358913 --> 0.358512).  Saving model ...
Reducing learning rate to 0.000103
	iters: 100, epoch: 16 | loss: 0.1817945
	speed: 0.5521s/iter; left time: 84846.4979s
	iters: 200, epoch: 16 | loss: 0.1722957
	speed: 0.0373s/iter; left time: 5723.5926s
	iters: 300, epoch: 16 | loss: 0.1822279
	speed: 0.0417s/iter; left time: 6393.4274s
	iters: 400, epoch: 16 | loss: 0.1829626
	speed: 0.0465s/iter; left time: 7127.6736s
	iters: 500, epoch: 16 | loss: 0.1774567
	speed: 0.0427s/iter; left time: 6542.7528s
	iters: 600, epoch: 16 | loss: 0.1969148
	speed: 0.0477s/iter; left time: 7302.8068s
	iters: 700, epoch: 16 | loss: 0.1704467
	speed: 0.0515s/iter; left time: 7889.2396s
	iters: 800, epoch: 16 | loss: 0.1778494
	speed: 0.0461s/iter; left time: 7056.8656s
	iters: 900, epoch: 16 | loss: 0.1793235
	speed: 0.0419s/iter; left time: 6409.2768s
	iters: 1000, epoch: 16 | loss: 0.1824110
	speed: 0.0466s/iter; left time: 7123.8029s
	iters: 1100, epoch: 16 | loss: 0.1838948
	speed: 0.0476s/iter; left time: 7266.2333s
Epoch: 16 cost time: 51.12534761428833
Vali Metrics: mse:0.4330, mae:0.2849
Test Metrics: mse:0.1748484, mae:0.2110439
Epoch: 16, Steps: 1139 | Train Loss: 0.1867513 Vali Loss: 0.3589658 Test Loss: 0.1929461
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000093
	iters: 100, epoch: 17 | loss: 0.2079972
	speed: 0.6455s/iter; left time: 98458.7233s
	iters: 200, epoch: 17 | loss: 0.1758797
	speed: 0.0442s/iter; left time: 6741.2998s
	iters: 300, epoch: 17 | loss: 0.1640070
	speed: 0.0503s/iter; left time: 7658.6698s
	iters: 400, epoch: 17 | loss: 0.1699060
	speed: 0.0479s/iter; left time: 7294.6776s
	iters: 500, epoch: 17 | loss: 0.1931480
	speed: 0.0550s/iter; left time: 8371.6464s
	iters: 600, epoch: 17 | loss: 0.1852103
	speed: 0.0516s/iter; left time: 7841.6556s
	iters: 700, epoch: 17 | loss: 0.1745010
	speed: 0.0424s/iter; left time: 6447.9524s
	iters: 800, epoch: 17 | loss: 0.1833446
	speed: 0.0435s/iter; left time: 6609.5584s
	iters: 900, epoch: 17 | loss: 0.1839814
	speed: 0.0539s/iter; left time: 8171.9749s
	iters: 1000, epoch: 17 | loss: 0.1794002
	speed: 0.0568s/iter; left time: 8607.8714s
	iters: 1100, epoch: 17 | loss: 0.1908381
	speed: 0.0467s/iter; left time: 7071.0098s
Epoch: 17 cost time: 56.48742318153381
Vali Metrics: mse:0.4309, mae:0.2845
Test Metrics: mse:0.1739497, mae:0.2105018
Epoch: 17, Steps: 1139 | Train Loss: 0.1865862 Vali Loss: 0.3576930 Test Loss: 0.1922258
Validation loss decreased (0.358512 --> 0.357693).  Saving model ...
Reducing learning rate to 0.000083
	iters: 100, epoch: 18 | loss: 0.1844876
	speed: 0.6689s/iter; left time: 101259.0047s
	iters: 200, epoch: 18 | loss: 0.1784989
	speed: 0.0428s/iter; left time: 6481.9071s
	iters: 300, epoch: 18 | loss: 0.1832850
	speed: 0.0375s/iter; left time: 5663.9293s
	iters: 400, epoch: 18 | loss: 0.1728183
	speed: 0.0415s/iter; left time: 6272.7342s
	iters: 500, epoch: 18 | loss: 0.1758798
	speed: 0.0407s/iter; left time: 6152.7474s
	iters: 600, epoch: 18 | loss: 0.1988433
	speed: 0.0408s/iter; left time: 6148.8149s
	iters: 700, epoch: 18 | loss: 0.1741869
	speed: 0.0421s/iter; left time: 6350.5357s
	iters: 800, epoch: 18 | loss: 0.2282098
	speed: 0.0453s/iter; left time: 6824.8816s
	iters: 900, epoch: 18 | loss: 0.1891824
	speed: 0.0452s/iter; left time: 6799.8777s
	iters: 1000, epoch: 18 | loss: 0.1797658
	speed: 0.0454s/iter; left time: 6838.1444s
	iters: 1100, epoch: 18 | loss: 0.1713633
	speed: 0.0449s/iter; left time: 6747.5001s
Epoch: 18 cost time: 49.34434103965759
Vali Metrics: mse:0.4308, mae:0.2831
Test Metrics: mse:0.1733691, mae:0.2094457
Epoch: 18, Steps: 1139 | Train Loss: 0.1863399 Vali Loss: 0.3569248 Test Loss: 0.1914074
Validation loss decreased (0.357693 --> 0.356925).  Saving model ...
Reducing learning rate to 0.000075
	iters: 100, epoch: 19 | loss: 0.2038111
	speed: 0.6064s/iter; left time: 91109.3975s
	iters: 200, epoch: 19 | loss: 0.1857221
	speed: 0.0519s/iter; left time: 7792.8481s
	iters: 300, epoch: 19 | loss: 0.1755525
	speed: 0.0575s/iter; left time: 8629.0345s
	iters: 400, epoch: 19 | loss: 0.1767482
	speed: 0.0534s/iter; left time: 8003.0425s
	iters: 500, epoch: 19 | loss: 0.1687075
	speed: 0.0550s/iter; left time: 8239.9869s
	iters: 600, epoch: 19 | loss: 0.1765011
	speed: 0.0592s/iter; left time: 8864.0670s
	iters: 700, epoch: 19 | loss: 0.1707795
	speed: 0.0545s/iter; left time: 8159.1605s
	iters: 800, epoch: 19 | loss: 0.2032211
	speed: 0.0533s/iter; left time: 7976.9210s
	iters: 900, epoch: 19 | loss: 0.1854679
	speed: 0.0526s/iter; left time: 7856.8189s
	iters: 1000, epoch: 19 | loss: 0.1909355
	speed: 0.0491s/iter; left time: 7334.3478s
	iters: 1100, epoch: 19 | loss: 0.2081526
	speed: 0.0265s/iter; left time: 3956.6789s
Epoch: 19 cost time: 57.84591341018677
Vali Metrics: mse:0.4325, mae:0.2853
Test Metrics: mse:0.1741132, mae:0.2106494
Epoch: 19, Steps: 1139 | Train Loss: 0.1861594 Vali Loss: 0.3588644 Test Loss: 0.1923813
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000068
	iters: 100, epoch: 20 | loss: 0.1716979
	speed: 0.6285s/iter; left time: 93715.8930s
	iters: 200, epoch: 20 | loss: 0.1755721
	speed: 0.0471s/iter; left time: 7014.0098s
	iters: 300, epoch: 20 | loss: 0.1671640
	speed: 0.0399s/iter; left time: 5934.5529s
	iters: 400, epoch: 20 | loss: 0.1883435
	speed: 0.0415s/iter; left time: 6177.2798s
	iters: 500, epoch: 20 | loss: 0.1789211
	speed: 0.0455s/iter; left time: 6764.3506s
	iters: 600, epoch: 20 | loss: 0.1860777
	speed: 0.0449s/iter; left time: 6669.5451s
	iters: 700, epoch: 20 | loss: 0.1654818
	speed: 0.0473s/iter; left time: 7025.6600s
	iters: 800, epoch: 20 | loss: 0.1914663
	speed: 0.0446s/iter; left time: 6617.5561s
	iters: 900, epoch: 20 | loss: 0.1917372
	speed: 0.0420s/iter; left time: 6229.5865s
	iters: 1000, epoch: 20 | loss: 0.1817979
	speed: 0.0323s/iter; left time: 4787.4244s
	iters: 1100, epoch: 20 | loss: 0.1980265
	speed: 0.0440s/iter; left time: 6509.8557s
Epoch: 20 cost time: 50.082563400268555
Vali Metrics: mse:0.4309, mae:0.2842
Test Metrics: mse:0.1744979, mae:0.2107774
Epoch: 20, Steps: 1139 | Train Loss: 0.1859579 Vali Loss: 0.3575563 Test Loss: 0.1926377
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000061
	iters: 100, epoch: 21 | loss: 0.1945321
	speed: 0.6409s/iter; left time: 94839.3034s
	iters: 200, epoch: 21 | loss: 0.1849040
	speed: 0.0429s/iter; left time: 6348.4849s
	iters: 300, epoch: 21 | loss: 0.1957607
	speed: 0.0504s/iter; left time: 7447.4470s
	iters: 400, epoch: 21 | loss: 0.1877857
	speed: 0.0515s/iter; left time: 7605.5752s
	iters: 500, epoch: 21 | loss: 0.1887552
	speed: 0.0439s/iter; left time: 6484.5495s
	iters: 600, epoch: 21 | loss: 0.1712424
	speed: 0.0513s/iter; left time: 7572.1858s
	iters: 700, epoch: 21 | loss: 0.1894673
	speed: 0.0527s/iter; left time: 7765.4826s
	iters: 800, epoch: 21 | loss: 0.1871270
	speed: 0.0530s/iter; left time: 7806.4444s
	iters: 900, epoch: 21 | loss: 0.1974750
	speed: 0.0511s/iter; left time: 7527.6633s
	iters: 1000, epoch: 21 | loss: 0.1806941
	speed: 0.0539s/iter; left time: 7928.6001s
	iters: 1100, epoch: 21 | loss: 0.1857388
	speed: 0.0497s/iter; left time: 7311.6358s
Epoch: 21 cost time: 57.31814932823181
Vali Metrics: mse:0.4296, mae:0.2838
Test Metrics: mse:0.1739445, mae:0.2103606
Epoch: 21, Steps: 1139 | Train Loss: 0.1858125 Vali Loss: 0.3566722 Test Loss: 0.1921526
Validation loss decreased (0.356925 --> 0.356672).  Saving model ...
Reducing learning rate to 0.000055
	iters: 100, epoch: 22 | loss: 0.1970256
	speed: 0.5968s/iter; left time: 87632.9617s
	iters: 200, epoch: 22 | loss: 0.2066359
	speed: 0.0444s/iter; left time: 6520.6784s
	iters: 300, epoch: 22 | loss: 0.1930222
	speed: 0.0487s/iter; left time: 7136.2800s
	iters: 400, epoch: 22 | loss: 0.1768317
	speed: 0.0462s/iter; left time: 6762.6251s
	iters: 500, epoch: 22 | loss: 0.1855786
	speed: 0.0484s/iter; left time: 7083.9885s
	iters: 600, epoch: 22 | loss: 0.2015681
	speed: 0.0553s/iter; left time: 8090.7277s
	iters: 700, epoch: 22 | loss: 0.1929523
	speed: 0.0535s/iter; left time: 7828.6415s
	iters: 800, epoch: 22 | loss: 0.1971758
	speed: 0.0468s/iter; left time: 6840.5919s
	iters: 900, epoch: 22 | loss: 0.1887735
	speed: 0.0453s/iter; left time: 6614.8568s
	iters: 1000, epoch: 22 | loss: 0.1792148
	speed: 0.0506s/iter; left time: 7385.4719s
	iters: 1100, epoch: 22 | loss: 0.2013249
	speed: 0.0507s/iter; left time: 7394.0091s
Epoch: 22 cost time: 55.44590497016907
Vali Metrics: mse:0.4301, mae:0.2842
Test Metrics: mse:0.1733696, mae:0.2099037
Epoch: 22, Steps: 1139 | Train Loss: 0.1856726 Vali Loss: 0.3571487 Test Loss: 0.1916367
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000050
	iters: 100, epoch: 23 | loss: 0.2095590
	speed: 0.5417s/iter; left time: 78921.6505s
	iters: 200, epoch: 23 | loss: 0.1802686
	speed: 0.0487s/iter; left time: 7095.2598s
	iters: 300, epoch: 23 | loss: 0.2010254
	speed: 0.0552s/iter; left time: 8034.3806s
	iters: 400, epoch: 23 | loss: 0.1728277
	speed: 0.0600s/iter; left time: 8720.6061s
	iters: 500, epoch: 23 | loss: 0.1692198
	speed: 0.0571s/iter; left time: 8294.6182s
	iters: 600, epoch: 23 | loss: 0.1866744
	speed: 0.0589s/iter; left time: 8558.7095s
	iters: 700, epoch: 23 | loss: 0.1740766
	speed: 0.0540s/iter; left time: 7829.7875s
	iters: 800, epoch: 23 | loss: 0.1856798
	speed: 0.0536s/iter; left time: 7770.5312s
	iters: 900, epoch: 23 | loss: 0.1747599
	speed: 0.0542s/iter; left time: 7858.7297s
	iters: 1000, epoch: 23 | loss: 0.2037053
	speed: 0.0496s/iter; left time: 7177.6214s
	iters: 1100, epoch: 23 | loss: 0.1874372
	speed: 0.0455s/iter; left time: 6579.0937s
Epoch: 23 cost time: 60.06709933280945
Vali Metrics: mse:0.4302, mae:0.2828
Test Metrics: mse:0.1735419, mae:0.2094857
Epoch: 23, Steps: 1139 | Train Loss: 0.1855707 Vali Loss: 0.3564610 Test Loss: 0.1915138
Validation loss decreased (0.356672 --> 0.356461).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1859355
	speed: 0.6213s/iter; left time: 89806.0756s
	iters: 200, epoch: 24 | loss: 0.1968579
	speed: 0.0506s/iter; left time: 7302.5762s
	iters: 300, epoch: 24 | loss: 0.1715471
	speed: 0.0497s/iter; left time: 7181.1405s
	iters: 400, epoch: 24 | loss: 0.1744277
	speed: 0.0511s/iter; left time: 7367.6122s
	iters: 500, epoch: 24 | loss: 0.1812957
	speed: 0.0507s/iter; left time: 7307.1869s
	iters: 600, epoch: 24 | loss: 0.2075691
	speed: 0.0232s/iter; left time: 3343.3101s
	iters: 700, epoch: 24 | loss: 0.1791303
	speed: 0.0293s/iter; left time: 4212.7117s
	iters: 800, epoch: 24 | loss: 0.2231304
	speed: 0.0302s/iter; left time: 4340.5217s
	iters: 900, epoch: 24 | loss: 0.1836929
	speed: 0.0323s/iter; left time: 4645.2582s
	iters: 1000, epoch: 24 | loss: 0.1809846
	speed: 0.0377s/iter; left time: 5410.9718s
	iters: 1100, epoch: 24 | loss: 0.1742427
	speed: 0.0372s/iter; left time: 5335.6144s
Epoch: 24 cost time: 45.872257709503174
Vali Metrics: mse:0.4308, mae:0.2844
Test Metrics: mse:0.1741837, mae:0.2106896
Epoch: 24, Steps: 1139 | Train Loss: 0.1854988 Vali Loss: 0.3575999 Test Loss: 0.1924367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1766525
	speed: 0.6821s/iter; left time: 97827.0763s
	iters: 200, epoch: 25 | loss: 0.2047122
	speed: 0.0547s/iter; left time: 7839.1594s
	iters: 300, epoch: 25 | loss: 0.1787717
	speed: 0.0486s/iter; left time: 6962.8490s
	iters: 400, epoch: 25 | loss: 0.1885486
	speed: 0.0420s/iter; left time: 6010.7970s
	iters: 500, epoch: 25 | loss: 0.1844099
	speed: 0.0378s/iter; left time: 5408.6378s
	iters: 600, epoch: 25 | loss: 0.1849551
	speed: 0.0334s/iter; left time: 4773.8934s
	iters: 700, epoch: 25 | loss: 0.1959036
	speed: 0.0359s/iter; left time: 5129.5004s
	iters: 800, epoch: 25 | loss: 0.1908160
	speed: 0.0295s/iter; left time: 4213.0862s
	iters: 900, epoch: 25 | loss: 0.1724406
	speed: 0.0297s/iter; left time: 4237.6815s
	iters: 1000, epoch: 25 | loss: 0.2196665
	speed: 0.0309s/iter; left time: 4405.3484s
	iters: 1100, epoch: 25 | loss: 0.2051401
	speed: 0.0298s/iter; left time: 4245.4040s
Epoch: 25 cost time: 44.54058885574341
Vali Metrics: mse:0.4301, mae:0.2820
Test Metrics: mse:0.1734494, mae:0.2090152
Epoch: 25, Steps: 1139 | Train Loss: 0.1854167 Vali Loss: 0.3560376 Test Loss: 0.1912323
Validation loss decreased (0.356461 --> 0.356038).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1885034
	speed: 0.6862s/iter; left time: 97633.0292s
	iters: 200, epoch: 26 | loss: 0.2155713
	speed: 0.0518s/iter; left time: 7361.4282s
	iters: 300, epoch: 26 | loss: 0.2010720
	speed: 0.0452s/iter; left time: 6415.3389s
	iters: 400, epoch: 26 | loss: 0.1839651
	speed: 0.0480s/iter; left time: 6820.2588s
	iters: 500, epoch: 26 | loss: 0.1958904
	speed: 0.0399s/iter; left time: 5656.9716s
	iters: 600, epoch: 26 | loss: 0.1908512
	speed: 0.0319s/iter; left time: 4516.7503s
	iters: 700, epoch: 26 | loss: 0.1788778
	speed: 0.0361s/iter; left time: 5111.7671s
	iters: 800, epoch: 26 | loss: 0.1955736
	speed: 0.0292s/iter; left time: 4129.9168s
	iters: 900, epoch: 26 | loss: 0.1823504
	speed: 0.0316s/iter; left time: 4474.2499s
	iters: 1000, epoch: 26 | loss: 0.1624435
	speed: 0.0323s/iter; left time: 4561.8277s
	iters: 1100, epoch: 26 | loss: 0.1837769
	speed: 0.0376s/iter; left time: 5307.0441s
Epoch: 26 cost time: 45.71391534805298
Vali Metrics: mse:0.4311, mae:0.2830
Test Metrics: mse:0.1742744, mae:0.2101066
Epoch: 26, Steps: 1139 | Train Loss: 0.1853773 Vali Loss: 0.3570283 Test Loss: 0.1921905
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.1760487
	speed: 0.6431s/iter; left time: 90769.4428s
	iters: 200, epoch: 27 | loss: 0.1855652
	speed: 0.0470s/iter; left time: 6632.1410s
	iters: 300, epoch: 27 | loss: 0.1887591
	speed: 0.0483s/iter; left time: 6811.2980s
	iters: 400, epoch: 27 | loss: 0.1911231
	speed: 0.0480s/iter; left time: 6755.6063s
	iters: 500, epoch: 27 | loss: 0.1644209
	speed: 0.0444s/iter; left time: 6250.3228s
	iters: 600, epoch: 27 | loss: 0.1669406
	speed: 0.0391s/iter; left time: 5500.8620s
	iters: 700, epoch: 27 | loss: 0.1822307
	speed: 0.0457s/iter; left time: 6429.4536s
	iters: 800, epoch: 27 | loss: 0.1748108
	speed: 0.0512s/iter; left time: 7193.5986s
	iters: 900, epoch: 27 | loss: 0.1717218
	speed: 0.0489s/iter; left time: 6859.8753s
	iters: 1000, epoch: 27 | loss: 0.1875990
	speed: 0.0356s/iter; left time: 4994.8391s
	iters: 1100, epoch: 27 | loss: 0.1821597
	speed: 0.0477s/iter; left time: 6683.7260s
Epoch: 27 cost time: 52.83433437347412
Vali Metrics: mse:0.4296, mae:0.2843
Test Metrics: mse:0.1734907, mae:0.2101177
Epoch: 27, Steps: 1139 | Train Loss: 0.1853419 Vali Loss: 0.3569630 Test Loss: 0.1918042
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.1767287
	speed: 0.6541s/iter; left time: 91577.0665s
	iters: 200, epoch: 28 | loss: 0.1948211
	speed: 0.0487s/iter; left time: 6819.3708s
	iters: 300, epoch: 28 | loss: 0.1867620
	speed: 0.0490s/iter; left time: 6846.5348s
	iters: 400, epoch: 28 | loss: 0.1666746
	speed: 0.0510s/iter; left time: 7127.9305s
	iters: 500, epoch: 28 | loss: 0.1866823
	speed: 0.0449s/iter; left time: 6271.7584s
	iters: 600, epoch: 28 | loss: 0.1936952
	speed: 0.0474s/iter; left time: 6613.6566s
	iters: 700, epoch: 28 | loss: 0.1982190
	speed: 0.0466s/iter; left time: 6495.3161s
	iters: 800, epoch: 28 | loss: 0.1839016
	speed: 0.0496s/iter; left time: 6915.6823s
	iters: 900, epoch: 28 | loss: 0.1965135
	speed: 0.0492s/iter; left time: 6848.0349s
	iters: 1000, epoch: 28 | loss: 0.1687735
	speed: 0.0440s/iter; left time: 6120.5463s
	iters: 1100, epoch: 28 | loss: 0.1953204
	speed: 0.0419s/iter; left time: 5830.5988s
Epoch: 28 cost time: 54.10513615608215
Vali Metrics: mse:0.4315, mae:0.2825
Test Metrics: mse:0.1736538, mae:0.2093318
Epoch: 28, Steps: 1139 | Train Loss: 0.1852449 Vali Loss: 0.3569952 Test Loss: 0.1914928
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.2042148
	speed: 0.6106s/iter; left time: 84792.7374s
	iters: 200, epoch: 29 | loss: 0.1882149
	speed: 0.0562s/iter; left time: 7798.6027s
	iters: 300, epoch: 29 | loss: 0.1842264
	speed: 0.0549s/iter; left time: 7618.2524s
	iters: 400, epoch: 29 | loss: 0.2004378
	speed: 0.0430s/iter; left time: 5953.4077s
	iters: 500, epoch: 29 | loss: 0.1636460
	speed: 0.0538s/iter; left time: 7447.5187s
	iters: 600, epoch: 29 | loss: 0.1844773
	speed: 0.0482s/iter; left time: 6669.4312s
	iters: 700, epoch: 29 | loss: 0.1744820
	speed: 0.0407s/iter; left time: 5628.3981s
	iters: 800, epoch: 29 | loss: 0.1917945
	speed: 0.0435s/iter; left time: 6015.6587s
	iters: 900, epoch: 29 | loss: 0.1828021
	speed: 0.0491s/iter; left time: 6778.5236s
	iters: 1000, epoch: 29 | loss: 0.1960680
	speed: 0.0441s/iter; left time: 6079.4671s
	iters: 1100, epoch: 29 | loss: 0.1856122
	speed: 0.0393s/iter; left time: 5415.0860s
Epoch: 29 cost time: 54.80069875717163
Vali Metrics: mse:0.4307, mae:0.2826
Test Metrics: mse:0.1734598, mae:0.2092589
Epoch: 29, Steps: 1139 | Train Loss: 0.1852222 Vali Loss: 0.3566693 Test Loss: 0.1913593
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.2031457
	speed: 0.6000s/iter; left time: 82636.0804s
	iters: 200, epoch: 30 | loss: 0.1992350
	speed: 0.0544s/iter; left time: 7487.8087s
	iters: 300, epoch: 30 | loss: 0.1850663
	speed: 0.0465s/iter; left time: 6395.2493s
	iters: 400, epoch: 30 | loss: 0.1987359
	speed: 0.0458s/iter; left time: 6299.9083s
	iters: 500, epoch: 30 | loss: 0.1812210
	speed: 0.0507s/iter; left time: 6959.3771s
	iters: 600, epoch: 30 | loss: 0.1888880
	speed: 0.0600s/iter; left time: 8239.0139s
	iters: 700, epoch: 30 | loss: 0.1835274
	speed: 0.0507s/iter; left time: 6955.2887s
	iters: 800, epoch: 30 | loss: 0.1788562
	speed: 0.0477s/iter; left time: 6534.0429s
	iters: 900, epoch: 30 | loss: 0.1867431
	speed: 0.0490s/iter; left time: 6708.5578s
	iters: 1000, epoch: 30 | loss: 0.1785263
	speed: 0.0422s/iter; left time: 5770.4758s
	iters: 1100, epoch: 30 | loss: 0.1771766
	speed: 0.0423s/iter; left time: 5784.5514s
Epoch: 30 cost time: 56.28482460975647
Vali Metrics: mse:0.4303, mae:0.2827
Test Metrics: mse:0.1738197, mae:0.2095858
Epoch: 30, Steps: 1139 | Train Loss: 0.1851693 Vali Loss: 0.3564827 Test Loss: 0.1917028
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.2001780
	speed: 0.6290s/iter; left time: 85915.2917s
	iters: 200, epoch: 31 | loss: 0.1871223
	speed: 0.0447s/iter; left time: 6096.2542s
	iters: 300, epoch: 31 | loss: 0.1822409
	speed: 0.0489s/iter; left time: 6675.8428s
	iters: 400, epoch: 31 | loss: 0.2017503
	speed: 0.0427s/iter; left time: 5820.3928s
	iters: 500, epoch: 31 | loss: 0.1914575
	speed: 0.0409s/iter; left time: 5566.5764s
	iters: 600, epoch: 31 | loss: 0.1724632
	speed: 0.0396s/iter; left time: 5390.8799s
	iters: 700, epoch: 31 | loss: 0.1788251
	speed: 0.0430s/iter; left time: 5846.6957s
	iters: 800, epoch: 31 | loss: 0.1981221
	speed: 0.0444s/iter; left time: 6034.1373s
	iters: 900, epoch: 31 | loss: 0.1941940
	speed: 0.0372s/iter; left time: 5050.1267s
	iters: 1000, epoch: 31 | loss: 0.1806749
	speed: 0.0456s/iter; left time: 6185.8129s
	iters: 1100, epoch: 31 | loss: 0.1785678
	speed: 0.0482s/iter; left time: 6533.3400s
Epoch: 31 cost time: 50.64828586578369
Vali Metrics: mse:0.4322, mae:0.2855
Test Metrics: mse:0.1748168, mae:0.2110745
Epoch: 31, Steps: 1139 | Train Loss: 0.1851224 Vali Loss: 0.3588345 Test Loss: 0.1929457
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.2104395
	speed: 0.6556s/iter; left time: 88792.7419s
	iters: 200, epoch: 32 | loss: 0.1792783
	speed: 0.0327s/iter; left time: 4430.6972s
	iters: 300, epoch: 32 | loss: 0.1727483
	speed: 0.0465s/iter; left time: 6292.5986s
	iters: 400, epoch: 32 | loss: 0.1834120
	speed: 0.0445s/iter; left time: 6012.0083s
	iters: 500, epoch: 32 | loss: 0.1747016
	speed: 0.0443s/iter; left time: 5980.2995s
	iters: 600, epoch: 32 | loss: 0.1849782
	speed: 0.0419s/iter; left time: 5647.3831s
	iters: 700, epoch: 32 | loss: 0.1757247
	speed: 0.0466s/iter; left time: 6286.0871s
	iters: 800, epoch: 32 | loss: 0.1765156
	speed: 0.0405s/iter; left time: 5451.3565s
	iters: 900, epoch: 32 | loss: 0.1740740
	speed: 0.0436s/iter; left time: 5865.8757s
	iters: 1000, epoch: 32 | loss: 0.1858420
	speed: 0.0425s/iter; left time: 5722.3722s
	iters: 1100, epoch: 32 | loss: 0.2024998
	speed: 0.0444s/iter; left time: 5966.9225s
Epoch: 32 cost time: 49.81527757644653
Vali Metrics: mse:0.4307, mae:0.2841
Test Metrics: mse:0.1737159, mae:0.2101579
Epoch: 32, Steps: 1139 | Train Loss: 0.1850811 Vali Loss: 0.3573756 Test Loss: 0.1919369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2095529
	speed: 0.6775s/iter; left time: 90992.9370s
	iters: 200, epoch: 33 | loss: 0.1776781
	speed: 0.0534s/iter; left time: 7161.6636s
	iters: 300, epoch: 33 | loss: 0.1736628
	speed: 0.0441s/iter; left time: 5920.3270s
	iters: 400, epoch: 33 | loss: 0.1657011
	speed: 0.0431s/iter; left time: 5778.5592s
	iters: 500, epoch: 33 | loss: 0.2104983
	speed: 0.0375s/iter; left time: 5024.5477s
	iters: 600, epoch: 33 | loss: 0.1906213
	speed: 0.0397s/iter; left time: 5312.9036s
	iters: 700, epoch: 33 | loss: 0.1849441
	speed: 0.0395s/iter; left time: 5279.6894s
	iters: 800, epoch: 33 | loss: 0.1882490
	speed: 0.0398s/iter; left time: 5322.0730s
	iters: 900, epoch: 33 | loss: 0.1814793
	speed: 0.0264s/iter; left time: 3522.3951s
	iters: 1000, epoch: 33 | loss: 0.1839168
	speed: 0.0314s/iter; left time: 4183.4121s
	iters: 1100, epoch: 33 | loss: 0.1885164
	speed: 0.0331s/iter; left time: 4418.8464s
Epoch: 33 cost time: 46.23980689048767
Vali Metrics: mse:0.4293, mae:0.2830
Test Metrics: mse:0.1738302, mae:0.2096700
Epoch: 33, Steps: 1139 | Train Loss: 0.1850407 Vali Loss: 0.3561760 Test Loss: 0.1917501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.2078476
	speed: 0.6259s/iter; left time: 83346.9363s
	iters: 200, epoch: 34 | loss: 0.1835803
	speed: 0.0462s/iter; left time: 6150.3576s
	iters: 300, epoch: 34 | loss: 0.1673656
	speed: 0.0470s/iter; left time: 6245.0747s
	iters: 400, epoch: 34 | loss: 0.1985308
	speed: 0.0500s/iter; left time: 6648.4401s
	iters: 500, epoch: 34 | loss: 0.2063125
	speed: 0.0502s/iter; left time: 6667.2278s
	iters: 600, epoch: 34 | loss: 0.1768742
	speed: 0.0440s/iter; left time: 5831.2391s
	iters: 700, epoch: 34 | loss: 0.1754233
	speed: 0.0386s/iter; left time: 5111.3760s
	iters: 800, epoch: 34 | loss: 0.1717515
	speed: 0.0422s/iter; left time: 5585.3670s
	iters: 900, epoch: 34 | loss: 0.1953107
	speed: 0.0482s/iter; left time: 6377.7262s
	iters: 1000, epoch: 34 | loss: 0.1902974
	speed: 0.0489s/iter; left time: 6471.4273s
	iters: 1100, epoch: 34 | loss: 0.1763594
	speed: 0.0461s/iter; left time: 6096.0377s
Epoch: 34 cost time: 53.56223797798157
Vali Metrics: mse:0.4298, mae:0.2825
Test Metrics: mse:0.1737723, mae:0.2096291
Epoch: 34, Steps: 1139 | Train Loss: 0.1850352 Vali Loss: 0.3561251 Test Loss: 0.1917007
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.1927453
	speed: 0.6565s/iter; left time: 86669.2038s
	iters: 200, epoch: 35 | loss: 0.1831983
	speed: 0.0419s/iter; left time: 5531.9683s
	iters: 300, epoch: 35 | loss: 0.1800804
	speed: 0.0420s/iter; left time: 5538.8152s
	iters: 400, epoch: 35 | loss: 0.1856304
	speed: 0.0413s/iter; left time: 5436.1951s
	iters: 500, epoch: 35 | loss: 0.1753027
	speed: 0.0408s/iter; left time: 5366.0113s
	iters: 600, epoch: 35 | loss: 0.1765232
	speed: 0.0420s/iter; left time: 5523.6023s
	iters: 700, epoch: 35 | loss: 0.1720804
	speed: 0.0430s/iter; left time: 5644.7753s
	iters: 800, epoch: 35 | loss: 0.1706322
	speed: 0.0363s/iter; left time: 4772.3625s
	iters: 900, epoch: 35 | loss: 0.1685207
	speed: 0.0349s/iter; left time: 4574.4444s
	iters: 1000, epoch: 35 | loss: 0.1957508
	speed: 0.0385s/iter; left time: 5047.4558s
	iters: 1100, epoch: 35 | loss: 0.1859199
	speed: 0.0378s/iter; left time: 4957.9718s
Epoch: 35 cost time: 45.493799924850464
Vali Metrics: mse:0.4298, mae:0.2858
Test Metrics: mse:0.1738398, mae:0.2107514
Epoch: 35, Steps: 1139 | Train Loss: 0.1848529 Vali Loss: 0.3577676 Test Loss: 0.1922956
EarlyStopping counter: 10 out of 10
Early stopping
loading model, best model path: ./checkpoints/long_term_forecast_weather_rerun_2021_DeepEDM_custom_ftM_sl288_ll48_pl144_emdtimeF_test_0/checkpoint.pth
>>>>>>>testing : long_term_forecast_weather_rerun_2021_DeepEDM_custom_ftM_sl288_ll48_pl144_emdtimeF_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10396
test shape: (10396, 144, 21) (10396, 144, 21)
mse:0.17349861562252045, mae:0.20904985070228577, dtw:not calculated
