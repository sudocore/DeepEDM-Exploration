Setting seed to 2021
{'activation_fn': 'selu',
 'add_pe': True,
 'augmentation_ratio': 0,
 'batch_size': 32,
 'checkpoints': './checkpoints',
 'clip_grad_norm': 1.0,
 'condor_job': True,
 'data': 'custom',
 'data_path': 'weather.csv',
 'delay': 9,
 'des': 'test',
 'devices': '0,1',
 'dist_projection_dim': -1,
 'edm_dropout': 0.1,
 'embed': 'timeF',
 'features': 'M',
 'freq': 'h',
 'gpu': 0,
 'inverse': False,
 'is_training': 1,
 'itr': 1,
 'label_len': 48,
 'latent_channel_dim': -1,
 'learning_rate': 0.0005,
 'loss': 'mae_tdt',
 'loss_type': 'mae',
 'lradj': 'custom',
 'min_lr': 5e-05,
 'mlp_dropout': 0.1,
 'model': 'DeepEDM',
 'model_config': {'edm_params': {'activation_fn': 'selu',
                                 'add_pe': True,
                                 'delay': 9,
                                 'dist_projection_dim': 64,
                                 'dropout': 0.1,
                                 'layer_norm': True,
                                 'method': 'simplex',
                                 'n_proj_layers': 1,
                                 'theta': 1.0,
                                 'time_delay_stride': 3},
                  'encoder_params': {'activation_fn': 'selu',
                                     'add_pe': True,
                                     'dropout': 0.1,
                                     'in_channels': 21,
                                     'latent_channel_dim': 21,
                                     'mlp_layers': 2,
                                     'use_encoder': False},
                  'lookback_len': 512,
                  'n_edm_blocks': 1,
                  'out_pred_len': 192,
                  'type': 'EDM'},
 'model_id': 'weather_rerun_lkbck_search_2021__2021',
 'n_edm_blocks': 1,
 'n_mlp_layers': 2,
 'n_proj_layers': -1,
 'num_workers': 4,
 'opt': {'clip_grad_norm': 1.0,
         'early_stopping_patience': 30,
         'epochs': 100,
         'learning_rate': 0.0005,
         'min_lr': 5e-05,
         'reduce_lr_factor': 0.9,
         'schedule_type': 'custom',
         'type': 'AdamW',
         'weight_decay': 1e-05},
 'output_dir': '.',
 'patience': 10,
 'pred_len': 192,
 'reduce_lr_factor': 0.9,
 'root_path': './dataset/weather',
 'seasonal_patterns': 'Monthly',
 'seed': 2021,
 'seq_len': 512,
 'target': 'OT',
 'task_name': 'long_term_forecast',
 'tdt_loss': True,
 'theta': -1,
 'time_delay_stride': 3,
 'train_epochs': 150,
 'use_amp': False,
 'use_dtw': False,
 'use_gpu': True,
 'use_multi_gpu': True}
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_rerun_lkbck_search_2021__2021Model:              DeepEDM             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather   
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m

[1mRun Parameters[0m
  Num Workers:        4                   Itr:                1                   
  Train Epochs:       150                 Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.0005              
  Des:                test                Loss:               mae_tdt             
  Lradj:              custom              Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

{'clip_grad_norm': 1.0,
 'early_stopping_patience': 30,
 'epochs': 100,
 'learning_rate': 0.0005,
 'min_lr': 5e-05,
 'reduce_lr_factor': 0.9,
 'schedule_type': 'custom',
 'type': 'AdamW',
 'weight_decay': 1e-05}

{'edm_params': {'activation_fn': 'selu',
                'add_pe': True,
                'delay': 9,
                'dist_projection_dim': 64,
                'dropout': 0.1,
                'layer_norm': True,
                'method': 'simplex',
                'n_proj_layers': 1,
                'theta': 1.0,
                'time_delay_stride': 3},
 'encoder_params': {'activation_fn': 'selu',
                    'add_pe': True,
                    'dropout': 0.1,
                    'in_channels': 21,
                    'latent_channel_dim': 21,
                    'mlp_layers': 2,
                    'use_encoder': False},
 'lookback_len': 512,
 'n_edm_blocks': 1,
 'out_pred_len': 192,
 'type': 'EDM'}

model: Model(
  (encoder): InputEncoder(
    (mlp_projection): Sequential(
      (0): Linear(in_features=512, out_features=192, bias=True)
      (1): Dropout(p=0.1, inplace=False)
      (2): SELU()
      (3): Linear(in_features=192, out_features=192, bias=True)
    )
  )
  (edm_blocks): ModuleList(
    (0): EDM(
      (activation_fn): SELU()
      (projection): Sequential(
        (0): Linear(in_features=9, out_features=64, bias=True)
      )
      (pe): LearnablePositionalEmbedding()
      (ln1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (attn_dropout): Dropout(p=0.1, inplace=False)
      (undelay): Sequential(
        (0): Linear(in_features=558, out_features=192, bias=True)
        (1): Dropout(p=0.1, inplace=False)
        (2): SELU()
        (3): Linear(in_features=192, out_features=192, bias=True)
      )
    )
  )
  (gate_edm): Linear(in_features=192, out_features=1, bias=True)
)
>>>>>>>start training : long_term_forecast_weather_rerun_lkbck_search_2021__2021_DeepEDM_custom_ftM_sl512_ll48_pl192_emdtimeF_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36184
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.2473331
	speed: 0.0168s/iter; left time: 2853.8421s
	iters: 200, epoch: 1 | loss: 0.2530307
	speed: 0.0080s/iter; left time: 1362.1753s
	iters: 300, epoch: 1 | loss: 0.2352383
	speed: 0.0082s/iter; left time: 1395.7647s
	iters: 400, epoch: 1 | loss: 0.2267824
	speed: 0.0081s/iter; left time: 1363.5907s
	iters: 500, epoch: 1 | loss: 0.2333398
	speed: 0.0077s/iter; left time: 1307.3496s
	iters: 600, epoch: 1 | loss: 0.2116688
	speed: 0.0077s/iter; left time: 1301.3914s
	iters: 700, epoch: 1 | loss: 0.2207476
	speed: 0.0078s/iter; left time: 1318.7498s
	iters: 800, epoch: 1 | loss: 0.2215105
	speed: 0.0078s/iter; left time: 1308.8986s
	iters: 900, epoch: 1 | loss: 0.2060849
	speed: 0.0077s/iter; left time: 1296.9450s
	iters: 1000, epoch: 1 | loss: 0.2108402
	speed: 0.0075s/iter; left time: 1268.9612s
	iters: 1100, epoch: 1 | loss: 0.1963229
	speed: 0.0076s/iter; left time: 1281.5680s
Epoch: 1 cost time: 9.532824754714966
Vali Metrics: mse:0.4752, mae:0.3228
Test Metrics: mse:0.1962091, mae:0.2375315
Epoch: 1, Steps: 1130 | Train Loss: 0.2289334 Vali Loss: 0.3989944 Test Loss: 0.2168703
Validation loss decreased (inf --> 0.398994).  Saving model ...
Reducing learning rate to 0.000450
	iters: 100, epoch: 2 | loss: 0.2215628
	speed: 0.0616s/iter; left time: 10373.0008s
	iters: 200, epoch: 2 | loss: 0.2071771
	speed: 0.0075s/iter; left time: 1257.1419s
	iters: 300, epoch: 2 | loss: 0.1963229
	speed: 0.0075s/iter; left time: 1253.9580s
	iters: 400, epoch: 2 | loss: 0.1950897
	speed: 0.0077s/iter; left time: 1288.5193s
	iters: 500, epoch: 2 | loss: 0.2066868
	speed: 0.0077s/iter; left time: 1289.5825s
	iters: 600, epoch: 2 | loss: 0.2258533
	speed: 0.0076s/iter; left time: 1276.3512s
	iters: 700, epoch: 2 | loss: 0.1858773
	speed: 0.0080s/iter; left time: 1338.8322s
	iters: 800, epoch: 2 | loss: 0.2030455
	speed: 0.0081s/iter; left time: 1351.4465s
	iters: 900, epoch: 2 | loss: 0.2062779
	speed: 0.0075s/iter; left time: 1250.8434s
	iters: 1000, epoch: 2 | loss: 0.1952659
	speed: 0.0077s/iter; left time: 1290.8676s
	iters: 1100, epoch: 2 | loss: 0.2070145
	speed: 0.0074s/iter; left time: 1240.1253s
Epoch: 2 cost time: 8.852959156036377
Vali Metrics: mse:0.4685, mae:0.3187
Test Metrics: mse:0.1930867, mae:0.2335977
Epoch: 2, Steps: 1130 | Train Loss: 0.2044330 Vali Loss: 0.3935695 Test Loss: 0.2133422
Validation loss decreased (0.398994 --> 0.393570).  Saving model ...
Reducing learning rate to 0.000405
	iters: 100, epoch: 3 | loss: 0.1897232
	speed: 0.0902s/iter; left time: 15067.9227s
	iters: 200, epoch: 3 | loss: 0.1901314
	speed: 0.0079s/iter; left time: 1320.7206s
	iters: 300, epoch: 3 | loss: 0.2040558
	speed: 0.0073s/iter; left time: 1211.3486s
	iters: 400, epoch: 3 | loss: 0.2376871
	speed: 0.0073s/iter; left time: 1220.5086s
	iters: 500, epoch: 3 | loss: 0.1871840
	speed: 0.0075s/iter; left time: 1249.6893s
	iters: 600, epoch: 3 | loss: 0.2014086
	speed: 0.0074s/iter; left time: 1234.2185s
	iters: 700, epoch: 3 | loss: 0.1938560
	speed: 0.0074s/iter; left time: 1227.6418s
	iters: 800, epoch: 3 | loss: 0.2051520
	speed: 0.0074s/iter; left time: 1224.3729s
	iters: 900, epoch: 3 | loss: 0.2046095
	speed: 0.0075s/iter; left time: 1252.9384s
	iters: 1000, epoch: 3 | loss: 0.1913150
	speed: 0.0075s/iter; left time: 1251.3314s
	iters: 1100, epoch: 3 | loss: 0.2006149
	speed: 0.0075s/iter; left time: 1243.2883s
Epoch: 3 cost time: 8.684580564498901
Vali Metrics: mse:0.4609, mae:0.3106
Test Metrics: mse:0.1897483, mae:0.2286845
Epoch: 3, Steps: 1130 | Train Loss: 0.1998406 Vali Loss: 0.3857417 Test Loss: 0.2092164
Validation loss decreased (0.393570 --> 0.385742).  Saving model ...
Reducing learning rate to 0.000365
	iters: 100, epoch: 4 | loss: 0.1965025
	speed: 0.0953s/iter; left time: 15823.4918s
	iters: 200, epoch: 4 | loss: 0.1966501
	speed: 0.0091s/iter; left time: 1509.1419s
	iters: 300, epoch: 4 | loss: 0.2044183
	speed: 0.0087s/iter; left time: 1445.9087s
	iters: 400, epoch: 4 | loss: 0.1810179
	speed: 0.0081s/iter; left time: 1342.0559s
	iters: 500, epoch: 4 | loss: 0.2012922
	speed: 0.0083s/iter; left time: 1367.0359s
	iters: 600, epoch: 4 | loss: 0.1999148
	speed: 0.0087s/iter; left time: 1436.0172s
	iters: 700, epoch: 4 | loss: 0.1819186
	speed: 0.0087s/iter; left time: 1441.5735s
	iters: 800, epoch: 4 | loss: 0.2085885
	speed: 0.0086s/iter; left time: 1417.8423s
	iters: 900, epoch: 4 | loss: 0.2072509
	speed: 0.0083s/iter; left time: 1378.4370s
	iters: 1000, epoch: 4 | loss: 0.2032775
	speed: 0.0084s/iter; left time: 1390.0437s
	iters: 1100, epoch: 4 | loss: 0.2011385
	speed: 0.0082s/iter; left time: 1350.9688s
Epoch: 4 cost time: 9.789167881011963
Vali Metrics: mse:0.4599, mae:0.3083
Test Metrics: mse:0.1899572, mae:0.2284361
Epoch: 4, Steps: 1130 | Train Loss: 0.1975872 Vali Loss: 0.3841033 Test Loss: 0.2091966
Validation loss decreased (0.385742 --> 0.384103).  Saving model ...
Reducing learning rate to 0.000328
	iters: 100, epoch: 5 | loss: 0.2089105
	speed: 0.0975s/iter; left time: 16071.8540s
	iters: 200, epoch: 5 | loss: 0.1746927
	speed: 0.0090s/iter; left time: 1482.2811s
	iters: 300, epoch: 5 | loss: 0.1976826
	speed: 0.0088s/iter; left time: 1444.8576s
	iters: 400, epoch: 5 | loss: 0.1943500
	speed: 0.0087s/iter; left time: 1437.8506s
	iters: 500, epoch: 5 | loss: 0.1853441
	speed: 0.0081s/iter; left time: 1330.7533s
	iters: 600, epoch: 5 | loss: 0.1878445
	speed: 0.0085s/iter; left time: 1392.7372s
	iters: 700, epoch: 5 | loss: 0.2228985
	speed: 0.0081s/iter; left time: 1327.1541s
	iters: 800, epoch: 5 | loss: 0.1983811
	speed: 0.0086s/iter; left time: 1415.3385s
	iters: 900, epoch: 5 | loss: 0.1885659
	speed: 0.0085s/iter; left time: 1393.8304s
	iters: 1000, epoch: 5 | loss: 0.1875824
	speed: 0.0084s/iter; left time: 1377.2940s
	iters: 1100, epoch: 5 | loss: 0.1889088
	speed: 0.0084s/iter; left time: 1373.4467s
Epoch: 5 cost time: 9.899442434310913
Vali Metrics: mse:0.4572, mae:0.3077
Test Metrics: mse:0.1900112, mae:0.2279735
Epoch: 5, Steps: 1130 | Train Loss: 0.1962729 Vali Loss: 0.3824325 Test Loss: 0.2089923
Validation loss decreased (0.384103 --> 0.382432).  Saving model ...
Reducing learning rate to 0.000295
	iters: 100, epoch: 6 | loss: 0.1853870
	speed: 0.1017s/iter; left time: 16648.1539s
	iters: 200, epoch: 6 | loss: 0.2046180
	speed: 0.0085s/iter; left time: 1395.2999s
	iters: 300, epoch: 6 | loss: 0.1902632
	speed: 0.0081s/iter; left time: 1318.2714s
	iters: 400, epoch: 6 | loss: 0.1948417
	speed: 0.0087s/iter; left time: 1422.2803s
	iters: 500, epoch: 6 | loss: 0.2012508
	speed: 0.0085s/iter; left time: 1382.0884s
	iters: 600, epoch: 6 | loss: 0.1980156
	speed: 0.0086s/iter; left time: 1399.7965s
	iters: 700, epoch: 6 | loss: 0.2066994
	speed: 0.0081s/iter; left time: 1314.7839s
	iters: 800, epoch: 6 | loss: 0.1949449
	speed: 0.0080s/iter; left time: 1296.3757s
	iters: 900, epoch: 6 | loss: 0.2037485
	speed: 0.0079s/iter; left time: 1291.6905s
	iters: 1000, epoch: 6 | loss: 0.1883177
	speed: 0.0082s/iter; left time: 1329.2571s
	iters: 1100, epoch: 6 | loss: 0.1931884
	speed: 0.0075s/iter; left time: 1225.1639s
Epoch: 6 cost time: 9.53396487236023
Vali Metrics: mse:0.4574, mae:0.3071
Test Metrics: mse:0.1905946, mae:0.2285291
Epoch: 6, Steps: 1130 | Train Loss: 0.1950216 Vali Loss: 0.3822424 Test Loss: 0.2095619
Validation loss decreased (0.382432 --> 0.382242).  Saving model ...
Reducing learning rate to 0.000266
	iters: 100, epoch: 7 | loss: 0.2131690
	speed: 0.0933s/iter; left time: 15166.4473s
	iters: 200, epoch: 7 | loss: 0.1904029
	speed: 0.0083s/iter; left time: 1347.8555s
	iters: 300, epoch: 7 | loss: 0.1812263
	speed: 0.0080s/iter; left time: 1299.5546s
	iters: 400, epoch: 7 | loss: 0.1935920
	speed: 0.0084s/iter; left time: 1361.6162s
	iters: 500, epoch: 7 | loss: 0.1859460
	speed: 0.0082s/iter; left time: 1334.2283s
	iters: 600, epoch: 7 | loss: 0.1936449
	speed: 0.0073s/iter; left time: 1183.6700s
	iters: 700, epoch: 7 | loss: 0.1944397
	speed: 0.0076s/iter; left time: 1229.9319s
	iters: 800, epoch: 7 | loss: 0.1943388
	speed: 0.0074s/iter; left time: 1193.3736s
	iters: 900, epoch: 7 | loss: 0.1969651
	speed: 0.0073s/iter; left time: 1183.8119s
	iters: 1000, epoch: 7 | loss: 0.1795775
	speed: 0.0073s/iter; left time: 1172.6001s
	iters: 1100, epoch: 7 | loss: 0.1934425
	speed: 0.0073s/iter; left time: 1182.5253s
Epoch: 7 cost time: 8.92050313949585
Vali Metrics: mse:0.4588, mae:0.3075
Test Metrics: mse:0.1894413, mae:0.2275792
Epoch: 7, Steps: 1130 | Train Loss: 0.1941094 Vali Loss: 0.3831499 Test Loss: 0.2085103
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000239
	iters: 100, epoch: 8 | loss: 0.1884849
	speed: 0.0892s/iter; left time: 14403.1069s
	iters: 200, epoch: 8 | loss: 0.1916685
	speed: 0.0073s/iter; left time: 1181.2988s
	iters: 300, epoch: 8 | loss: 0.1793350
	speed: 0.0073s/iter; left time: 1177.6439s
	iters: 400, epoch: 8 | loss: 0.1914538
	speed: 0.0074s/iter; left time: 1196.6296s
	iters: 500, epoch: 8 | loss: 0.1753519
	speed: 0.0080s/iter; left time: 1281.3734s
	iters: 600, epoch: 8 | loss: 0.1975579
	speed: 0.0078s/iter; left time: 1253.9749s
	iters: 700, epoch: 8 | loss: 0.1948860
	speed: 0.0076s/iter; left time: 1221.9001s
	iters: 800, epoch: 8 | loss: 0.1880032
	speed: 0.0073s/iter; left time: 1171.4178s
	iters: 900, epoch: 8 | loss: 0.1903267
	speed: 0.0073s/iter; left time: 1172.9593s
	iters: 1000, epoch: 8 | loss: 0.2034359
	speed: 0.0074s/iter; left time: 1180.9371s
	iters: 1100, epoch: 8 | loss: 0.1981987
	speed: 0.0076s/iter; left time: 1212.8184s
Epoch: 8 cost time: 8.712726354598999
Vali Metrics: mse:0.4557, mae:0.3032
Test Metrics: mse:0.1887857, mae:0.2262631
Epoch: 8, Steps: 1130 | Train Loss: 0.1933762 Vali Loss: 0.3794099 Test Loss: 0.2075244
Validation loss decreased (0.382242 --> 0.379410).  Saving model ...
Reducing learning rate to 0.000215
	iters: 100, epoch: 9 | loss: 0.1904769
	speed: 0.0913s/iter; left time: 14634.7688s
	iters: 200, epoch: 9 | loss: 0.2059245
	speed: 0.0074s/iter; left time: 1185.2769s
	iters: 300, epoch: 9 | loss: 0.1800838
	speed: 0.0073s/iter; left time: 1175.2460s
	iters: 400, epoch: 9 | loss: 0.1942093
	speed: 0.0075s/iter; left time: 1204.2664s
	iters: 500, epoch: 9 | loss: 0.1968674
	speed: 0.0074s/iter; left time: 1189.2585s
	iters: 600, epoch: 9 | loss: 0.1968960
	speed: 0.0074s/iter; left time: 1188.5162s
	iters: 700, epoch: 9 | loss: 0.1839478
	speed: 0.0075s/iter; left time: 1198.6589s
	iters: 800, epoch: 9 | loss: 0.1753524
	speed: 0.0073s/iter; left time: 1172.7103s
	iters: 900, epoch: 9 | loss: 0.1823464
	speed: 0.0074s/iter; left time: 1185.1069s
	iters: 1000, epoch: 9 | loss: 0.2030026
	speed: 0.0075s/iter; left time: 1200.8296s
	iters: 1100, epoch: 9 | loss: 0.2050677
	speed: 0.0073s/iter; left time: 1161.6601s
Epoch: 9 cost time: 8.713493347167969
Vali Metrics: mse:0.4557, mae:0.3074
Test Metrics: mse:0.1907705, mae:0.2285380
Epoch: 9, Steps: 1130 | Train Loss: 0.1927195 Vali Loss: 0.3815720 Test Loss: 0.2096542
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000194
	iters: 100, epoch: 10 | loss: 0.1777465
	speed: 0.0902s/iter; left time: 14358.1158s
	iters: 200, epoch: 10 | loss: 0.2042720
	speed: 0.0080s/iter; left time: 1270.9609s
	iters: 300, epoch: 10 | loss: 0.1997140
	speed: 0.0076s/iter; left time: 1212.3805s
	iters: 400, epoch: 10 | loss: 0.2078546
	speed: 0.0079s/iter; left time: 1252.4329s
	iters: 500, epoch: 10 | loss: 0.1951440
	speed: 0.0074s/iter; left time: 1179.7558s
	iters: 600, epoch: 10 | loss: 0.1843728
	speed: 0.0077s/iter; left time: 1226.4570s
	iters: 700, epoch: 10 | loss: 0.1721740
	speed: 0.0075s/iter; left time: 1185.0704s
	iters: 800, epoch: 10 | loss: 0.1758353
	speed: 0.0075s/iter; left time: 1183.1799s
	iters: 900, epoch: 10 | loss: 0.1953245
	speed: 0.0077s/iter; left time: 1213.2246s
	iters: 1000, epoch: 10 | loss: 0.1948031
	speed: 0.0073s/iter; left time: 1162.5496s
	iters: 1100, epoch: 10 | loss: 0.1917012
	speed: 0.0076s/iter; left time: 1200.0197s
Epoch: 10 cost time: 8.913708209991455
Vali Metrics: mse:0.4542, mae:0.3027
Test Metrics: mse:0.1893899, mae:0.2264129
Epoch: 10, Steps: 1130 | Train Loss: 0.1920859 Vali Loss: 0.3784316 Test Loss: 0.2079014
Validation loss decreased (0.379410 --> 0.378432).  Saving model ...
Reducing learning rate to 0.000174
	iters: 100, epoch: 11 | loss: 0.1988156
	speed: 0.0923s/iter; left time: 14591.6315s
	iters: 200, epoch: 11 | loss: 0.1889540
	speed: 0.0078s/iter; left time: 1235.8309s
	iters: 300, epoch: 11 | loss: 0.1993593
	speed: 0.0081s/iter; left time: 1273.8999s
	iters: 400, epoch: 11 | loss: 0.1932151
	speed: 0.0081s/iter; left time: 1283.5609s
	iters: 500, epoch: 11 | loss: 0.1931866
	speed: 0.0080s/iter; left time: 1256.1245s
	iters: 600, epoch: 11 | loss: 0.1971574
	speed: 0.0077s/iter; left time: 1206.0187s
	iters: 700, epoch: 11 | loss: 0.1945792
	speed: 0.0076s/iter; left time: 1200.3098s
	iters: 800, epoch: 11 | loss: 0.1998263
	speed: 0.0076s/iter; left time: 1196.9096s
	iters: 900, epoch: 11 | loss: 0.2065029
	speed: 0.0081s/iter; left time: 1273.7292s
	iters: 1000, epoch: 11 | loss: 0.1833704
	speed: 0.0079s/iter; left time: 1234.1910s
	iters: 1100, epoch: 11 | loss: 0.1864945
	speed: 0.0075s/iter; left time: 1180.7757s
Epoch: 11 cost time: 9.055314302444458
Vali Metrics: mse:0.4547, mae:0.3040
Test Metrics: mse:0.1890073, mae:0.2265908
Epoch: 11, Steps: 1130 | Train Loss: 0.1915726 Vali Loss: 0.3793487 Test Loss: 0.2077990
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000157
	iters: 100, epoch: 12 | loss: 0.1827355
	speed: 0.0915s/iter; left time: 14359.8478s
	iters: 200, epoch: 12 | loss: 0.1998424
	speed: 0.0075s/iter; left time: 1184.1477s
	iters: 300, epoch: 12 | loss: 0.2079145
	speed: 0.0076s/iter; left time: 1194.2068s
	iters: 400, epoch: 12 | loss: 0.2018867
	speed: 0.0078s/iter; left time: 1221.9202s
	iters: 500, epoch: 12 | loss: 0.2036191
	speed: 0.0075s/iter; left time: 1171.1188s
	iters: 600, epoch: 12 | loss: 0.1807333
	speed: 0.0076s/iter; left time: 1183.0756s
	iters: 700, epoch: 12 | loss: 0.1892475
	speed: 0.0075s/iter; left time: 1169.1080s
	iters: 800, epoch: 12 | loss: 0.2070411
	speed: 0.0074s/iter; left time: 1151.7146s
	iters: 900, epoch: 12 | loss: 0.1817099
	speed: 0.0077s/iter; left time: 1204.1397s
	iters: 1000, epoch: 12 | loss: 0.1911999
	speed: 0.0077s/iter; left time: 1201.3753s
	iters: 1100, epoch: 12 | loss: 0.1940051
	speed: 0.0080s/iter; left time: 1252.4969s
Epoch: 12 cost time: 8.886728286743164
Vali Metrics: mse:0.4536, mae:0.3031
Test Metrics: mse:0.1896054, mae:0.2260889
Epoch: 12, Steps: 1130 | Train Loss: 0.1910727 Vali Loss: 0.3783394 Test Loss: 0.2078471
Validation loss decreased (0.378432 --> 0.378339).  Saving model ...
Reducing learning rate to 0.000141
	iters: 100, epoch: 13 | loss: 0.1911679
	speed: 0.0893s/iter; left time: 13909.1915s
	iters: 200, epoch: 13 | loss: 0.1692804
	speed: 0.0077s/iter; left time: 1199.5324s
	iters: 300, epoch: 13 | loss: 0.1970163
	speed: 0.0079s/iter; left time: 1226.6360s
	iters: 400, epoch: 13 | loss: 0.1961890
	speed: 0.0077s/iter; left time: 1199.5725s
	iters: 500, epoch: 13 | loss: 0.1981864
	speed: 0.0076s/iter; left time: 1182.8051s
	iters: 600, epoch: 13 | loss: 0.2066925
	speed: 0.0078s/iter; left time: 1209.6887s
	iters: 700, epoch: 13 | loss: 0.1868543
	speed: 0.0079s/iter; left time: 1230.8031s
	iters: 800, epoch: 13 | loss: 0.1809968
	speed: 0.0078s/iter; left time: 1205.3142s
	iters: 900, epoch: 13 | loss: 0.1902358
	speed: 0.0075s/iter; left time: 1169.5669s
	iters: 1000, epoch: 13 | loss: 0.1738277
	speed: 0.0075s/iter; left time: 1168.0626s
	iters: 1100, epoch: 13 | loss: 0.1845126
	speed: 0.0076s/iter; left time: 1172.2316s
Epoch: 13 cost time: 8.958656549453735
Vali Metrics: mse:0.4513, mae:0.3022
Test Metrics: mse:0.1895392, mae:0.2262630
Epoch: 13, Steps: 1130 | Train Loss: 0.1906679 Vali Loss: 0.3767710 Test Loss: 0.2079011
Validation loss decreased (0.378339 --> 0.376771).  Saving model ...
Reducing learning rate to 0.000127
	iters: 100, epoch: 14 | loss: 0.1907511
	speed: 0.0931s/iter; left time: 14410.0668s
	iters: 200, epoch: 14 | loss: 0.1902937
	speed: 0.0075s/iter; left time: 1166.4683s
	iters: 300, epoch: 14 | loss: 0.1923628
	speed: 0.0074s/iter; left time: 1147.7630s
	iters: 400, epoch: 14 | loss: 0.2073588
	speed: 0.0078s/iter; left time: 1199.6199s
	iters: 500, epoch: 14 | loss: 0.1914955
	speed: 0.0080s/iter; left time: 1237.9532s
	iters: 600, epoch: 14 | loss: 0.1915825
	speed: 0.0075s/iter; left time: 1149.8479s
	iters: 700, epoch: 14 | loss: 0.1856148
	speed: 0.0078s/iter; left time: 1207.6371s
	iters: 800, epoch: 14 | loss: 0.1884093
	speed: 0.0076s/iter; left time: 1163.7262s
	iters: 900, epoch: 14 | loss: 0.1873087
	speed: 0.0075s/iter; left time: 1148.3967s
	iters: 1000, epoch: 14 | loss: 0.1950276
	speed: 0.0076s/iter; left time: 1162.2076s
	iters: 1100, epoch: 14 | loss: 0.1856499
	speed: 0.0077s/iter; left time: 1187.3944s
Epoch: 14 cost time: 8.855350732803345
Vali Metrics: mse:0.4544, mae:0.3042
Test Metrics: mse:0.1901148, mae:0.2269905
Epoch: 14, Steps: 1130 | Train Loss: 0.1902796 Vali Loss: 0.3792924 Test Loss: 0.2085527
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000114
	iters: 100, epoch: 15 | loss: 0.1888713
	speed: 0.0904s/iter; left time: 13883.4576s
	iters: 200, epoch: 15 | loss: 0.1763539
	speed: 0.0079s/iter; left time: 1206.8569s
	iters: 300, epoch: 15 | loss: 0.1804855
	speed: 0.0078s/iter; left time: 1191.2858s
	iters: 400, epoch: 15 | loss: 0.1843801
	speed: 0.0078s/iter; left time: 1190.9034s
	iters: 500, epoch: 15 | loss: 0.1865196
	speed: 0.0078s/iter; left time: 1193.6336s
	iters: 600, epoch: 15 | loss: 0.1906139
	speed: 0.0079s/iter; left time: 1203.4364s
	iters: 700, epoch: 15 | loss: 0.1995647
	speed: 0.0078s/iter; left time: 1191.2176s
	iters: 800, epoch: 15 | loss: 0.1919107
	speed: 0.0078s/iter; left time: 1189.1931s
	iters: 900, epoch: 15 | loss: 0.1674023
	speed: 0.0080s/iter; left time: 1228.0353s
	iters: 1000, epoch: 15 | loss: 0.1767871
	speed: 0.0086s/iter; left time: 1317.5332s
	iters: 1100, epoch: 15 | loss: 0.1884791
	speed: 0.0084s/iter; left time: 1280.2266s
Epoch: 15 cost time: 9.279159784317017
Vali Metrics: mse:0.4527, mae:0.3031
Test Metrics: mse:0.190293, mae:0.2269958
Epoch: 15, Steps: 1130 | Train Loss: 0.1900307 Vali Loss: 0.3779113 Test Loss: 0.2086444
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000103
	iters: 100, epoch: 16 | loss: 0.1831935
	speed: 0.0925s/iter; left time: 14095.6653s
	iters: 200, epoch: 16 | loss: 0.2007230
	speed: 0.0080s/iter; left time: 1211.2596s
	iters: 300, epoch: 16 | loss: 0.2137133
	speed: 0.0082s/iter; left time: 1246.4017s
	iters: 400, epoch: 16 | loss: 0.1923232
	speed: 0.0084s/iter; left time: 1273.4413s
	iters: 500, epoch: 16 | loss: 0.2119925
	speed: 0.0079s/iter; left time: 1196.6112s
	iters: 600, epoch: 16 | loss: 0.2067946
	speed: 0.0076s/iter; left time: 1154.0719s
	iters: 700, epoch: 16 | loss: 0.1939213
	speed: 0.0077s/iter; left time: 1165.8636s
	iters: 800, epoch: 16 | loss: 0.2014249
	speed: 0.0077s/iter; left time: 1161.4894s
	iters: 900, epoch: 16 | loss: 0.1852692
	speed: 0.0078s/iter; left time: 1179.9491s
	iters: 1000, epoch: 16 | loss: 0.2084275
	speed: 0.0085s/iter; left time: 1289.8075s
	iters: 1100, epoch: 16 | loss: 0.1986922
	speed: 0.0077s/iter; left time: 1159.2810s
Epoch: 16 cost time: 9.20329475402832
Vali Metrics: mse:0.4520, mae:0.3015
Test Metrics: mse:0.1889262, mae:0.2259554
Epoch: 16, Steps: 1130 | Train Loss: 0.1896963 Vali Loss: 0.3767959 Test Loss: 0.2074408
EarlyStopping counter: 3 out of 10
Reducing learning rate to 0.000093
	iters: 100, epoch: 17 | loss: 0.1806872
	speed: 0.0901s/iter; left time: 13633.9766s
	iters: 200, epoch: 17 | loss: 0.1746671
	speed: 0.0075s/iter; left time: 1140.1630s
	iters: 300, epoch: 17 | loss: 0.1837252
	speed: 0.0076s/iter; left time: 1142.8575s
	iters: 400, epoch: 17 | loss: 0.1972465
	speed: 0.0079s/iter; left time: 1197.8572s
	iters: 500, epoch: 17 | loss: 0.1797898
	speed: 0.0076s/iter; left time: 1154.3911s
	iters: 600, epoch: 17 | loss: 0.2029749
	speed: 0.0081s/iter; left time: 1215.8380s
	iters: 700, epoch: 17 | loss: 0.1740709
	speed: 0.0082s/iter; left time: 1233.2784s
	iters: 800, epoch: 17 | loss: 0.1938662
	speed: 0.0086s/iter; left time: 1300.7113s
	iters: 900, epoch: 17 | loss: 0.1929055
	speed: 0.0078s/iter; left time: 1177.8789s
	iters: 1000, epoch: 17 | loss: 0.1883423
	speed: 0.0083s/iter; left time: 1242.2863s
	iters: 1100, epoch: 17 | loss: 0.1842794
	speed: 0.0081s/iter; left time: 1213.3875s
Epoch: 17 cost time: 9.218500852584839
Vali Metrics: mse:0.4553, mae:0.3040
Test Metrics: mse:0.1887707, mae:0.2258222
Epoch: 17, Steps: 1130 | Train Loss: 0.1894431 Vali Loss: 0.3796193 Test Loss: 0.2072965
EarlyStopping counter: 4 out of 10
Reducing learning rate to 0.000083
	iters: 100, epoch: 18 | loss: 0.2140067
	speed: 0.0897s/iter; left time: 13471.4581s
	iters: 200, epoch: 18 | loss: 0.1776744
	speed: 0.0077s/iter; left time: 1152.3291s
	iters: 300, epoch: 18 | loss: 0.1946817
	speed: 0.0076s/iter; left time: 1143.3728s
	iters: 400, epoch: 18 | loss: 0.2108933
	speed: 0.0075s/iter; left time: 1128.3769s
	iters: 500, epoch: 18 | loss: 0.2055808
	speed: 0.0076s/iter; left time: 1144.9481s
	iters: 600, epoch: 18 | loss: 0.2032588
	speed: 0.0077s/iter; left time: 1154.4087s
	iters: 700, epoch: 18 | loss: 0.1873939
	speed: 0.0076s/iter; left time: 1139.2262s
	iters: 800, epoch: 18 | loss: 0.2197881
	speed: 0.0077s/iter; left time: 1153.4840s
	iters: 900, epoch: 18 | loss: 0.1736045
	speed: 0.0077s/iter; left time: 1153.0607s
	iters: 1000, epoch: 18 | loss: 0.2008046
	speed: 0.0080s/iter; left time: 1188.4987s
	iters: 1100, epoch: 18 | loss: 0.1856430
	speed: 0.0077s/iter; left time: 1142.8010s
Epoch: 18 cost time: 8.899589538574219
Vali Metrics: mse:0.4530, mae:0.3028
Test Metrics: mse:0.1896745, mae:0.2268969
Epoch: 18, Steps: 1130 | Train Loss: 0.1891500 Vali Loss: 0.3779224 Test Loss: 0.2082857
EarlyStopping counter: 5 out of 10
Reducing learning rate to 0.000075
	iters: 100, epoch: 19 | loss: 0.2007238
	speed: 0.0928s/iter; left time: 13835.0190s
	iters: 200, epoch: 19 | loss: 0.1863380
	speed: 0.0076s/iter; left time: 1139.4897s
	iters: 300, epoch: 19 | loss: 0.1819173
	speed: 0.0077s/iter; left time: 1146.9640s
	iters: 400, epoch: 19 | loss: 0.1981799
	speed: 0.0077s/iter; left time: 1139.8179s
	iters: 500, epoch: 19 | loss: 0.1892826
	speed: 0.0077s/iter; left time: 1143.1255s
	iters: 600, epoch: 19 | loss: 0.2012036
	speed: 0.0077s/iter; left time: 1146.8808s
	iters: 700, epoch: 19 | loss: 0.2171654
	speed: 0.0079s/iter; left time: 1165.6076s
	iters: 800, epoch: 19 | loss: 0.1954128
	speed: 0.0079s/iter; left time: 1170.1237s
	iters: 900, epoch: 19 | loss: 0.2034961
	speed: 0.0078s/iter; left time: 1159.6440s
	iters: 1000, epoch: 19 | loss: 0.1903710
	speed: 0.0078s/iter; left time: 1159.2165s
	iters: 1100, epoch: 19 | loss: 0.1902600
	speed: 0.0080s/iter; left time: 1177.8680s
Epoch: 19 cost time: 9.020220518112183
Vali Metrics: mse:0.4503, mae:0.3012
Test Metrics: mse:0.1887703, mae:0.2259225
Epoch: 19, Steps: 1130 | Train Loss: 0.1889128 Vali Loss: 0.3757310 Test Loss: 0.2073464
Validation loss decreased (0.376771 --> 0.375731).  Saving model ...
Reducing learning rate to 0.000068
	iters: 100, epoch: 20 | loss: 0.1741237
	speed: 0.0901s/iter; left time: 13328.9643s
	iters: 200, epoch: 20 | loss: 0.1962789
	speed: 0.0076s/iter; left time: 1118.1561s
	iters: 300, epoch: 20 | loss: 0.1814820
	speed: 0.0081s/iter; left time: 1194.0727s
	iters: 400, epoch: 20 | loss: 0.1847454
	speed: 0.0075s/iter; left time: 1105.5666s
	iters: 500, epoch: 20 | loss: 0.1781862
	speed: 0.0079s/iter; left time: 1164.8694s
	iters: 600, epoch: 20 | loss: 0.1789493
	speed: 0.0081s/iter; left time: 1191.2380s
	iters: 700, epoch: 20 | loss: 0.1921883
	speed: 0.0077s/iter; left time: 1136.1808s
	iters: 800, epoch: 20 | loss: 0.1822419
	speed: 0.0076s/iter; left time: 1126.1794s
	iters: 900, epoch: 20 | loss: 0.2034217
	speed: 0.0076s/iter; left time: 1120.1004s
	iters: 1000, epoch: 20 | loss: 0.1954315
	speed: 0.0075s/iter; left time: 1103.0809s
	iters: 1100, epoch: 20 | loss: 0.1866938
	speed: 0.0077s/iter; left time: 1135.1464s
Epoch: 20 cost time: 8.939872741699219
Vali Metrics: mse:0.4520, mae:0.3014
Test Metrics: mse:0.1896053, mae:0.2265321
Epoch: 20, Steps: 1130 | Train Loss: 0.1887096 Vali Loss: 0.3766679 Test Loss: 0.2080687
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000061
	iters: 100, epoch: 21 | loss: 0.1764814
	speed: 0.0954s/iter; left time: 14000.3136s
	iters: 200, epoch: 21 | loss: 0.1665630
	speed: 0.0083s/iter; left time: 1215.2989s
	iters: 300, epoch: 21 | loss: 0.1926302
	speed: 0.0086s/iter; left time: 1257.9457s
	iters: 400, epoch: 21 | loss: 0.1951730
	speed: 0.0084s/iter; left time: 1227.7536s
	iters: 500, epoch: 21 | loss: 0.1803556
	speed: 0.0089s/iter; left time: 1305.7262s
	iters: 600, epoch: 21 | loss: 0.1841056
	speed: 0.0089s/iter; left time: 1304.4325s
	iters: 700, epoch: 21 | loss: 0.1685564
	speed: 0.0085s/iter; left time: 1244.6726s
	iters: 800, epoch: 21 | loss: 0.2229830
	speed: 0.0091s/iter; left time: 1332.7009s
	iters: 900, epoch: 21 | loss: 0.1933186
	speed: 0.0088s/iter; left time: 1282.1071s
	iters: 1000, epoch: 21 | loss: 0.1661899
	speed: 0.0086s/iter; left time: 1248.3340s
	iters: 1100, epoch: 21 | loss: 0.1686263
	speed: 0.0082s/iter; left time: 1192.8456s
Epoch: 21 cost time: 10.07819652557373
Vali Metrics: mse:0.4525, mae:0.3026
Test Metrics: mse:0.1893703, mae:0.2263763
Epoch: 21, Steps: 1130 | Train Loss: 0.1884459 Vali Loss: 0.3775409 Test Loss: 0.2078733
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000055
	iters: 100, epoch: 22 | loss: 0.1930607
	speed: 0.0986s/iter; left time: 14361.1040s
	iters: 200, epoch: 22 | loss: 0.1711982
	speed: 0.0081s/iter; left time: 1182.2226s
	iters: 300, epoch: 22 | loss: 0.1777853
	speed: 0.0086s/iter; left time: 1245.3520s
	iters: 400, epoch: 22 | loss: 0.1995693
	speed: 0.0086s/iter; left time: 1256.2842s
	iters: 500, epoch: 22 | loss: 0.1892005
	speed: 0.0087s/iter; left time: 1258.2026s
	iters: 600, epoch: 22 | loss: 0.2103676
	speed: 0.0088s/iter; left time: 1277.7286s
	iters: 700, epoch: 22 | loss: 0.1839895
	speed: 0.0085s/iter; left time: 1240.2177s
	iters: 800, epoch: 22 | loss: 0.1781905
	speed: 0.0082s/iter; left time: 1192.5835s
	iters: 900, epoch: 22 | loss: 0.1977198
	speed: 0.0085s/iter; left time: 1227.2689s
	iters: 1000, epoch: 22 | loss: 0.1813812
	speed: 0.0088s/iter; left time: 1278.8562s
	iters: 1100, epoch: 22 | loss: 0.1818248
	speed: 0.0085s/iter; left time: 1234.7554s
Epoch: 22 cost time: 9.856311798095703
Vali Metrics: mse:0.4516, mae:0.3025
Test Metrics: mse:0.1899743, mae:0.2264798
Epoch: 22, Steps: 1130 | Train Loss: 0.1883291 Vali Loss: 0.3770771 Test Loss: 0.2082271
EarlyStopping counter: 3 out of 10
Reducing learning rate to 0.000050
	iters: 100, epoch: 23 | loss: 0.2004011
	speed: 0.1000s/iter; left time: 14450.2341s
	iters: 200, epoch: 23 | loss: 0.1809793
	speed: 0.0085s/iter; left time: 1230.9380s
	iters: 300, epoch: 23 | loss: 0.1914585
	speed: 0.0087s/iter; left time: 1258.7901s
	iters: 400, epoch: 23 | loss: 0.1759407
	speed: 0.0083s/iter; left time: 1192.4204s
	iters: 500, epoch: 23 | loss: 0.1838587
	speed: 0.0084s/iter; left time: 1207.2896s
	iters: 600, epoch: 23 | loss: 0.1891890
	speed: 0.0081s/iter; left time: 1172.9905s
	iters: 700, epoch: 23 | loss: 0.1979944
	speed: 0.0091s/iter; left time: 1309.7187s
	iters: 800, epoch: 23 | loss: 0.1787986
	speed: 0.0086s/iter; left time: 1236.1333s
	iters: 900, epoch: 23 | loss: 0.1817398
	speed: 0.0086s/iter; left time: 1236.3092s
	iters: 1000, epoch: 23 | loss: 0.1920756
	speed: 0.0084s/iter; left time: 1206.6377s
	iters: 1100, epoch: 23 | loss: 0.1984682
	speed: 0.0078s/iter; left time: 1113.8607s
Epoch: 23 cost time: 9.823471546173096
Vali Metrics: mse:0.4528, mae:0.3030
Test Metrics: mse:0.1894229, mae:0.2266304
Epoch: 23, Steps: 1130 | Train Loss: 0.1881389 Vali Loss: 0.3779141 Test Loss: 0.2080267
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2005745
	speed: 0.0913s/iter; left time: 13091.7566s
	iters: 200, epoch: 24 | loss: 0.1893032
	speed: 0.0080s/iter; left time: 1150.9906s
	iters: 300, epoch: 24 | loss: 0.1960552
	speed: 0.0075s/iter; left time: 1074.9440s
	iters: 400, epoch: 24 | loss: 0.2043926
	speed: 0.0074s/iter; left time: 1052.7801s
	iters: 500, epoch: 24 | loss: 0.2064035
	speed: 0.0075s/iter; left time: 1075.5799s
	iters: 600, epoch: 24 | loss: 0.1982726
	speed: 0.0081s/iter; left time: 1156.7388s
	iters: 700, epoch: 24 | loss: 0.1871688
	speed: 0.0079s/iter; left time: 1125.3600s
	iters: 800, epoch: 24 | loss: 0.1798316
	speed: 0.0078s/iter; left time: 1109.3935s
	iters: 900, epoch: 24 | loss: 0.1926699
	speed: 0.0081s/iter; left time: 1154.0790s
	iters: 1000, epoch: 24 | loss: 0.1781354
	speed: 0.0085s/iter; left time: 1211.4446s
	iters: 1100, epoch: 24 | loss: 0.1783380
	speed: 0.0081s/iter; left time: 1148.3684s
Epoch: 24 cost time: 9.175423622131348
Vali Metrics: mse:0.4517, mae:0.3023
Test Metrics: mse:0.189149, mae:0.2260460
Epoch: 24, Steps: 1130 | Train Loss: 0.1881022 Vali Loss: 0.3769877 Test Loss: 0.2075975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1971006
	speed: 0.0897s/iter; left time: 12767.6300s
	iters: 200, epoch: 25 | loss: 0.1872955
	speed: 0.0080s/iter; left time: 1141.9439s
	iters: 300, epoch: 25 | loss: 0.1883730
	speed: 0.0085s/iter; left time: 1204.3832s
	iters: 400, epoch: 25 | loss: 0.1647640
	speed: 0.0082s/iter; left time: 1159.9934s
	iters: 500, epoch: 25 | loss: 0.1845605
	speed: 0.0081s/iter; left time: 1151.3610s
	iters: 600, epoch: 25 | loss: 0.1661239
	speed: 0.0080s/iter; left time: 1136.2886s
	iters: 700, epoch: 25 | loss: 0.1923920
	speed: 0.0080s/iter; left time: 1139.0398s
	iters: 800, epoch: 25 | loss: 0.1825486
	speed: 0.0081s/iter; left time: 1151.0072s
	iters: 900, epoch: 25 | loss: 0.1947743
	speed: 0.0082s/iter; left time: 1153.3721s
	iters: 1000, epoch: 25 | loss: 0.1729760
	speed: 0.0080s/iter; left time: 1135.2887s
	iters: 1100, epoch: 25 | loss: 0.1835309
	speed: 0.0081s/iter; left time: 1141.7578s
Epoch: 25 cost time: 9.401052474975586
Vali Metrics: mse:0.4556, mae:0.3040
Test Metrics: mse:0.189552, mae:0.2264763
Epoch: 25, Steps: 1130 | Train Loss: 0.1879878 Vali Loss: 0.3798004 Test Loss: 0.2080142
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1825411
	speed: 0.0916s/iter; left time: 12932.1182s
	iters: 200, epoch: 26 | loss: 0.1815928
	speed: 0.0079s/iter; left time: 1118.7247s
	iters: 300, epoch: 26 | loss: 0.2000270
	speed: 0.0077s/iter; left time: 1081.0504s
	iters: 400, epoch: 26 | loss: 0.1809131
	speed: 0.0077s/iter; left time: 1079.3361s
	iters: 500, epoch: 26 | loss: 0.1893374
	speed: 0.0075s/iter; left time: 1053.3227s
	iters: 600, epoch: 26 | loss: 0.1824809
	speed: 0.0075s/iter; left time: 1059.8177s
	iters: 700, epoch: 26 | loss: 0.1853566
	speed: 0.0078s/iter; left time: 1102.2850s
	iters: 800, epoch: 26 | loss: 0.1845708
	speed: 0.0084s/iter; left time: 1177.1817s
	iters: 900, epoch: 26 | loss: 0.1890959
	speed: 0.0084s/iter; left time: 1179.0196s
	iters: 1000, epoch: 26 | loss: 0.1814145
	speed: 0.0079s/iter; left time: 1104.7273s
	iters: 1100, epoch: 26 | loss: 0.1762896
	speed: 0.0076s/iter; left time: 1071.0991s
Epoch: 26 cost time: 9.096511363983154
Vali Metrics: mse:0.4539, mae:0.3031
Test Metrics: mse:0.1892967, mae:0.2262872
Epoch: 26, Steps: 1130 | Train Loss: 0.1879387 Vali Loss: 0.3784909 Test Loss: 0.2077920
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1926185
	speed: 0.0901s/iter; left time: 12620.9157s
	iters: 200, epoch: 27 | loss: 0.1661981
	speed: 0.0077s/iter; left time: 1078.8952s
	iters: 300, epoch: 27 | loss: 0.1741756
	speed: 0.0078s/iter; left time: 1085.2407s
	iters: 400, epoch: 27 | loss: 0.1798888
	speed: 0.0077s/iter; left time: 1079.1482s
	iters: 500, epoch: 27 | loss: 0.1891110
	speed: 0.0078s/iter; left time: 1090.3770s
	iters: 600, epoch: 27 | loss: 0.1836676
	speed: 0.0077s/iter; left time: 1080.2993s
	iters: 700, epoch: 27 | loss: 0.1895356
	speed: 0.0076s/iter; left time: 1059.3456s
	iters: 800, epoch: 27 | loss: 0.1822003
	speed: 0.0076s/iter; left time: 1058.9153s
	iters: 900, epoch: 27 | loss: 0.1896624
	speed: 0.0078s/iter; left time: 1090.5386s
	iters: 1000, epoch: 27 | loss: 0.1925818
	speed: 0.0078s/iter; left time: 1080.7256s
	iters: 1100, epoch: 27 | loss: 0.1879013
	speed: 0.0078s/iter; left time: 1091.0836s
Epoch: 27 cost time: 8.977496147155762
Vali Metrics: mse:0.4531, mae:0.3026
Test Metrics: mse:0.18933, mae:0.2260039
Epoch: 27, Steps: 1130 | Train Loss: 0.1878720 Vali Loss: 0.3778599 Test Loss: 0.2076670
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1933467
	speed: 0.0924s/iter; left time: 12827.8824s
	iters: 200, epoch: 28 | loss: 0.1921650
	speed: 0.0078s/iter; left time: 1077.7081s
	iters: 300, epoch: 28 | loss: 0.1839860
	speed: 0.0080s/iter; left time: 1107.0684s
	iters: 400, epoch: 28 | loss: 0.1776044
	speed: 0.0077s/iter; left time: 1063.9290s
	iters: 500, epoch: 28 | loss: 0.1892668
	speed: 0.0077s/iter; left time: 1069.5152s
	iters: 600, epoch: 28 | loss: 0.1807908
	speed: 0.0077s/iter; left time: 1064.0962s
	iters: 700, epoch: 28 | loss: 0.2024280
	speed: 0.0076s/iter; left time: 1056.6932s
	iters: 800, epoch: 28 | loss: 0.1948550
	speed: 0.0077s/iter; left time: 1058.9645s
	iters: 900, epoch: 28 | loss: 0.1919627
	speed: 0.0079s/iter; left time: 1097.3320s
	iters: 1000, epoch: 28 | loss: 0.1854408
	speed: 0.0080s/iter; left time: 1103.5808s
	iters: 1100, epoch: 28 | loss: 0.1930020
	speed: 0.0084s/iter; left time: 1154.9859s
Epoch: 28 cost time: 9.112118005752563
Vali Metrics: mse:0.4519, mae:0.3026
Test Metrics: mse:0.1891072, mae:0.2260155
Epoch: 28, Steps: 1130 | Train Loss: 0.1878410 Vali Loss: 0.3772222 Test Loss: 0.2075613
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2118167
	speed: 0.0909s/iter; left time: 12522.7816s
	iters: 200, epoch: 29 | loss: 0.1779920
	speed: 0.0079s/iter; left time: 1086.4263s
	iters: 300, epoch: 29 | loss: 0.2004985
	speed: 0.0082s/iter; left time: 1121.6549s
	iters: 400, epoch: 29 | loss: 0.1969916
	speed: 0.0080s/iter; left time: 1102.0365s
	iters: 500, epoch: 29 | loss: 0.2025792
	speed: 0.0082s/iter; left time: 1131.3629s
	iters: 600, epoch: 29 | loss: 0.2095782
	speed: 0.0078s/iter; left time: 1067.1894s
	iters: 700, epoch: 29 | loss: 0.1936484
	speed: 0.0076s/iter; left time: 1046.6666s
	iters: 800, epoch: 29 | loss: 0.1883423
	speed: 0.0078s/iter; left time: 1065.4328s
	iters: 900, epoch: 29 | loss: 0.1859714
	speed: 0.0083s/iter; left time: 1134.2765s
	iters: 1000, epoch: 29 | loss: 0.1890991
	speed: 0.0077s/iter; left time: 1053.5814s
	iters: 1100, epoch: 29 | loss: 0.2072213
	speed: 0.0076s/iter; left time: 1037.7660s
Epoch: 29 cost time: 9.160560607910156
Vali Metrics: mse:0.4524, mae:0.3029
Test Metrics: mse:0.1892806, mae:0.2263200
Epoch: 29, Steps: 1130 | Train Loss: 0.1876861 Vali Loss: 0.3776316 Test Loss: 0.2078003
EarlyStopping counter: 10 out of 10
Early stopping
loading model, best model path: ./checkpoints/long_term_forecast_weather_rerun_lkbck_search_2021__2021_DeepEDM_custom_ftM_sl512_ll48_pl192_emdtimeF_test_0/checkpoint.pth
>>>>>>>testing : long_term_forecast_weather_rerun_lkbck_search_2021__2021_DeepEDM_custom_ftM_sl512_ll48_pl192_emdtimeF_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.18873688578605652, mae:0.22590835392475128, dtw:not calculated
