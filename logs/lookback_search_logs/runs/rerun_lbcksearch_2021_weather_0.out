Setting seed to 2021
{'activation_fn': 'selu',
 'add_pe': True,
 'augmentation_ratio': 0,
 'batch_size': 32,
 'checkpoints': './checkpoints',
 'clip_grad_norm': 1.0,
 'condor_job': True,
 'data': 'custom',
 'data_path': 'weather.csv',
 'delay': 9,
 'des': 'test',
 'devices': '0,1',
 'dist_projection_dim': -1,
 'edm_dropout': 0.1,
 'embed': 'timeF',
 'features': 'M',
 'freq': 'h',
 'gpu': 0,
 'inverse': False,
 'is_training': 1,
 'itr': 1,
 'label_len': 48,
 'latent_channel_dim': -1,
 'learning_rate': 0.0005,
 'loss': 'mae_tdt',
 'loss_type': 'mae',
 'lradj': 'custom',
 'min_lr': 5e-05,
 'mlp_dropout': 0.1,
 'model': 'DeepEDM',
 'model_config': {'edm_params': {'activation_fn': 'selu',
                                 'add_pe': True,
                                 'delay': 9,
                                 'dist_projection_dim': 64,
                                 'dropout': 0.1,
                                 'layer_norm': True,
                                 'method': 'simplex',
                                 'n_proj_layers': 1,
                                 'theta': 1.0,
                                 'time_delay_stride': 2},
                  'encoder_params': {'activation_fn': 'selu',
                                     'add_pe': True,
                                     'dropout': 0.1,
                                     'in_channels': 21,
                                     'latent_channel_dim': 21,
                                     'mlp_layers': 1,
                                     'use_encoder': False},
                  'lookback_len': 512,
                  'n_edm_blocks': 1,
                  'out_pred_len': 96,
                  'type': 'EDM'},
 'model_id': 'weather_rerun_lkbck_search_2021__2021',
 'n_edm_blocks': 1,
 'n_mlp_layers': 1,
 'n_proj_layers': -1,
 'num_workers': 4,
 'opt': {'clip_grad_norm': 1.0,
         'early_stopping_patience': 30,
         'epochs': 100,
         'learning_rate': 0.0005,
         'min_lr': 5e-05,
         'reduce_lr_factor': 0.9,
         'schedule_type': 'custom',
         'type': 'AdamW',
         'weight_decay': 1e-05},
 'output_dir': '.',
 'patience': 10,
 'pred_len': 96,
 'reduce_lr_factor': 0.9,
 'root_path': './dataset/weather',
 'seasonal_patterns': 'Monthly',
 'seed': 2021,
 'seq_len': 512,
 'target': 'OT',
 'task_name': 'long_term_forecast',
 'tdt_loss': True,
 'theta': -1,
 'time_delay_stride': 2,
 'train_epochs': 150,
 'use_amp': False,
 'use_dtw': False,
 'use_gpu': True,
 'use_multi_gpu': True}
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_rerun_lkbck_search_2021__2021Model:              DeepEDM             

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/weather   
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mForecasting Task[0m
  Seq Len:            512                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m

[1mRun Parameters[0m
  Num Workers:        4                   Itr:                1                   
  Train Epochs:       150                 Batch Size:         32                  
  Patience:           10                  Learning Rate:      0.0005              
  Des:                test                Loss:               mae_tdt             
  Lradj:              custom              Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      1                   Devices:            0,1                 

{'clip_grad_norm': 1.0,
 'early_stopping_patience': 30,
 'epochs': 100,
 'learning_rate': 0.0005,
 'min_lr': 5e-05,
 'reduce_lr_factor': 0.9,
 'schedule_type': 'custom',
 'type': 'AdamW',
 'weight_decay': 1e-05}

{'edm_params': {'activation_fn': 'selu',
                'add_pe': True,
                'delay': 9,
                'dist_projection_dim': 64,
                'dropout': 0.1,
                'layer_norm': True,
                'method': 'simplex',
                'n_proj_layers': 1,
                'theta': 1.0,
                'time_delay_stride': 2},
 'encoder_params': {'activation_fn': 'selu',
                    'add_pe': True,
                    'dropout': 0.1,
                    'in_channels': 21,
                    'latent_channel_dim': 21,
                    'mlp_layers': 1,
                    'use_encoder': False},
 'lookback_len': 512,
 'n_edm_blocks': 1,
 'out_pred_len': 96,
 'type': 'EDM'}

model: Model(
  (encoder): InputEncoder(
    (mlp_projection): Sequential(
      (0): Linear(in_features=512, out_features=96, bias=True)
    )
  )
  (edm_blocks): ModuleList(
    (0): EDM(
      (activation_fn): SELU()
      (projection): Sequential(
        (0): Linear(in_features=9, out_features=64, bias=True)
      )
      (pe): LearnablePositionalEmbedding()
      (ln1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (attn_dropout): Dropout(p=0.1, inplace=False)
      (undelay): Sequential(
        (0): Linear(in_features=423, out_features=96, bias=True)
        (1): Dropout(p=0.1, inplace=False)
        (2): SELU()
        (3): Linear(in_features=96, out_features=96, bias=True)
      )
    )
  )
  (gate_edm): Linear(in_features=96, out_features=1, bias=True)
)
>>>>>>>start training : long_term_forecast_weather_rerun_lkbck_search_2021__2021_DeepEDM_custom_ftM_sl512_ll48_pl96_emdtimeF_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36280
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.2547752
	speed: 0.0165s/iter; left time: 2803.3913s
	iters: 200, epoch: 1 | loss: 0.2446095
	speed: 0.0074s/iter; left time: 1252.6186s
	iters: 300, epoch: 1 | loss: 0.2006322
	speed: 0.0074s/iter; left time: 1253.1143s
	iters: 400, epoch: 1 | loss: 0.2095808
	speed: 0.0075s/iter; left time: 1277.9726s
	iters: 500, epoch: 1 | loss: 0.2014735
	speed: 0.0075s/iter; left time: 1273.9832s
	iters: 600, epoch: 1 | loss: 0.2143295
	speed: 0.0076s/iter; left time: 1289.3166s
	iters: 700, epoch: 1 | loss: 0.2131101
	speed: 0.0075s/iter; left time: 1277.4458s
	iters: 800, epoch: 1 | loss: 0.2293602
	speed: 0.0075s/iter; left time: 1266.9960s
	iters: 900, epoch: 1 | loss: 0.1922896
	speed: 0.0074s/iter; left time: 1250.4897s
	iters: 1000, epoch: 1 | loss: 0.1980298
	speed: 0.0074s/iter; left time: 1256.7819s
	iters: 1100, epoch: 1 | loss: 0.1878288
	speed: 0.0075s/iter; left time: 1269.6896s
Epoch: 1 cost time: 9.171985626220703
Vali Metrics: mse:0.4061, mae:0.2758
Test Metrics: mse:0.15417, mae:0.1991780
Epoch: 1, Steps: 1133 | Train Loss: 0.2158428 Vali Loss: 0.3409385 Test Loss: 0.1766740
Validation loss decreased (inf --> 0.340939).  Saving model ...
Reducing learning rate to 0.000450
	iters: 100, epoch: 2 | loss: 0.1965682
	speed: 0.0514s/iter; left time: 8675.4855s
	iters: 200, epoch: 2 | loss: 0.1818128
	speed: 0.0073s/iter; left time: 1233.3734s
	iters: 300, epoch: 2 | loss: 0.1861444
	speed: 0.0074s/iter; left time: 1254.1085s
	iters: 400, epoch: 2 | loss: 0.1781816
	speed: 0.0073s/iter; left time: 1236.8442s
	iters: 500, epoch: 2 | loss: 0.1875140
	speed: 0.0072s/iter; left time: 1213.2396s
	iters: 600, epoch: 2 | loss: 0.1844564
	speed: 0.0074s/iter; left time: 1237.5299s
	iters: 700, epoch: 2 | loss: 0.1909560
	speed: 0.0075s/iter; left time: 1265.9570s
	iters: 800, epoch: 2 | loss: 0.1781767
	speed: 0.0077s/iter; left time: 1285.9680s
	iters: 900, epoch: 2 | loss: 0.1835724
	speed: 0.0075s/iter; left time: 1265.2565s
	iters: 1000, epoch: 2 | loss: 0.1991616
	speed: 0.0074s/iter; left time: 1247.9625s
	iters: 1100, epoch: 2 | loss: 0.1871264
	speed: 0.0072s/iter; left time: 1208.9380s
Epoch: 2 cost time: 8.598211765289307
Vali Metrics: mse:0.4058, mae:0.2722
Test Metrics: mse:0.1500779, mae:0.1924536
Epoch: 2, Steps: 1133 | Train Loss: 0.1880638 Vali Loss: 0.3390159 Test Loss: 0.1712658
Validation loss decreased (0.340939 --> 0.339016).  Saving model ...
Reducing learning rate to 0.000405
	iters: 100, epoch: 3 | loss: 0.1747462
	speed: 0.0707s/iter; left time: 11844.9511s
	iters: 200, epoch: 3 | loss: 0.1700717
	speed: 0.0078s/iter; left time: 1302.9037s
	iters: 300, epoch: 3 | loss: 0.2016094
	speed: 0.0076s/iter; left time: 1265.0515s
	iters: 400, epoch: 3 | loss: 0.1927731
	speed: 0.0076s/iter; left time: 1278.3596s
	iters: 500, epoch: 3 | loss: 0.1916631
	speed: 0.0077s/iter; left time: 1279.3345s
	iters: 600, epoch: 3 | loss: 0.1677770
	speed: 0.0075s/iter; left time: 1251.7062s
	iters: 700, epoch: 3 | loss: 0.2029971
	speed: 0.0072s/iter; left time: 1209.5263s
	iters: 800, epoch: 3 | loss: 0.1772863
	speed: 0.0072s/iter; left time: 1206.3025s
	iters: 900, epoch: 3 | loss: 0.1720963
	speed: 0.0077s/iter; left time: 1281.5580s
	iters: 1000, epoch: 3 | loss: 0.2017716
	speed: 0.0078s/iter; left time: 1293.4184s
	iters: 1100, epoch: 3 | loss: 0.2032550
	speed: 0.0075s/iter; left time: 1250.6815s
Epoch: 3 cost time: 8.787490844726562
Vali Metrics: mse:0.4026, mae:0.2666
Test Metrics: mse:0.1504923, mae:0.1911438
Epoch: 3, Steps: 1133 | Train Loss: 0.1835285 Vali Loss: 0.3346230 Test Loss: 0.1708180
Validation loss decreased (0.339016 --> 0.334623).  Saving model ...
Reducing learning rate to 0.000365
	iters: 100, epoch: 4 | loss: 0.1862650
	speed: 0.0722s/iter; left time: 12010.5470s
	iters: 200, epoch: 4 | loss: 0.2000379
	speed: 0.0073s/iter; left time: 1213.1262s
	iters: 300, epoch: 4 | loss: 0.1827996
	speed: 0.0075s/iter; left time: 1245.9542s
	iters: 400, epoch: 4 | loss: 0.1755510
	speed: 0.0076s/iter; left time: 1256.5069s
	iters: 500, epoch: 4 | loss: 0.1741259
	speed: 0.0076s/iter; left time: 1257.3248s
	iters: 600, epoch: 4 | loss: 0.1704109
	speed: 0.0075s/iter; left time: 1249.5656s
	iters: 700, epoch: 4 | loss: 0.1682263
	speed: 0.0073s/iter; left time: 1217.6273s
	iters: 800, epoch: 4 | loss: 0.2024615
	speed: 0.0075s/iter; left time: 1246.9322s
	iters: 900, epoch: 4 | loss: 0.1709535
	speed: 0.0075s/iter; left time: 1243.4532s
	iters: 1000, epoch: 4 | loss: 0.1796132
	speed: 0.0075s/iter; left time: 1240.3371s
	iters: 1100, epoch: 4 | loss: 0.1870597
	speed: 0.0073s/iter; left time: 1207.4675s
Epoch: 4 cost time: 8.681171894073486
Vali Metrics: mse:0.3995, mae:0.2661
Test Metrics: mse:0.148664, mae:0.1889415
Epoch: 4, Steps: 1133 | Train Loss: 0.1810929 Vali Loss: 0.3327995 Test Loss: 0.1688027
Validation loss decreased (0.334623 --> 0.332800).  Saving model ...
Reducing learning rate to 0.000328
	iters: 100, epoch: 5 | loss: 0.1720397
	speed: 0.0739s/iter; left time: 12211.1198s
	iters: 200, epoch: 5 | loss: 0.1663142
	speed: 0.0073s/iter; left time: 1202.9856s
	iters: 300, epoch: 5 | loss: 0.2059790
	speed: 0.0074s/iter; left time: 1224.0486s
	iters: 400, epoch: 5 | loss: 0.1657046
	speed: 0.0074s/iter; left time: 1225.6580s
	iters: 500, epoch: 5 | loss: 0.1737870
	speed: 0.0076s/iter; left time: 1251.2489s
	iters: 600, epoch: 5 | loss: 0.1748622
	speed: 0.0072s/iter; left time: 1184.4020s
	iters: 700, epoch: 5 | loss: 0.1983947
	speed: 0.0072s/iter; left time: 1184.3628s
	iters: 800, epoch: 5 | loss: 0.1829082
	speed: 0.0074s/iter; left time: 1211.7804s
	iters: 900, epoch: 5 | loss: 0.1558781
	speed: 0.0074s/iter; left time: 1210.6642s
	iters: 1000, epoch: 5 | loss: 0.1786938
	speed: 0.0075s/iter; left time: 1234.2311s
	iters: 1100, epoch: 5 | loss: 0.1797606
	speed: 0.0072s/iter; left time: 1184.1123s
Epoch: 5 cost time: 8.560638427734375
Vali Metrics: mse:0.3971, mae:0.2636
Test Metrics: mse:0.147736, mae:0.1878150
Epoch: 5, Steps: 1133 | Train Loss: 0.1794105 Vali Loss: 0.3303787 Test Loss: 0.1677755
Validation loss decreased (0.332800 --> 0.330379).  Saving model ...
Reducing learning rate to 0.000295
	iters: 100, epoch: 6 | loss: 0.1874545
	speed: 0.0710s/iter; left time: 11659.5514s
	iters: 200, epoch: 6 | loss: 0.1749926
	speed: 0.0074s/iter; left time: 1217.4936s
	iters: 300, epoch: 6 | loss: 0.1718513
	speed: 0.0078s/iter; left time: 1282.9426s
	iters: 400, epoch: 6 | loss: 0.1832271
	speed: 0.0075s/iter; left time: 1226.9428s
	iters: 500, epoch: 6 | loss: 0.1976676
	speed: 0.0073s/iter; left time: 1189.7905s
	iters: 600, epoch: 6 | loss: 0.1907514
	speed: 0.0072s/iter; left time: 1172.4871s
	iters: 700, epoch: 6 | loss: 0.1558878
	speed: 0.0072s/iter; left time: 1178.4370s
	iters: 800, epoch: 6 | loss: 0.1716678
	speed: 0.0072s/iter; left time: 1182.2011s
	iters: 900, epoch: 6 | loss: 0.1947189
	speed: 0.0072s/iter; left time: 1183.7599s
	iters: 1000, epoch: 6 | loss: 0.1875681
	speed: 0.0075s/iter; left time: 1217.9462s
	iters: 1100, epoch: 6 | loss: 0.1871337
	speed: 0.0075s/iter; left time: 1229.1186s
Epoch: 6 cost time: 8.608406066894531
Vali Metrics: mse:0.3913, mae:0.2607
Test Metrics: mse:0.1465403, mae:0.1856841
Epoch: 6, Steps: 1133 | Train Loss: 0.1782280 Vali Loss: 0.3260106 Test Loss: 0.1661122
Validation loss decreased (0.330379 --> 0.326011).  Saving model ...
Reducing learning rate to 0.000266
	iters: 100, epoch: 7 | loss: 0.1817676
	speed: 0.0760s/iter; left time: 12385.4479s
	iters: 200, epoch: 7 | loss: 0.1911362
	speed: 0.0073s/iter; left time: 1191.8010s
	iters: 300, epoch: 7 | loss: 0.1772341
	speed: 0.0075s/iter; left time: 1215.3579s
	iters: 400, epoch: 7 | loss: 0.1777467
	speed: 0.0074s/iter; left time: 1205.3299s
	iters: 500, epoch: 7 | loss: 0.1749059
	speed: 0.0073s/iter; left time: 1184.5837s
	iters: 600, epoch: 7 | loss: 0.1561532
	speed: 0.0078s/iter; left time: 1262.4004s
	iters: 700, epoch: 7 | loss: 0.1989004
	speed: 0.0076s/iter; left time: 1230.7382s
	iters: 800, epoch: 7 | loss: 0.1627427
	speed: 0.0076s/iter; left time: 1234.4557s
	iters: 900, epoch: 7 | loss: 0.1765312
	speed: 0.0075s/iter; left time: 1223.1670s
	iters: 1000, epoch: 7 | loss: 0.1690042
	speed: 0.0075s/iter; left time: 1219.5871s
	iters: 1100, epoch: 7 | loss: 0.1593585
	speed: 0.0076s/iter; left time: 1234.7084s
Epoch: 7 cost time: 8.700246572494507
Vali Metrics: mse:0.3937, mae:0.2618
Test Metrics: mse:0.1456791, mae:0.1856271
Epoch: 7, Steps: 1133 | Train Loss: 0.1771868 Vali Loss: 0.3277148 Test Loss: 0.1656531
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000239
	iters: 100, epoch: 8 | loss: 0.1638473
	speed: 0.0751s/iter; left time: 12160.0005s
	iters: 200, epoch: 8 | loss: 0.1805993
	speed: 0.0074s/iter; left time: 1191.8132s
	iters: 300, epoch: 8 | loss: 0.1854028
	speed: 0.0073s/iter; left time: 1176.6352s
	iters: 400, epoch: 8 | loss: 0.1856431
	speed: 0.0073s/iter; left time: 1183.1148s
	iters: 500, epoch: 8 | loss: 0.1806935
	speed: 0.0072s/iter; left time: 1163.2471s
	iters: 600, epoch: 8 | loss: 0.1663793
	speed: 0.0074s/iter; left time: 1187.7407s
	iters: 700, epoch: 8 | loss: 0.1641875
	speed: 0.0078s/iter; left time: 1255.4648s
	iters: 800, epoch: 8 | loss: 0.1974727
	speed: 0.0074s/iter; left time: 1186.9621s
	iters: 900, epoch: 8 | loss: 0.1842165
	speed: 0.0074s/iter; left time: 1198.6601s
	iters: 1000, epoch: 8 | loss: 0.1779390
	speed: 0.0079s/iter; left time: 1268.2523s
	iters: 1100, epoch: 8 | loss: 0.1622318
	speed: 0.0075s/iter; left time: 1207.9827s
Epoch: 8 cost time: 8.665741205215454
Vali Metrics: mse:0.3930, mae:0.2610
Test Metrics: mse:0.1464653, mae:0.1852339
Epoch: 8, Steps: 1133 | Train Loss: 0.1758688 Vali Loss: 0.3270125 Test Loss: 0.1658496
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000215
	iters: 100, epoch: 9 | loss: 0.1680053
	speed: 0.0721s/iter; left time: 11600.4043s
	iters: 200, epoch: 9 | loss: 0.1777955
	speed: 0.0071s/iter; left time: 1148.7698s
	iters: 300, epoch: 9 | loss: 0.1964556
	speed: 0.0073s/iter; left time: 1167.2600s
	iters: 400, epoch: 9 | loss: 0.1723495
	speed: 0.0076s/iter; left time: 1219.2459s
	iters: 500, epoch: 9 | loss: 0.1841973
	speed: 0.0076s/iter; left time: 1218.5680s
	iters: 600, epoch: 9 | loss: 0.1867808
	speed: 0.0077s/iter; left time: 1227.8218s
	iters: 700, epoch: 9 | loss: 0.1636626
	speed: 0.0075s/iter; left time: 1206.1730s
	iters: 800, epoch: 9 | loss: 0.1675308
	speed: 0.0074s/iter; left time: 1188.7766s
	iters: 900, epoch: 9 | loss: 0.1645377
	speed: 0.0075s/iter; left time: 1199.1461s
	iters: 1000, epoch: 9 | loss: 0.1624572
	speed: 0.0074s/iter; left time: 1175.1918s
	iters: 1100, epoch: 9 | loss: 0.1634965
	speed: 0.0072s/iter; left time: 1155.8952s
Epoch: 9 cost time: 8.650606632232666
Vali Metrics: mse:0.3927, mae:0.2608
Test Metrics: mse:0.1467599, mae:0.1860100
Epoch: 9, Steps: 1133 | Train Loss: 0.1748362 Vali Loss: 0.3267448 Test Loss: 0.1663850
EarlyStopping counter: 3 out of 10
Reducing learning rate to 0.000194
	iters: 100, epoch: 10 | loss: 0.2019141
	speed: 0.0742s/iter; left time: 11844.9128s
	iters: 200, epoch: 10 | loss: 0.1747878
	speed: 0.0075s/iter; left time: 1202.7244s
	iters: 300, epoch: 10 | loss: 0.1889115
	speed: 0.0077s/iter; left time: 1226.1664s
	iters: 400, epoch: 10 | loss: 0.1680417
	speed: 0.0075s/iter; left time: 1196.8464s
	iters: 500, epoch: 10 | loss: 0.1846388
	speed: 0.0071s/iter; left time: 1126.1711s
	iters: 600, epoch: 10 | loss: 0.1650147
	speed: 0.0073s/iter; left time: 1162.1991s
	iters: 700, epoch: 10 | loss: 0.1883878
	speed: 0.0074s/iter; left time: 1181.2389s
	iters: 800, epoch: 10 | loss: 0.1733434
	speed: 0.0074s/iter; left time: 1174.6403s
	iters: 900, epoch: 10 | loss: 0.1623758
	speed: 0.0072s/iter; left time: 1149.8848s
	iters: 1000, epoch: 10 | loss: 0.1607940
	speed: 0.0072s/iter; left time: 1141.3415s
	iters: 1100, epoch: 10 | loss: 0.1794920
	speed: 0.0072s/iter; left time: 1148.2956s
Epoch: 10 cost time: 8.57050609588623
Vali Metrics: mse:0.3908, mae:0.2597
Test Metrics: mse:0.1470007, mae:0.1861387
Epoch: 10, Steps: 1133 | Train Loss: 0.1740169 Vali Loss: 0.3252906 Test Loss: 0.1665697
Validation loss decreased (0.326011 --> 0.325291).  Saving model ...
Reducing learning rate to 0.000174
	iters: 100, epoch: 11 | loss: 0.1498470
	speed: 0.0739s/iter; left time: 11718.3504s
	iters: 200, epoch: 11 | loss: 0.1911361
	speed: 0.0073s/iter; left time: 1159.7386s
	iters: 300, epoch: 11 | loss: 0.1761765
	speed: 0.0073s/iter; left time: 1150.5483s
	iters: 400, epoch: 11 | loss: 0.1839534
	speed: 0.0073s/iter; left time: 1151.6632s
	iters: 500, epoch: 11 | loss: 0.1902405
	speed: 0.0073s/iter; left time: 1157.7317s
	iters: 600, epoch: 11 | loss: 0.1759863
	speed: 0.0073s/iter; left time: 1148.1903s
	iters: 700, epoch: 11 | loss: 0.1888784
	speed: 0.0074s/iter; left time: 1160.7828s
	iters: 800, epoch: 11 | loss: 0.1719429
	speed: 0.0073s/iter; left time: 1155.4166s
	iters: 900, epoch: 11 | loss: 0.1580948
	speed: 0.0072s/iter; left time: 1140.9836s
	iters: 1000, epoch: 11 | loss: 0.1683908
	speed: 0.0076s/iter; left time: 1198.0549s
	iters: 1100, epoch: 11 | loss: 0.1671244
	speed: 0.0073s/iter; left time: 1146.4395s
Epoch: 11 cost time: 8.562790632247925
Vali Metrics: mse:0.3941, mae:0.2583
Test Metrics: mse:0.1464258, mae:0.1848973
Epoch: 11, Steps: 1133 | Train Loss: 0.1732496 Vali Loss: 0.3261924 Test Loss: 0.1656616
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000157
	iters: 100, epoch: 12 | loss: 0.1552913
	speed: 0.0720s/iter; left time: 11335.3549s
	iters: 200, epoch: 12 | loss: 0.1801426
	speed: 0.0076s/iter; left time: 1190.3229s
	iters: 300, epoch: 12 | loss: 0.1921678
	speed: 0.0074s/iter; left time: 1157.1721s
	iters: 400, epoch: 12 | loss: 0.1766076
	speed: 0.0073s/iter; left time: 1150.8697s
	iters: 500, epoch: 12 | loss: 0.1865101
	speed: 0.0075s/iter; left time: 1177.1173s
	iters: 600, epoch: 12 | loss: 0.1754392
	speed: 0.0076s/iter; left time: 1198.7596s
	iters: 700, epoch: 12 | loss: 0.1901446
	speed: 0.0075s/iter; left time: 1183.3189s
	iters: 800, epoch: 12 | loss: 0.1768880
	speed: 0.0075s/iter; left time: 1174.0184s
	iters: 900, epoch: 12 | loss: 0.1783538
	speed: 0.0073s/iter; left time: 1147.5108s
	iters: 1000, epoch: 12 | loss: 0.1931511
	speed: 0.0073s/iter; left time: 1143.7791s
	iters: 1100, epoch: 12 | loss: 0.1640183
	speed: 0.0073s/iter; left time: 1134.5198s
Epoch: 12 cost time: 8.627893447875977
Vali Metrics: mse:0.3919, mae:0.2593
Test Metrics: mse:0.1457518, mae:0.1846998
Epoch: 12, Steps: 1133 | Train Loss: 0.1723858 Vali Loss: 0.3255996 Test Loss: 0.1652258
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000141
	iters: 100, epoch: 13 | loss: 0.1716223
	speed: 0.0722s/iter; left time: 11276.4346s
	iters: 200, epoch: 13 | loss: 0.1659396
	speed: 0.0080s/iter; left time: 1253.7679s
	iters: 300, epoch: 13 | loss: 0.1825446
	speed: 0.0078s/iter; left time: 1223.9008s
	iters: 400, epoch: 13 | loss: 0.1753707
	speed: 0.0085s/iter; left time: 1329.8309s
	iters: 500, epoch: 13 | loss: 0.1599828
	speed: 0.0087s/iter; left time: 1356.4106s
	iters: 600, epoch: 13 | loss: 0.1708804
	speed: 0.0079s/iter; left time: 1225.2514s
	iters: 700, epoch: 13 | loss: 0.1731785
	speed: 0.0084s/iter; left time: 1308.7117s
	iters: 800, epoch: 13 | loss: 0.1823963
	speed: 0.0084s/iter; left time: 1304.3984s
	iters: 900, epoch: 13 | loss: 0.1678296
	speed: 0.0083s/iter; left time: 1284.9752s
	iters: 1000, epoch: 13 | loss: 0.1678850
	speed: 0.0083s/iter; left time: 1288.1893s
	iters: 1100, epoch: 13 | loss: 0.1746548
	speed: 0.0083s/iter; left time: 1289.6676s
Epoch: 13 cost time: 9.57600212097168
Vali Metrics: mse:0.3933, mae:0.2591
Test Metrics: mse:0.1459772, mae:0.1843856
Epoch: 13, Steps: 1133 | Train Loss: 0.1718538 Vali Loss: 0.3261967 Test Loss: 0.1651814
EarlyStopping counter: 3 out of 10
Reducing learning rate to 0.000127
	iters: 100, epoch: 14 | loss: 0.1641224
	speed: 0.0784s/iter; left time: 12155.1221s
	iters: 200, epoch: 14 | loss: 0.1708084
	speed: 0.0092s/iter; left time: 1427.3701s
	iters: 300, epoch: 14 | loss: 0.1657159
	speed: 0.0081s/iter; left time: 1262.2761s
	iters: 400, epoch: 14 | loss: 0.1695113
	speed: 0.0079s/iter; left time: 1230.8273s
	iters: 500, epoch: 14 | loss: 0.1886467
	speed: 0.0075s/iter; left time: 1162.1547s
	iters: 600, epoch: 14 | loss: 0.1617861
	speed: 0.0081s/iter; left time: 1245.2502s
	iters: 700, epoch: 14 | loss: 0.2109436
	speed: 0.0081s/iter; left time: 1245.9579s
	iters: 800, epoch: 14 | loss: 0.1654748
	speed: 0.0078s/iter; left time: 1205.0000s
	iters: 900, epoch: 14 | loss: 0.1809889
	speed: 0.0086s/iter; left time: 1324.9140s
	iters: 1000, epoch: 14 | loss: 0.1545746
	speed: 0.0084s/iter; left time: 1293.9847s
	iters: 1100, epoch: 14 | loss: 0.1507912
	speed: 0.0083s/iter; left time: 1283.4735s
Epoch: 14 cost time: 9.45361614227295
Vali Metrics: mse:0.3889, mae:0.2592
Test Metrics: mse:0.1453068, mae:0.1838418
Epoch: 14, Steps: 1133 | Train Loss: 0.1712200 Vali Loss: 0.3240486 Test Loss: 0.1645743
Validation loss decreased (0.325291 --> 0.324049).  Saving model ...
Reducing learning rate to 0.000114
	iters: 100, epoch: 15 | loss: 0.1883182
	speed: 0.0801s/iter; left time: 12327.3887s
	iters: 200, epoch: 15 | loss: 0.1737090
	speed: 0.0085s/iter; left time: 1302.8383s
	iters: 300, epoch: 15 | loss: 0.1672000
	speed: 0.0078s/iter; left time: 1202.9975s
	iters: 400, epoch: 15 | loss: 0.1674623
	speed: 0.0082s/iter; left time: 1266.3583s
	iters: 500, epoch: 15 | loss: 0.1831307
	speed: 0.0085s/iter; left time: 1302.7439s
	iters: 600, epoch: 15 | loss: 0.1938231
	speed: 0.0081s/iter; left time: 1237.6296s
	iters: 700, epoch: 15 | loss: 0.1711221
	speed: 0.0082s/iter; left time: 1261.8743s
	iters: 800, epoch: 15 | loss: 0.1563413
	speed: 0.0083s/iter; left time: 1266.3871s
	iters: 900, epoch: 15 | loss: 0.1837749
	speed: 0.0080s/iter; left time: 1222.8950s
	iters: 1000, epoch: 15 | loss: 0.1570477
	speed: 0.0079s/iter; left time: 1210.0976s
	iters: 1100, epoch: 15 | loss: 0.1533183
	speed: 0.0075s/iter; left time: 1154.3584s
Epoch: 15 cost time: 9.448417901992798
Vali Metrics: mse:0.3892, mae:0.2566
Test Metrics: mse:0.1459345, mae:0.1840499
Epoch: 15, Steps: 1133 | Train Loss: 0.1708036 Vali Loss: 0.3229163 Test Loss: 0.1649922
Validation loss decreased (0.324049 --> 0.322916).  Saving model ...
Reducing learning rate to 0.000103
	iters: 100, epoch: 16 | loss: 0.1889253
	speed: 0.0759s/iter; left time: 11598.0898s
	iters: 200, epoch: 16 | loss: 0.1811668
	speed: 0.0076s/iter; left time: 1156.5377s
	iters: 300, epoch: 16 | loss: 0.1984354
	speed: 0.0072s/iter; left time: 1096.5500s
	iters: 400, epoch: 16 | loss: 0.1675485
	speed: 0.0076s/iter; left time: 1159.8399s
	iters: 500, epoch: 16 | loss: 0.1758599
	speed: 0.0073s/iter; left time: 1111.9551s
	iters: 600, epoch: 16 | loss: 0.1496576
	speed: 0.0072s/iter; left time: 1102.8525s
	iters: 700, epoch: 16 | loss: 0.1852582
	speed: 0.0082s/iter; left time: 1250.2898s
	iters: 800, epoch: 16 | loss: 0.1995099
	speed: 0.0076s/iter; left time: 1163.7559s
	iters: 900, epoch: 16 | loss: 0.1646035
	speed: 0.0076s/iter; left time: 1156.4137s
	iters: 1000, epoch: 16 | loss: 0.1797368
	speed: 0.0073s/iter; left time: 1104.3129s
	iters: 1100, epoch: 16 | loss: 0.1669835
	speed: 0.0072s/iter; left time: 1096.5598s
Epoch: 16 cost time: 8.711379528045654
Vali Metrics: mse:0.3898, mae:0.2575
Test Metrics: mse:0.1465968, mae:0.1847166
Epoch: 16, Steps: 1133 | Train Loss: 0.1702869 Vali Loss: 0.3236340 Test Loss: 0.1656567
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000093
	iters: 100, epoch: 17 | loss: 0.1806491
	speed: 0.0720s/iter; left time: 10919.5724s
	iters: 200, epoch: 17 | loss: 0.1708062
	speed: 0.0076s/iter; left time: 1150.4626s
	iters: 300, epoch: 17 | loss: 0.1834898
	speed: 0.0083s/iter; left time: 1262.0673s
	iters: 400, epoch: 17 | loss: 0.1640447
	speed: 0.0077s/iter; left time: 1169.6453s
	iters: 500, epoch: 17 | loss: 0.1795792
	speed: 0.0075s/iter; left time: 1135.3526s
	iters: 600, epoch: 17 | loss: 0.1501828
	speed: 0.0076s/iter; left time: 1149.6622s
	iters: 700, epoch: 17 | loss: 0.1777965
	speed: 0.0075s/iter; left time: 1128.4319s
	iters: 800, epoch: 17 | loss: 0.1515074
	speed: 0.0077s/iter; left time: 1159.4705s
	iters: 900, epoch: 17 | loss: 0.1881158
	speed: 0.0072s/iter; left time: 1085.9656s
	iters: 1000, epoch: 17 | loss: 0.1637158
	speed: 0.0070s/iter; left time: 1058.6453s
	iters: 1100, epoch: 17 | loss: 0.1556008
	speed: 0.0071s/iter; left time: 1068.5802s
Epoch: 17 cost time: 8.73083758354187
Vali Metrics: mse:0.3906, mae:0.2586
Test Metrics: mse:0.145556, mae:0.1842145
Epoch: 17, Steps: 1133 | Train Loss: 0.1696816 Vali Loss: 0.3245833 Test Loss: 0.1648853
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000083
	iters: 100, epoch: 18 | loss: 0.1733235
	speed: 0.0747s/iter; left time: 11255.2822s
	iters: 200, epoch: 18 | loss: 0.1599161
	speed: 0.0074s/iter; left time: 1120.5834s
	iters: 300, epoch: 18 | loss: 0.1626429
	speed: 0.0072s/iter; left time: 1089.4367s
	iters: 400, epoch: 18 | loss: 0.1691504
	speed: 0.0072s/iter; left time: 1082.6997s
	iters: 500, epoch: 18 | loss: 0.1857028
	speed: 0.0071s/iter; left time: 1069.9764s
	iters: 600, epoch: 18 | loss: 0.1962314
	speed: 0.0073s/iter; left time: 1092.4755s
	iters: 700, epoch: 18 | loss: 0.1768745
	speed: 0.0072s/iter; left time: 1081.3946s
	iters: 800, epoch: 18 | loss: 0.1649672
	speed: 0.0071s/iter; left time: 1070.8839s
	iters: 900, epoch: 18 | loss: 0.1747641
	speed: 0.0070s/iter; left time: 1041.9264s
	iters: 1000, epoch: 18 | loss: 0.1675961
	speed: 0.0072s/iter; left time: 1071.1817s
	iters: 1100, epoch: 18 | loss: 0.1642848
	speed: 0.0072s/iter; left time: 1071.3031s
Epoch: 18 cost time: 8.435951948165894
Vali Metrics: mse:0.3878, mae:0.2557
Test Metrics: mse:0.1449096, mae:0.1828581
Epoch: 18, Steps: 1133 | Train Loss: 0.1694124 Vali Loss: 0.3217382 Test Loss: 0.1638839
Validation loss decreased (0.322916 --> 0.321738).  Saving model ...
Reducing learning rate to 0.000075
	iters: 100, epoch: 19 | loss: 0.1536703
	speed: 0.0739s/iter; left time: 11044.2225s
	iters: 200, epoch: 19 | loss: 0.1992674
	speed: 0.0072s/iter; left time: 1069.0836s
	iters: 300, epoch: 19 | loss: 0.1734332
	speed: 0.0073s/iter; left time: 1095.8887s
	iters: 400, epoch: 19 | loss: 0.1497209
	speed: 0.0072s/iter; left time: 1075.0535s
	iters: 500, epoch: 19 | loss: 0.1529625
	speed: 0.0072s/iter; left time: 1072.5558s
	iters: 600, epoch: 19 | loss: 0.1672427
	speed: 0.0075s/iter; left time: 1116.3248s
	iters: 700, epoch: 19 | loss: 0.1854289
	speed: 0.0078s/iter; left time: 1158.0427s
	iters: 800, epoch: 19 | loss: 0.1512978
	speed: 0.0078s/iter; left time: 1153.3187s
	iters: 900, epoch: 19 | loss: 0.1617320
	speed: 0.0076s/iter; left time: 1128.7412s
	iters: 1000, epoch: 19 | loss: 0.1744179
	speed: 0.0077s/iter; left time: 1139.0489s
	iters: 1100, epoch: 19 | loss: 0.1642893
	speed: 0.0073s/iter; left time: 1086.6842s
Epoch: 19 cost time: 8.62899374961853
Vali Metrics: mse:0.3888, mae:0.2577
Test Metrics: mse:0.1458041, mae:0.1841919
Epoch: 19, Steps: 1133 | Train Loss: 0.1690009 Vali Loss: 0.3232436 Test Loss: 0.1649980
EarlyStopping counter: 1 out of 10
Reducing learning rate to 0.000068
	iters: 100, epoch: 20 | loss: 0.1701230
	speed: 0.0754s/iter; left time: 11180.9108s
	iters: 200, epoch: 20 | loss: 0.1693431
	speed: 0.0079s/iter; left time: 1171.0317s
	iters: 300, epoch: 20 | loss: 0.2064627
	speed: 0.0077s/iter; left time: 1145.3312s
	iters: 400, epoch: 20 | loss: 0.1734095
	speed: 0.0077s/iter; left time: 1141.4784s
	iters: 500, epoch: 20 | loss: 0.1516721
	speed: 0.0077s/iter; left time: 1144.7786s
	iters: 600, epoch: 20 | loss: 0.1611356
	speed: 0.0076s/iter; left time: 1127.5144s
	iters: 700, epoch: 20 | loss: 0.1758427
	speed: 0.0073s/iter; left time: 1074.2757s
	iters: 800, epoch: 20 | loss: 0.1623779
	speed: 0.0073s/iter; left time: 1084.1183s
	iters: 900, epoch: 20 | loss: 0.1623871
	speed: 0.0074s/iter; left time: 1088.0376s
	iters: 1000, epoch: 20 | loss: 0.1697526
	speed: 0.0073s/iter; left time: 1081.2774s
	iters: 1100, epoch: 20 | loss: 0.1640161
	speed: 0.0071s/iter; left time: 1047.9920s
Epoch: 20 cost time: 8.748681545257568
Vali Metrics: mse:0.3903, mae:0.2575
Test Metrics: mse:0.1454823, mae:0.1835937
Epoch: 20, Steps: 1133 | Train Loss: 0.1685427 Vali Loss: 0.3238645 Test Loss: 0.1645380
EarlyStopping counter: 2 out of 10
Reducing learning rate to 0.000061
	iters: 100, epoch: 21 | loss: 0.1799865
	speed: 0.0740s/iter; left time: 10889.7794s
	iters: 200, epoch: 21 | loss: 0.1747412
	speed: 0.0071s/iter; left time: 1044.8213s
	iters: 300, epoch: 21 | loss: 0.1600048
	speed: 0.0073s/iter; left time: 1073.0858s
	iters: 400, epoch: 21 | loss: 0.1657504
	speed: 0.0071s/iter; left time: 1040.3328s
	iters: 500, epoch: 21 | loss: 0.1735562
	speed: 0.0071s/iter; left time: 1043.7029s
	iters: 600, epoch: 21 | loss: 0.1730768
	speed: 0.0070s/iter; left time: 1027.7576s
	iters: 700, epoch: 21 | loss: 0.1721734
	speed: 0.0070s/iter; left time: 1022.9325s
	iters: 800, epoch: 21 | loss: 0.1492312
	speed: 0.0071s/iter; left time: 1037.6158s
	iters: 900, epoch: 21 | loss: 0.1684767
	speed: 0.0070s/iter; left time: 1022.7065s
	iters: 1000, epoch: 21 | loss: 0.1817963
	speed: 0.0070s/iter; left time: 1021.1892s
	iters: 1100, epoch: 21 | loss: 0.1630924
	speed: 0.0071s/iter; left time: 1037.1214s
Epoch: 21 cost time: 8.26400113105774
Vali Metrics: mse:0.3887, mae:0.2561
Test Metrics: mse:0.1453879, mae:0.1831725
Epoch: 21, Steps: 1133 | Train Loss: 0.1682698 Vali Loss: 0.3223674 Test Loss: 0.1642802
EarlyStopping counter: 3 out of 10
Reducing learning rate to 0.000055
	iters: 100, epoch: 22 | loss: 0.1760798
	speed: 0.0708s/iter; left time: 10347.5909s
	iters: 200, epoch: 22 | loss: 0.1502376
	speed: 0.0071s/iter; left time: 1037.5268s
	iters: 300, epoch: 22 | loss: 0.1826850
	speed: 0.0075s/iter; left time: 1092.2825s
	iters: 400, epoch: 22 | loss: 0.1774984
	speed: 0.0073s/iter; left time: 1059.2256s
	iters: 500, epoch: 22 | loss: 0.1937095
	speed: 0.0071s/iter; left time: 1032.8567s
	iters: 600, epoch: 22 | loss: 0.1611174
	speed: 0.0073s/iter; left time: 1065.1575s
	iters: 700, epoch: 22 | loss: 0.1775979
	speed: 0.0071s/iter; left time: 1028.0770s
	iters: 800, epoch: 22 | loss: 0.1882856
	speed: 0.0072s/iter; left time: 1039.5976s
	iters: 900, epoch: 22 | loss: 0.1630186
	speed: 0.0071s/iter; left time: 1028.4176s
	iters: 1000, epoch: 22 | loss: 0.2213652
	speed: 0.0073s/iter; left time: 1057.7738s
	iters: 1100, epoch: 22 | loss: 0.1663360
	speed: 0.0074s/iter; left time: 1067.8493s
Epoch: 22 cost time: 8.381969451904297
Vali Metrics: mse:0.3896, mae:0.2561
Test Metrics: mse:0.1456125, mae:0.1833855
Epoch: 22, Steps: 1133 | Train Loss: 0.1680548 Vali Loss: 0.3228536 Test Loss: 0.1644990
EarlyStopping counter: 4 out of 10
Reducing learning rate to 0.000050
	iters: 100, epoch: 23 | loss: 0.1711821
	speed: 0.0735s/iter; left time: 10651.9728s
	iters: 200, epoch: 23 | loss: 0.1651027
	speed: 0.0072s/iter; left time: 1042.1620s
	iters: 300, epoch: 23 | loss: 0.1882590
	speed: 0.0072s/iter; left time: 1044.1552s
	iters: 400, epoch: 23 | loss: 0.2031480
	speed: 0.0072s/iter; left time: 1040.7442s
	iters: 500, epoch: 23 | loss: 0.1854819
	speed: 0.0073s/iter; left time: 1051.7804s
	iters: 600, epoch: 23 | loss: 0.1795173
	speed: 0.0071s/iter; left time: 1022.3313s
	iters: 700, epoch: 23 | loss: 0.1676615
	speed: 0.0072s/iter; left time: 1043.9949s
	iters: 800, epoch: 23 | loss: 0.1627745
	speed: 0.0072s/iter; left time: 1035.5949s
	iters: 900, epoch: 23 | loss: 0.1654847
	speed: 0.0070s/iter; left time: 1014.7125s
	iters: 1000, epoch: 23 | loss: 0.1525246
	speed: 0.0074s/iter; left time: 1063.7361s
	iters: 1100, epoch: 23 | loss: 0.1399335
	speed: 0.0074s/iter; left time: 1065.8854s
Epoch: 23 cost time: 8.447294473648071
Vali Metrics: mse:0.3899, mae:0.2572
Test Metrics: mse:0.145107, mae:0.1831295
Epoch: 23, Steps: 1133 | Train Loss: 0.1677798 Vali Loss: 0.3235594 Test Loss: 0.1641183
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1726746
	speed: 0.0720s/iter; left time: 10349.4491s
	iters: 200, epoch: 24 | loss: 0.1755249
	speed: 0.0073s/iter; left time: 1053.9171s
	iters: 300, epoch: 24 | loss: 0.1697760
	speed: 0.0072s/iter; left time: 1035.2702s
	iters: 400, epoch: 24 | loss: 0.1564780
	speed: 0.0075s/iter; left time: 1070.7898s
	iters: 500, epoch: 24 | loss: 0.1725326
	speed: 0.0072s/iter; left time: 1030.5121s
	iters: 600, epoch: 24 | loss: 0.1622523
	speed: 0.0073s/iter; left time: 1048.5758s
	iters: 700, epoch: 24 | loss: 0.1823605
	speed: 0.0078s/iter; left time: 1113.9807s
	iters: 800, epoch: 24 | loss: 0.1538753
	speed: 0.0079s/iter; left time: 1124.0225s
	iters: 900, epoch: 24 | loss: 0.1562751
	speed: 0.0078s/iter; left time: 1113.2300s
	iters: 1000, epoch: 24 | loss: 0.1492948
	speed: 0.0078s/iter; left time: 1119.4446s
	iters: 1100, epoch: 24 | loss: 0.1693920
	speed: 0.0079s/iter; left time: 1130.9141s
Epoch: 24 cost time: 8.77065396308899
Vali Metrics: mse:0.3891, mae:0.2561
Test Metrics: mse:0.1460778, mae:0.1837430
Epoch: 24, Steps: 1133 | Train Loss: 0.1677148 Vali Loss: 0.3226365 Test Loss: 0.1649104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1764983
	speed: 0.0719s/iter; left time: 10257.2247s
	iters: 200, epoch: 25 | loss: 0.1686191
	speed: 0.0073s/iter; left time: 1047.0747s
	iters: 300, epoch: 25 | loss: 0.1715574
	speed: 0.0073s/iter; left time: 1040.0282s
	iters: 400, epoch: 25 | loss: 0.1365293
	speed: 0.0074s/iter; left time: 1056.9865s
	iters: 500, epoch: 25 | loss: 0.1756575
	speed: 0.0073s/iter; left time: 1037.0072s
	iters: 600, epoch: 25 | loss: 0.1948363
	speed: 0.0074s/iter; left time: 1056.5532s
	iters: 700, epoch: 25 | loss: 0.1574623
	speed: 0.0074s/iter; left time: 1046.0190s
	iters: 800, epoch: 25 | loss: 0.1731946
	speed: 0.0076s/iter; left time: 1081.9883s
	iters: 900, epoch: 25 | loss: 0.1500880
	speed: 0.0077s/iter; left time: 1093.0699s
	iters: 1000, epoch: 25 | loss: 0.1670904
	speed: 0.0072s/iter; left time: 1022.6123s
	iters: 1100, epoch: 25 | loss: 0.1863567
	speed: 0.0073s/iter; left time: 1039.7993s
Epoch: 25 cost time: 8.597589254379272
Vali Metrics: mse:0.3873, mae:0.2574
Test Metrics: mse:0.1451823, mae:0.1835691
Epoch: 25, Steps: 1133 | Train Loss: 0.1676232 Vali Loss: 0.3223441 Test Loss: 0.1643757
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1666355
	speed: 0.0739s/iter; left time: 10453.2172s
	iters: 200, epoch: 26 | loss: 0.1783969
	speed: 0.0074s/iter; left time: 1052.5803s
	iters: 300, epoch: 26 | loss: 0.1519374
	speed: 0.0075s/iter; left time: 1055.6732s
	iters: 400, epoch: 26 | loss: 0.1598551
	speed: 0.0074s/iter; left time: 1049.4271s
	iters: 500, epoch: 26 | loss: 0.1755174
	speed: 0.0078s/iter; left time: 1101.6202s
	iters: 600, epoch: 26 | loss: 0.1703146
	speed: 0.0075s/iter; left time: 1058.3382s
	iters: 700, epoch: 26 | loss: 0.1658924
	speed: 0.0076s/iter; left time: 1067.8866s
	iters: 800, epoch: 26 | loss: 0.1634569
	speed: 0.0074s/iter; left time: 1043.0075s
	iters: 900, epoch: 26 | loss: 0.1700856
	speed: 0.0073s/iter; left time: 1028.7164s
	iters: 1000, epoch: 26 | loss: 0.1538367
	speed: 0.0073s/iter; left time: 1031.1172s
	iters: 1100, epoch: 26 | loss: 0.1587328
	speed: 0.0073s/iter; left time: 1025.8800s
Epoch: 26 cost time: 8.664943218231201
Vali Metrics: mse:0.3881, mae:0.2561
Test Metrics: mse:0.1456161, mae:0.1831927
Epoch: 26, Steps: 1133 | Train Loss: 0.1675917 Vali Loss: 0.3220848 Test Loss: 0.1644044
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1990140
	speed: 0.0717s/iter; left time: 10063.6266s
	iters: 200, epoch: 27 | loss: 0.1800894
	speed: 0.0074s/iter; left time: 1038.3234s
	iters: 300, epoch: 27 | loss: 0.1818173
	speed: 0.0074s/iter; left time: 1034.8699s
	iters: 400, epoch: 27 | loss: 0.1480820
	speed: 0.0073s/iter; left time: 1019.7781s
	iters: 500, epoch: 27 | loss: 0.1712092
	speed: 0.0072s/iter; left time: 1005.1907s
	iters: 600, epoch: 27 | loss: 0.1864594
	speed: 0.0071s/iter; left time: 995.8532s
	iters: 700, epoch: 27 | loss: 0.1718135
	speed: 0.0073s/iter; left time: 1026.7895s
	iters: 800, epoch: 27 | loss: 0.1698115
	speed: 0.0072s/iter; left time: 998.8684s
	iters: 900, epoch: 27 | loss: 0.1681826
	speed: 0.0071s/iter; left time: 995.7794s
	iters: 1000, epoch: 27 | loss: 0.1823904
	speed: 0.0072s/iter; left time: 1001.9291s
	iters: 1100, epoch: 27 | loss: 0.1858164
	speed: 0.0073s/iter; left time: 1023.7857s
Epoch: 27 cost time: 8.45967960357666
Vali Metrics: mse:0.3899, mae:0.2563
Test Metrics: mse:0.1453774, mae:0.1831948
Epoch: 27, Steps: 1133 | Train Loss: 0.1675273 Vali Loss: 0.3231130 Test Loss: 0.1642861
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.1729476
	speed: 0.0722s/iter; left time: 10049.7375s
	iters: 200, epoch: 28 | loss: 0.1430981
	speed: 0.0077s/iter; left time: 1065.5453s
	iters: 300, epoch: 28 | loss: 0.1575460
	speed: 0.0073s/iter; left time: 1015.6715s
	iters: 400, epoch: 28 | loss: 0.1799198
	speed: 0.0076s/iter; left time: 1058.1607s
	iters: 500, epoch: 28 | loss: 0.1516617
	speed: 0.0073s/iter; left time: 1008.6104s
	iters: 600, epoch: 28 | loss: 0.1553937
	speed: 0.0072s/iter; left time: 1005.7641s
	iters: 700, epoch: 28 | loss: 0.1682322
	speed: 0.0074s/iter; left time: 1023.3976s
	iters: 800, epoch: 28 | loss: 0.1715367
	speed: 0.0074s/iter; left time: 1020.4340s
	iters: 900, epoch: 28 | loss: 0.1665684
	speed: 0.0074s/iter; left time: 1019.5919s
	iters: 1000, epoch: 28 | loss: 0.1616810
	speed: 0.0073s/iter; left time: 1008.6482s
	iters: 1100, epoch: 28 | loss: 0.1646015
	speed: 0.0072s/iter; left time: 991.8384s
Epoch: 28 cost time: 8.598791360855103
Vali Metrics: mse:0.3891, mae:0.2558
Test Metrics: mse:0.145442, mae:0.1831966
Epoch: 28, Steps: 1133 | Train Loss: 0.1674137 Vali Loss: 0.3224654 Test Loss: 0.1643193
EarlyStopping counter: 10 out of 10
Early stopping
loading model, best model path: ./checkpoints/long_term_forecast_weather_rerun_lkbck_search_2021__2021_DeepEDM_custom_ftM_sl512_ll48_pl96_emdtimeF_test_0/checkpoint.pth
>>>>>>>testing : long_term_forecast_weather_rerun_lkbck_search_2021__2021_DeepEDM_custom_ftM_sl512_ll48_pl96_emdtimeF_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.14489708840847015, mae:0.18285252153873444, dtw:not calculated
